import{u as F,a as k,m as T,r as E,aj as V,b as D,j as e,C as p,g as C,H as I,B as u,d as L,e as M,f as q,ak as A,al as r,am as n,an as l,as as i,I as y,at as m,ar as o,au as B,aY as v,aZ as N,a_ as P,a$ as S,b0 as h,k as H,aC as t,aD as Y,t as z}from"./index-DQa6QqId.js";import{C as Q}from"./checkbox-DCkna8R_.js";import{C as R}from"./circle-plus-C6t8yGRS.js";import{S as G}from"./save-C1PuH1Ib.js";const K=["Mindfulness","Physical Activity","Sleep","Nutrition","Social Connection","Gratitude","Stress Reduction","Creativity","Learning","Productivity","Personal Growth","Environmental","Financial Wellbeing","Work-Life Balance","Emotional Intelligence"],O=t.object({title:t.string().min(5,"Title must be at least 5 characters").max(100,"Title cannot exceed 100 characters"),description:t.string().min(20,"Description must be at least 20 characters").max(500,"Description cannot exceed 500 characters"),category:t.string().min(1,"Please select a category"),difficulty:t.enum(["easy","moderate","hard","extreme"]),targetValue:t.number().min(1,"Target value must be at least 1").max(100,"Target value cannot exceed 100"),isPublic:t.boolean().default(!0),tags:t.string().optional()});function $(){const{user:c}=F(),{toast:x}=k(),f=T(),[b,g]=E.useState(!1),s=V({resolver:Y(O),defaultValues:{title:"",description:"",category:"",difficulty:"moderate",targetValue:1,isPublic:!0,tags:""}}),j=D({mutationFn:async a=>await z("POST","/api/challenges/create",a),onSuccess:()=>{x({title:"Challenge Created",description:"Your challenge has been created successfully. You will earn 3 tokens when someone completes it!"}),s.reset(),g(!1),f.invalidateQueries({queryKey:["/api/gamification/challenges"]}),f.invalidateQueries({queryKey:["/api/tokens"]})},onError:a=>{x({title:"Failed to Create Challenge",description:a.message||"There was an error creating your challenge. Please try again.",variant:"destructive"})}}),w=a=>{if(!(c!=null&&c.isPremium)){x({title:"Premium Feature",description:"Challenge creation is a premium feature. Upgrade to create custom challenges.",variant:"destructive"});return}j.mutate(a)};return!(c!=null&&c.isPremium)&&!b?e.jsx(p,{className:"border-dashed border-2 border-gray-300 bg-gray-50",children:e.jsxs(C,{className:"pt-6 text-center",children:[e.jsx(I,{className:"h-12 w-12 text-primary mb-3 mx-auto"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Premium Feature"}),e.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:"Challenge creation is a premium feature that lets you create personalized challenges for friends, family, and other users."}),e.jsxs("p",{className:"text-muted-foreground text-sm mb-4",children:[e.jsx("span",{className:"font-medium",children:"Earn 3 tokens"})," each time someone completes a challenge you create!"]}),e.jsx(u,{variant:"default",disabled:!0,children:"Upgrade to Premium"})]})}):b?e.jsxs(p,{children:[e.jsxs(L,{children:[e.jsx(M,{children:"Create a Custom Challenge"}),e.jsx(q,{children:"Design a mental health or wellbeing challenge for the community. You'll earn 3 tokens each time someone completes your challenge!"})]}),e.jsx(C,{children:e.jsx(A,{...s,children:e.jsxs("form",{onSubmit:s.handleSubmit(w),className:"space-y-6",children:[e.jsx(r,{control:s.control,name:"title",render:({field:a})=>e.jsxs(n,{children:[e.jsx(l,{children:"Challenge Title"}),e.jsx(i,{children:e.jsx(y,{placeholder:"Enter a catchy title",...a})}),e.jsx(m,{children:"Be clear and motivating with your title"}),e.jsx(o,{})]})}),e.jsx(r,{control:s.control,name:"description",render:({field:a})=>e.jsxs(n,{children:[e.jsx(l,{children:"Description"}),e.jsx(i,{children:e.jsx(B,{placeholder:"Describe the challenge, its benefits, and how to complete it",className:"min-h-32",...a})}),e.jsx(m,{children:"Include clear instructions and benefits"}),e.jsx(o,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(r,{control:s.control,name:"category",render:({field:a})=>e.jsxs(n,{children:[e.jsx(l,{children:"Category"}),e.jsxs(v,{onValueChange:a.onChange,defaultValue:a.value,children:[e.jsx(i,{children:e.jsx(N,{children:e.jsx(P,{placeholder:"Select a category"})})}),e.jsx(S,{children:K.map(d=>e.jsx(h,{value:d.toLowerCase(),children:d},d))})]}),e.jsx(o,{})]})}),e.jsx(r,{control:s.control,name:"difficulty",render:({field:a})=>e.jsxs(n,{children:[e.jsx(l,{children:"Difficulty Level"}),e.jsxs(v,{onValueChange:a.onChange,defaultValue:a.value,children:[e.jsx(i,{children:e.jsx(N,{children:e.jsx(P,{placeholder:"Select difficulty"})})}),e.jsxs(S,{children:[e.jsx(h,{value:"easy",children:"Easy"}),e.jsx(h,{value:"moderate",children:"Moderate"}),e.jsx(h,{value:"hard",children:"Hard"}),e.jsx(h,{value:"extreme",children:"Extreme"})]})]}),e.jsx(o,{})]})})]}),e.jsx(r,{control:s.control,name:"targetValue",render:({field:a})=>e.jsxs(n,{children:[e.jsx(l,{children:"Target Value"}),e.jsx(i,{children:e.jsx(y,{type:"number",min:1,max:100,placeholder:"How many times/days to complete",...a,onChange:d=>a.onChange(parseInt(d.target.value)||1)})}),e.jsx(m,{children:"This could be days, repetitions, or minutes depending on your challenge"}),e.jsx(o,{})]})}),e.jsx(r,{control:s.control,name:"tags",render:({field:a})=>e.jsxs(n,{children:[e.jsx(l,{children:"Tags (Optional)"}),e.jsx(i,{children:e.jsx(y,{placeholder:"Enter comma-separated tags",...a})}),e.jsx(m,{children:"Add tags to help others find your challenge"}),e.jsx(o,{})]})}),e.jsx(r,{control:s.control,name:"isPublic",render:({field:a})=>e.jsxs(n,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[e.jsx(i,{children:e.jsx(Q,{checked:a.value,onCheckedChange:a.onChange})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsx(l,{children:"Make this challenge public"}),e.jsx(m,{children:"Public challenges are available to all users. Private challenges are only available to those you share them with."})]})]})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(u,{variant:"outline",type:"button",onClick:()=>g(!1),children:"Cancel"}),e.jsx(u,{type:"submit",disabled:j.isPending,children:j.isPending?e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),"Create Challenge"]})})]})]})})})]}):e.jsx(p,{className:"border-dashed border-2 border-primary/20 bg-primary/5",children:e.jsxs(C,{className:"pt-6 text-center",children:[e.jsx(R,{className:"h-12 w-12 text-primary mb-3 mx-auto"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Create a Challenge"}),e.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:"Create personalized challenges for friends, family, and other users to improve mental health and wellbeing."}),e.jsxs("p",{className:"text-muted-foreground text-sm mb-4",children:[e.jsx("span",{className:"font-medium",children:"Earn 3 tokens"})," each time someone completes a challenge you create!"]}),e.jsx(u,{variant:"default",onClick:()=>g(!0),children:"Create Challenge"})]})})}export{$ as C};
