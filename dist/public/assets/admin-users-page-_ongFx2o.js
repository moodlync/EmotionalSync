import{c as O,a as Q,W as K,r as N,Y as H,b as B,l as G,j as e,k as S,aK as J,aR as W,B as x,aL as Y,aM as $,aN as X,aO as Z,F as _,w as i,x as t,v as l,y as c,I as d,D as o,G as k,H as A,J as F,K as L,M as f,aP as ee,ba as D,aF as se,N as ae,R as a,ah as re,ap as ne,V as P,t as ie}from"./index-BtgMuIOb.js";import{A as v}from"./admin-layout-Dk4BIZxj.js";import{C as te}from"./circle-plus-ys5p9aJD.js";import{S as le}from"./square-pen-B52v4YK0.js";import"./log-out-DvZviEwE.js";import"./rotate-ccw-ggWisKeU.js";import"./quote-x5gkxPhQ.js";import"./database-CIRPvLLa.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=O("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]),R=["admin","moderator","support","finance"],ce=a.object({username:a.string().min(3,"Username must be at least 3 characters"),email:a.string().email("Please enter a valid email address"),password:a.string().min(8,"Password must be at least 8 characters"),firstName:a.string().optional(),lastName:a.string().optional(),role:a.enum(["admin","moderator","support","finance"]),permissions:a.array(a.string()).optional(),department:a.string().optional(),contactPhone:a.string().optional()});function ge(){const{toast:y}=Q(),E=K(),[m,q]=N.useState(""),[h,z]=N.useState(""),[M,w]=N.useState(!1),{data:b,isLoading:T,error:j,refetch:I}=H({queryKey:["/api/admin/users"],queryFn:async()=>{const s=await P("GET","/api/admin/users");if(!s.ok)throw new Error("Failed to fetch admin users");return s.json()}}),p=B({mutationFn:async s=>{const n=await P("POST","/api/admin/users",s);if(!n.ok){const g=await n.json();throw new Error(g.message||"Failed to create admin user")}return n.json()},onSuccess:()=>{E.invalidateQueries({queryKey:["/api/admin/users"]}),y({title:"Admin user created",description:"The admin user has been created successfully"}),w(!1)},onError:s=>{y({title:"Creation failed",description:s instanceof Error?s.message:"Failed to create admin user",variant:"destructive"})}}),r=G({resolver:ie(ce),defaultValues:{username:"",email:"",password:"",firstName:"",lastName:"",role:"support",permissions:[],department:"",contactPhone:""}}),V=s=>{p.mutateAsync(s)},C=b?b.filter(s=>{const n=m===""||s.username.toLowerCase().includes(m.toLowerCase())||s.email&&s.email.toLowerCase().includes(m.toLowerCase())||s.firstName&&s.firstName.toLowerCase().includes(m.toLowerCase())||s.lastName&&s.lastName.toLowerCase().includes(m.toLowerCase()),g=h===""||s.role===h;return n&&g}):[],u=s=>{switch(s){case"admin":return e.jsx(ne,{className:"h-4 w-4 text-red-500"});case"moderator":return e.jsx(U,{className:"h-4 w-4 text-blue-500"});case"support":return e.jsx(re,{className:"h-4 w-4 text-green-500"});case"finance":return e.jsx(D,{className:"h-4 w-4 text-amber-500"});default:return e.jsx(U,{className:"h-4 w-4 text-gray-500"})}};return T?e.jsx(v,{children:e.jsx("div",{className:"flex justify-center items-center h-[80vh]",children:e.jsx(S,{className:"h-8 w-8 animate-spin text-primary"})})}):j?e.jsx(v,{children:e.jsxs("div",{className:"rounded-lg border border-destructive p-4 text-destructive",children:[e.jsx("p",{children:"Error loading admin users"}),e.jsx("p",{className:"text-sm",children:j instanceof Error?j.message:"Unknown error"})]})}):e.jsx(v,{children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Admin Users"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage admin user accounts and roles"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(J,{open:M,onOpenChange:w,children:[e.jsx(W,{asChild:!0,children:e.jsxs(x,{size:"sm",className:"h-8 gap-1",children:[e.jsx(te,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:"Add Admin"})]})}),e.jsxs(Y,{className:"sm:max-w-[550px]",children:[e.jsxs($,{children:[e.jsx(X,{children:"Create New Admin User"}),e.jsx(Z,{children:"Add a new administrator to manage the MoodSync platform"})]}),e.jsx(_,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(V),className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(i,{control:r.control,name:"firstName",render:({field:s})=>e.jsxs(t,{children:[e.jsx(l,{children:"First Name"}),e.jsx(c,{children:e.jsx(d,{...s})}),e.jsx(o,{})]})}),e.jsx(i,{control:r.control,name:"lastName",render:({field:s})=>e.jsxs(t,{children:[e.jsx(l,{children:"Last Name"}),e.jsx(c,{children:e.jsx(d,{...s})}),e.jsx(o,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(i,{control:r.control,name:"username",render:({field:s})=>e.jsxs(t,{children:[e.jsx(l,{children:"Username"}),e.jsx(c,{children:e.jsx(d,{...s})}),e.jsx(o,{})]})}),e.jsx(i,{control:r.control,name:"email",render:({field:s})=>e.jsxs(t,{children:[e.jsx(l,{children:"Email"}),e.jsx(c,{children:e.jsx(d,{type:"email",...s})}),e.jsx(o,{})]})})]}),e.jsx(i,{control:r.control,name:"password",render:({field:s})=>e.jsxs(t,{children:[e.jsx(l,{children:"Password"}),e.jsx(c,{children:e.jsx(d,{type:"password",...s})}),e.jsx(o,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(i,{control:r.control,name:"role",render:({field:s})=>e.jsxs(t,{children:[e.jsx(l,{children:"Role"}),e.jsxs(k,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(c,{children:e.jsx(A,{children:e.jsx(F,{placeholder:"Select a role"})})}),e.jsx(L,{children:R.map(n=>e.jsx(f,{value:n,children:e.jsxs("div",{className:"flex items-center",children:[u(n),e.jsx("span",{className:"ml-2 capitalize",children:n})]})},n))})]}),e.jsx(o,{})]})}),e.jsx(i,{control:r.control,name:"department",render:({field:s})=>e.jsxs(t,{children:[e.jsx(l,{children:"Department"}),e.jsx(c,{children:e.jsx(d,{...s})}),e.jsx(o,{})]})})]}),e.jsx(i,{control:r.control,name:"contactPhone",render:({field:s})=>e.jsxs(t,{children:[e.jsx(l,{children:"Contact Phone"}),e.jsx(c,{children:e.jsx(d,{...s})}),e.jsx(o,{})]})}),e.jsx(ee,{children:e.jsx(x,{type:"submit",disabled:p.isPending,children:p.isPending?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating..."]}):"Create Admin User"})})]})})]})]}),e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>I(),className:"h-8 gap-1",children:[e.jsx(D,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-center",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(se,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(d,{type:"search",placeholder:"Search admin users...",className:"pl-8",value:m,onChange:s=>q(s.target.value)})]}),e.jsx("div",{children:e.jsxs(k,{value:h,onValueChange:z,children:[e.jsx(A,{className:"w-[150px]",children:e.jsx(F,{placeholder:"All roles"})}),e.jsxs(L,{children:[e.jsx(f,{value:"",children:"All roles"}),R.map(s=>e.jsx(f,{value:s,children:e.jsxs("div",{className:"flex items-center",children:[u(s),e.jsx("span",{className:"ml-2 capitalize",children:s})]})},s))]})]})})]}),e.jsxs("div",{className:"rounded-md border",children:[e.jsx("div",{className:"px-4 py-3 border-b bg-muted/50",children:e.jsxs("div",{className:"grid grid-cols-6 gap-4",children:[e.jsx("div",{className:"col-span-2 flex gap-4",children:e.jsx("span",{className:"font-medium",children:"User"})}),e.jsx("div",{className:"hidden sm:block",children:e.jsx("span",{className:"font-medium",children:"Role"})}),e.jsx("div",{className:"hidden md:block",children:e.jsx("span",{className:"font-medium",children:"Status"})}),e.jsx("div",{className:"hidden lg:block",children:e.jsx("span",{className:"font-medium",children:"Last Login"})}),e.jsx("div",{className:"text-right",children:e.jsx("span",{className:"font-medium",children:"Actions"})})]})}),e.jsx("div",{className:"divide-y",children:C.length>0?C.map(s=>e.jsx("div",{className:"px-4 py-3 hover:bg-muted/50",children:e.jsxs("div",{className:"grid grid-cols-6 gap-4 items-center",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"font-medium",children:s.username}),e.jsx("div",{className:"text-xs text-muted-foreground",children:s.email}),e.jsx("div",{className:"text-xs text-muted-foreground sm:hidden",children:e.jsx("span",{className:"capitalize",children:s.role})})]}),e.jsx("div",{className:"hidden sm:flex items-center",children:e.jsxs("div",{className:"flex items-center",children:[u(s.role),e.jsx("span",{className:"ml-2 capitalize",children:s.role})]})}),e.jsx("div",{className:"hidden md:block",children:e.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-1 text-xs ${s.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:s.isActive?"Active":"Inactive"})}),e.jsx("div",{className:"hidden lg:block text-sm text-muted-foreground",children:s.lastLogin?new Date(s.lastLogin).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(x,{variant:"ghost",size:"icon",className:"h-8 w-8",title:"Edit Admin User",children:e.jsx(le,{className:"h-4 w-4"})}),e.jsx("div",{className:"hidden sm:block",children:e.jsx(ae,{checked:s.isActive,"aria-label":"Toggle active status"})})]})]})},s.id)):e.jsx("div",{className:"px-4 py-8 text-center text-muted-foreground",children:"No admin users found"})})]})]})})}export{ge as default};
