import{c as W,u as te,m as ie,a as le,r as i,n as B,t as u,b as S,j as e,C as m,d as h,e as x,bh as P,f as p,g as F,B as l,y as ne,z as re,D as L,F as $,L as j,I as Y,av as de,a_ as ce,a$ as oe,b0 as ue,b1 as me,b2 as he,bB as xe,X as pe,P as je,s as R,k as g}from"./index-CriQqr38.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=W("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=W("Film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]]),ge=[{value:"mental_health",label:"Mental Health"},{value:"wellness",label:"Wellness"},{value:"motivation",label:"Motivation"},{value:"meditation",label:"Meditation"},{value:"exercise",label:"Exercise"},{value:"nutrition",label:"Nutrition"},{value:"sleep",label:"Sleep"},{value:"mindfulness",label:"Mindfulness"},{value:"other",label:"Other"}];function ye(){const{user:f}=te(),d=ie(),{toast:n}=le(),r=i.useRef(null),[y,M]=i.useState(""),[b,T]=i.useState(""),[Q,U]=i.useState("mental_health"),[_,V]=i.useState(""),[z,q]=i.useState(!0),[v,N]=i.useState(null),[E,A]=i.useState(!1),[O,w]=i.useState(0),[G,k]=i.useState("my-videos"),{data:c,isLoading:H}=B({queryKey:["/api/my-videos"],queryFn:async()=>await(await u("GET","/api/my-videos")).json(),enabled:!!f&&f.isPremium}),{data:o,isLoading:X}=B({queryKey:["/api/videos"],queryFn:async()=>await(await u("GET","/api/videos")).json()}),J=S({mutationFn:async s=>{A(!0),w(0);const a=setInterval(()=>{w(t=>t>=95?(clearInterval(a),95):t+5)},200);try{const t=await u("POST","/api/videos",s,!0);return clearInterval(a),w(100),await t.json()}catch(t){throw clearInterval(a),t}finally{setTimeout(()=>{A(!1),w(0)},1e3)}},onSuccess:()=>{M(""),T(""),U("mental_health"),V(""),q(!0),N(null),r.current&&(r.current.value=""),d.invalidateQueries({queryKey:["/api/my-videos"]}),d.invalidateQueries({queryKey:["/api/videos"]}),n({title:"Video uploaded successfully!",description:"Your video has been uploaded and is now available.",variant:"default"}),k("my-videos")},onError:s=>{n({title:"Upload failed",description:s instanceof Error?s.message:"Failed to upload video. Please try again.",variant:"destructive"})}}),Z=s=>{s.target.files&&s.target.files.length>0&&N(s.target.files[0])},ee=s=>{if(s.preventDefault(),!v){n({title:"No video selected",description:"Please select a video file to upload.",variant:"destructive"});return}if(!y.trim()||!b.trim()){n({title:"Missing information",description:"Please fill in all required fields.",variant:"destructive"});return}const a=new FormData;a.append("videoFile",v),a.append("title",y),a.append("description",b),a.append("category",Q),a.append("tags",_),a.append("isPublic",String(z)),J.mutate(a)},I=S({mutationFn:async s=>await(await u("DELETE",`/api/videos/${s}`)).json(),onSuccess:()=>{d.invalidateQueries({queryKey:["/api/my-videos"]}),d.invalidateQueries({queryKey:["/api/videos"]}),n({title:"Video deleted",description:"Your video has been deleted successfully.",variant:"default"})},onError:s=>{n({title:"Delete failed",description:s instanceof Error?s.message:"Failed to delete video. Please try again.",variant:"destructive"})}}),D=S({mutationFn:async s=>await(await u("POST",`/api/videos/${s}/like`)).json(),onSuccess:()=>{d.invalidateQueries({queryKey:["/api/videos"]}),n({title:"Video liked",description:"You've liked this video!",variant:"default"})}}),se=S({mutationFn:async s=>await(await u("POST",`/api/videos/${s}/share`)).json(),onSuccess:()=>{d.invalidateQueries({queryKey:["/api/videos"]}),n({title:"Video shared",description:"This video has been shared!",variant:"default"})}}),ae=(s,a)=>{const t=`${window.location.origin}/video/${s}`;let C="";switch(a){case"twitter":C=`https://twitter.com/intent/tweet?url=${encodeURIComponent(t)}&text=${encodeURIComponent("Check out this wellness video on MoodSync!")}`;break;case"facebook":C=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(t)}`;break;case"linkedin":C=`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(t)}`;break;default:return}window.open(C,"_blank","width=600,height=400"),se.mutate(s)};return f&&!f.isPremium?e.jsx("div",{className:"container max-w-6xl py-8",children:e.jsxs(m,{className:"w-full",children:[e.jsxs(h,{className:"bg-gradient-to-r from-indigo-500 to-purple-600 text-white",children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-6 w-6"}),"Premium Video Sharing"]}),e.jsx(p,{className:"text-gray-100",children:"Share wellness videos and connect with the community"})]}),e.jsxs(F,{className:"pt-6 text-center",children:[e.jsx("div",{className:"mb-6 flex justify-center",children:e.jsx(K,{className:"h-20 w-20 text-muted-foreground"})}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Premium Feature"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Video sharing is available exclusively to premium users. Upgrade to premium to unlock this feature and share your wellness journey."}),e.jsx(l,{className:"bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700",children:"Upgrade to Premium"})]})]})}):e.jsxs("div",{className:"container max-w-6xl py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 bg-gradient-to-r from-indigo-500 to-purple-600 bg-clip-text text-transparent",children:"Premium Video Sharing"}),e.jsxs(ne,{defaultValue:G,onValueChange:k,className:"w-full",children:[e.jsxs(re,{className:"grid grid-cols-3 mb-6",children:[e.jsx(L,{value:"upload",children:"Upload New Video"}),e.jsx(L,{value:"my-videos",children:"My Videos"}),e.jsx(L,{value:"community",children:"Community Videos"})]}),e.jsx($,{value:"upload",children:e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsx(x,{children:"Upload Wellness Video"}),e.jsx(p,{children:"Share valuable content with the community. All videos are reviewed for compliance with community guidelines."})]}),e.jsx(F,{children:e.jsxs("form",{onSubmit:ee,className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"title",className:"font-medium",children:"Video Title *"}),e.jsx(Y,{id:"title",placeholder:"Enter a descriptive title",value:y,onChange:s=>M(s.target.value),required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"description",className:"font-medium",children:"Description *"}),e.jsx(de,{id:"description",placeholder:"Describe your video content",value:b,onChange:s=>T(s.target.value),rows:4,required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"category",className:"font-medium",children:"Category *"}),e.jsxs(ce,{value:Q,onValueChange:U,required:!0,children:[e.jsx(oe,{children:e.jsx(ue,{placeholder:"Select a category"})}),e.jsx(me,{children:ge.map(s=>e.jsx(he,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"tags",className:"font-medium",children:"Tags (comma separated)"}),e.jsx(Y,{id:"tags",placeholder:"wellness, meditation, health",value:_,onChange:s=>V(s.target.value)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(xe,{id:"isPublic",checked:z,onCheckedChange:q}),e.jsx(j,{htmlFor:"isPublic",children:"Make this video public (visible to all users)"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"video",className:"font-medium",children:"Video File *"}),e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-4 text-center cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>{var s;return(s=r.current)==null?void 0:s.click()},children:[v?e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{className:"h-5 w-5 mr-2 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:v.name})]}),e.jsx(l,{type:"button",variant:"ghost",size:"sm",onClick:s=>{s.stopPropagation(),N(null),r.current&&(r.current.value="")},children:e.jsx(pe,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"py-4",children:[e.jsx(ve,{className:"h-10 w-10 mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Click to select a video file or drag and drop"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"MP4, WebM or MOV (max. 100MB)"})]}),e.jsx("input",{id:"video",ref:r,type:"file",accept:"video/mp4,video/webm,video/quicktime",className:"hidden",onChange:Z,required:!0})]})]}),E&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Uploading..."}),e.jsxs("span",{children:[O,"%"]})]}),e.jsx(je,{value:O,className:"w-full"})]})]}),e.jsxs(R,{className:"flex justify-between px-0",children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>{M(""),T(""),U("mental_health"),V(""),q(!0),N(null),r.current&&(r.current.value="")},children:"Reset"}),e.jsx(l,{type:"submit",disabled:E||!v||!y||!b,className:"bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700",children:E?e.jsxs(e.Fragment,{children:[e.jsx(g,{className:"mr-2 h-4 w-4 animate-spin"}),"Uploading..."]}):e.jsx(e.Fragment,{children:"Upload Video"})})]})]})})]})}),e.jsx($,{value:"my-videos",children:e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsx(x,{children:"My Videos"}),e.jsx(p,{children:"Manage your uploaded video content"})]}),e.jsx(F,{children:H?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(g,{className:"h-8 w-8 animate-spin text-primary"})}):(c==null?void 0:c.length)===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(K,{className:"h-12 w-12 mx-auto mb-3 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-medium",children:"No videos yet"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"You haven't uploaded any videos. Start sharing your content with the community!"}),e.jsx(l,{className:"mt-4",onClick:()=>k("upload"),children:"Upload Your First Video"})]}):e.jsx("div",{className:"grid gap-6 md:grid-cols-2",children:c==null?void 0:c.map(s=>e.jsxs(m,{className:"overflow-hidden",children:[e.jsxs("div",{className:"aspect-video bg-muted relative",children:[s.thumbnailUrl?e.jsx("img",{src:s.thumbnailUrl,alt:s.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"flex items-center justify-center h-full bg-gray-800",children:e.jsx(P,{className:"h-12 w-12 text-gray-400"})}),e.jsx("div",{className:"absolute bottom-2 right-2 bg-black/70 text-white text-xs px-2 py-1 rounded",children:s.isPublic?"Public":"Private"})]}),e.jsxs(h,{className:"p-4",children:[e.jsx(x,{className:"text-lg",children:s.title}),e.jsx(p,{className:"line-clamp-2",children:s.description})]}),e.jsxs(R,{className:"p-4 pt-0 flex justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsxs("span",{children:[s.views||0," views"]}),e.jsx("span",{className:"mx-2",children:"•"}),e.jsxs("span",{children:[s.likes||0," likes"]})]}),e.jsx(l,{variant:"destructive",size:"sm",onClick:()=>{confirm("Are you sure you want to delete this video?")&&I.mutate(s.id)},disabled:I.isPending,children:I.isPending?e.jsx(g,{className:"h-4 w-4 animate-spin"}):"Delete"})]})]},s.id))})})]})}),e.jsx($,{value:"community",children:e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsx(x,{children:"Community Videos"}),e.jsx(p,{children:"Discover wellness content shared by the community"})]}),e.jsx(F,{children:X?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(g,{className:"h-8 w-8 animate-spin text-primary"})}):(o==null?void 0:o.length)===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(K,{className:"h-12 w-12 mx-auto mb-3 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-medium",children:"No community videos"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"There are no public videos available yet. Be the first to share!"}),e.jsx(l,{className:"mt-4",onClick:()=>k("upload"),children:"Upload a Video"})]}):e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:o==null?void 0:o.map(s=>e.jsxs(m,{className:"overflow-hidden",children:[e.jsx("div",{className:"aspect-video bg-muted relative",children:s.thumbnailUrl?e.jsx("img",{src:s.thumbnailUrl,alt:s.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"flex items-center justify-center h-full bg-gray-800",children:e.jsx(P,{className:"h-12 w-12 text-gray-400"})})}),e.jsxs(h,{className:"p-4",children:[e.jsx(x,{className:"text-lg",children:s.title}),e.jsx(p,{className:"line-clamp-2 mb-2",children:s.description}),e.jsxs("div",{className:"text-xs font-medium text-muted-foreground",children:["By ",s.username||"Anonymous User"]})]}),e.jsxs(R,{className:"p-4 pt-0 flex flex-col gap-3",children:[e.jsxs("div",{className:"text-sm text-muted-foreground w-full flex justify-between",children:[e.jsxs("span",{children:[s.views||0," views"]}),e.jsxs("span",{children:[s.likes||0," likes"]})]}),e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsx(l,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>D.mutate(s.id),disabled:D.isPending,children:D.isPending?e.jsx(g,{className:"h-4 w-4 animate-spin"}):"Like"}),e.jsx(l,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>ae(s.id,"twitter"),children:"Share"}),e.jsx(l,{variant:"default",size:"sm",className:"flex-1",onClick:()=>window.open(`/video/${s.id}`,"_blank"),children:"Watch"})]})]})]},s.id))})})]})})]})]})}export{ye as default};
