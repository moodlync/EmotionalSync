import{c as K,j as e,al as m,r as d,bP as Y,bh as Z,a as ee,B as x,ba as ae,a4 as re,a5 as te,a6 as b,I as D,aF as se,a1 as de,C as F,d as I,e as z,f as R,g as $,ah as L,o as U,aQ as ie,V as M}from"./index-BtgMuIOb.js";import{A as le}from"./admin-layout-Dk4BIZxj.js";import{T as ne,a as ce,b as B,c as g,d as oe,e as h}from"./table-D73ZA_Nd.js";import{A as xe,a as me,b as ge}from"./alert-D5p3HB44.js";import{C as he}from"./chevron-left-FCxy29hH.js";import{C as ue}from"./circle-x-DnhVtCo5.js";import"./log-out-DvZviEwE.js";import"./rotate-ccw-ggWisKeU.js";import"./quote-x5gkxPhQ.js";import"./database-CIRPvLLa.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=K("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),H=({className:t,...s})=>e.jsx("nav",{role:"navigation","aria-label":"pagination",className:m("mx-auto flex w-full justify-center",t),...s});H.displayName="Pagination";const G=d.forwardRef(({className:t,...s},c)=>e.jsx("ul",{ref:c,className:m("flex flex-row items-center gap-1",t),...s}));G.displayName="PaginationContent";const u=d.forwardRef(({className:t,...s},c)=>e.jsx("li",{ref:c,className:m("",t),...s}));u.displayName="PaginationItem";const N=({className:t,isActive:s,size:c="icon",...k})=>e.jsx("a",{"aria-current":s?"page":void 0,className:m(Y({variant:s?"outline":"ghost",size:c}),t),...k});N.displayName="PaginationLink";const Q=({className:t,...s})=>e.jsxs(N,{"aria-label":"Go to previous page",size:"default",className:m("gap-1 pl-2.5",t),...s,children:[e.jsx(he,{className:"h-4 w-4"}),e.jsx("span",{children:"Previous"})]});Q.displayName="PaginationPrevious";const q=({className:t,...s})=>e.jsxs(N,{"aria-label":"Go to next page",size:"default",className:m("gap-1 pr-2.5",t),...s,children:[e.jsx("span",{children:"Next"}),e.jsx(Z,{className:"h-4 w-4"})]});q.displayName="PaginationNext";const O=({className:t,...s})=>e.jsxs("span",{"aria-hidden":!0,className:m("flex h-9 w-9 items-center justify-center",t),...s,children:[e.jsx(V,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"More pages"})]});O.displayName="PaginationEllipsis";function Se(){const[t,s]=d.useState([]),[c,k]=d.useState(!0),[w,C]=d.useState(null),[S,W]=d.useState("all"),[a,P]=d.useState(null),[f,X]=d.useState(""),[i,y]=d.useState(1),[o,_]=d.useState(1),[A,T]=d.useState(""),{toast:v}=ee(),p=async()=>{k(!0),C(null);try{const r=await M("GET",`/api/admin/feedbacks?status=${S}&page=${i}&search=${encodeURIComponent(f)}`);if(!r.ok)throw new Error("Failed to fetch user feedbacks");const n=await r.json();s(n.feedbacks),_(Math.ceil(n.total/n.pageSize))}catch(r){C(r instanceof Error?r.message:"An error occurred"),v({variant:"destructive",title:"Error",description:"Failed to load user feedbacks"})}finally{k(!1)}};d.useEffect(()=>{p()},[S,i,f]);const j=async(r,n)=>{try{if(!(await M("PATCH",`/api/admin/feedbacks/${r}`,{status:n,notes:A})).ok)throw new Error("Failed to update feedback status");v({title:"Status Updated",description:`Feedback status changed to ${n}`}),p(),P(null),T("")}catch(l){v({variant:"destructive",title:"Error",description:l instanceof Error?l.message:"Failed to update feedback status"})}},J=r=>{r.preventDefault(),y(1),p()},E={new:"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-300 border-blue-200 dark:border-blue-800",reviewed:"bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-300 border-yellow-200 dark:border-yellow-800",completed:"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-300 border-green-200 dark:border-green-800",ignored:"bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-300 border-gray-200 dark:border-gray-700"};return e.jsx(le,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight dark:text-white",children:"User Feedbacks"}),e.jsx("p",{className:"text-muted-foreground dark:text-gray-300",children:"Manage and respond to user feedback and suggestions"})]}),e.jsxs(x,{onClick:p,variant:"outline",size:"sm",className:"dark:bg-gray-800 dark:text-gray-200 dark:hover:bg-gray-700 dark:border-gray-700",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(re,{defaultValue:"all",className:"w-[400px]",onValueChange:W,children:e.jsxs(te,{className:"dark:bg-gray-800",children:[e.jsx(b,{value:"all",className:"dark:data-[state=active]:bg-primary dark:data-[state=active]:text-primary-foreground dark:text-gray-300",children:"All"}),e.jsx(b,{value:"new",className:"dark:data-[state=active]:bg-primary dark:data-[state=active]:text-primary-foreground dark:text-gray-300",children:"New"}),e.jsx(b,{value:"reviewed",className:"dark:data-[state=active]:bg-primary dark:data-[state=active]:text-primary-foreground dark:text-gray-300",children:"In Progress"}),e.jsx(b,{value:"completed",className:"dark:data-[state=active]:bg-primary dark:data-[state=active]:text-primary-foreground dark:text-gray-300",children:"Completed"})]})}),e.jsxs("form",{onSubmit:J,className:"flex w-full max-w-sm items-center space-x-2",children:[e.jsx(D,{placeholder:"Search feedbacks...",value:f,onChange:r=>X(r.target.value),className:"max-w-[250px] dark:bg-gray-800 dark:text-white dark:placeholder:text-gray-400 dark:border-gray-700"}),e.jsxs(x,{type:"submit",size:"sm",className:"dark:bg-primary dark:text-white dark:hover:bg-primary/90",children:[e.jsx(se,{className:"h-4 w-4 mr-1"}),"Search"]})]})]}),w&&e.jsxs(xe,{variant:"destructive",children:[e.jsx(de,{className:"h-4 w-4"}),e.jsx(me,{children:"Error"}),e.jsx(ge,{children:w})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(F,{children:[e.jsxs(I,{children:[e.jsx(z,{className:"dark:text-white",children:"User Suggestions"}),e.jsx(R,{className:"dark:text-gray-300",children:"Review and manage feedback from users"})]}),e.jsxs($,{children:[c?e.jsx("div",{className:"flex justify-center items-center py-8",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary dark:border-primary-foreground border-t-transparent"})}):t.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground dark:text-gray-400",children:[e.jsx(L,{className:"mx-auto h-12 w-12 opacity-20 dark:opacity-15 mb-2"}),e.jsx("p",{children:"No feedbacks found with the current filter"})]}):e.jsx("div",{className:"rounded-md border dark:border-gray-700",children:e.jsxs(ne,{children:[e.jsx(ce,{className:"dark:bg-gray-800",children:e.jsxs(B,{className:"dark:border-gray-700",children:[e.jsx(g,{className:"w-[80px] dark:text-gray-300",children:"ID"}),e.jsx(g,{className:"dark:text-gray-300",children:"Feedback"}),e.jsx(g,{className:"w-[100px] dark:text-gray-300",children:"User"}),e.jsx(g,{className:"w-[100px] dark:text-gray-300",children:"Status"}),e.jsx(g,{className:"w-[100px] dark:text-gray-300",children:"Date"}),e.jsx(g,{className:"w-[100px] text-right dark:text-gray-300",children:"Actions"})]})}),e.jsx(oe,{children:t.map(r=>e.jsxs(B,{className:`dark:border-gray-700 dark:hover:bg-gray-800/50 ${(a==null?void 0:a.id)===r.id?"bg-muted/50 dark:bg-gray-800/70":""}`,children:[e.jsx(h,{className:"dark:text-gray-300",children:r.id}),e.jsx(h,{className:"font-medium line-clamp-2 dark:text-white",children:r.content}),e.jsx(h,{className:"dark:text-gray-300",children:r.username||(r.userId?`User ${r.userId}`:"Anonymous")}),e.jsx(h,{children:e.jsx(U,{variant:"outline",className:E[r.status]||"",children:r.status})}),e.jsx(h,{className:"dark:text-gray-300",children:new Date(r.createdAt).toLocaleDateString()}),e.jsx(h,{className:"text-right",children:e.jsxs(x,{variant:"ghost",size:"sm",onClick:()=>P(r),className:"dark:hover:bg-gray-700 dark:text-gray-300",children:[e.jsx(V,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Details"})]})})]},r.id))})]})}),e.jsx(H,{className:"mt-4",children:e.jsxs(G,{children:[e.jsx(u,{children:e.jsx(Q,{onClick:()=>y(Math.max(1,i-1)),className:`${i===1?"cursor-not-allowed opacity-50":"cursor-pointer"} dark:text-gray-300 dark:hover:text-white dark:hover:bg-gray-800`})}),Array.from({length:Math.min(5,o)},(r,n)=>{let l=n+1;return o>5&&i>3&&(l=i-3+n),l>o?null:e.jsx(u,{children:e.jsx(N,{isActive:i===l,onClick:()=>y(l),className:"dark:text-gray-300 dark:hover:text-white dark:hover:bg-gray-800 dark:data-[active=true]:bg-primary dark:data-[active=true]:text-white",children:l})},l)}),o>5&&i<o-2&&e.jsx(u,{children:e.jsx(O,{className:"dark:text-gray-400"})}),e.jsx(u,{children:e.jsx(q,{onClick:()=>y(Math.min(o,i+1)),className:`${i===o?"cursor-not-allowed opacity-50":"cursor-pointer"} dark:text-gray-300 dark:hover:text-white dark:hover:bg-gray-800`})})]})})]})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(F,{children:[e.jsxs(I,{children:[e.jsx(z,{className:"dark:text-white",children:"Feedback Details"}),e.jsx(R,{className:"dark:text-gray-300",children:"View and update feedback status"})]}),e.jsx($,{children:a?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground dark:text-gray-300",children:"Feedback Content"}),e.jsx("p",{className:"mt-1 text-sm dark:text-white",children:a.content})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground dark:text-gray-300",children:"Submitted By"}),e.jsx("p",{className:"mt-1 text-sm dark:text-white",children:a.username||(a.userId?`User ${a.userId}`:"Anonymous")})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground dark:text-gray-300",children:"Submission Date"}),e.jsx("p",{className:"mt-1 text-sm dark:text-white",children:new Date(a.createdAt).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground dark:text-gray-300",children:"Status"}),e.jsx(U,{variant:"outline",className:`mt-1 ${E[a.status]||""}`,children:a.status})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground dark:text-gray-300",children:"Source"}),e.jsx("p",{className:"mt-1 text-sm dark:text-white capitalize",children:a.source||"Website"})]})]}),a.reviewedAt&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground dark:text-gray-300",children:"Reviewed On"}),e.jsx("p",{className:"mt-1 text-sm dark:text-white",children:new Date(a.reviewedAt).toLocaleDateString()})]}),a.notes&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground dark:text-gray-300",children:"Admin Notes"}),e.jsx("p",{className:"mt-1 text-sm dark:text-white",children:a.notes})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground dark:text-gray-300 mb-1",children:"Add Notes"}),e.jsx(D,{value:A,onChange:r=>T(r.target.value),placeholder:"Add your notes about this feedback...",className:"mt-1 dark:bg-gray-800 dark:text-white dark:placeholder:text-gray-400"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground dark:text-gray-300 mb-2",children:"Update Status"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(x,{size:"sm",variant:a.status==="new"?"default":"outline",onClick:()=>j(a.id,"new"),className:a.status==="new"?"dark:bg-primary dark:text-white":"dark:bg-gray-800 dark:text-gray-200 dark:border-gray-700 dark:hover:bg-gray-700",children:"New"}),e.jsx(x,{size:"sm",variant:a.status==="reviewed"?"default":"outline",onClick:()=>j(a.id,"reviewed"),className:a.status==="reviewed"?"dark:bg-primary dark:text-white":"dark:bg-gray-800 dark:text-gray-200 dark:border-gray-700 dark:hover:bg-gray-700",children:"In Progress"}),e.jsxs(x,{size:"sm",variant:a.status==="completed"?"default":"outline",onClick:()=>j(a.id,"completed"),className:a.status==="completed"?"dark:bg-primary dark:text-white":"dark:bg-gray-800 dark:text-gray-200 dark:border-gray-700 dark:hover:bg-gray-700",children:[e.jsx(ie,{className:"h-4 w-4 mr-1"}),"Completed"]}),e.jsxs(x,{size:"sm",variant:a.status==="ignored"?"default":"outline",onClick:()=>j(a.id,"ignored"),className:a.status==="ignored"?"dark:bg-primary dark:text-white":"dark:bg-gray-800 dark:text-gray-200 dark:border-gray-700 dark:hover:bg-gray-700",children:[e.jsx(ue,{className:"h-4 w-4 mr-1"}),"Ignore"]})]})]})]}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground dark:text-gray-400",children:[e.jsx(L,{className:"mx-auto h-12 w-12 opacity-20 dark:opacity-15 mb-2"}),e.jsx("p",{children:"Select a feedback to view details"})]})})]})})]})]})})}export{Se as default};
