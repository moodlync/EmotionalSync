import{c as Ke,u as M,a as O,r as S,b as D,j as e,C as k,d as v,e as b,U as Pe,f as w,g as N,A as qe,h as xe,i as Ye,B as h,X as ue,L as Re,I as V,k as A,l as Be,q as U,m as Ie,n as F,o as he,E as Z,p as B,s as Ae,T as de,t as T,v as G,w as E,S as I,x as q,y as $,z as Q,D as j,F as y,G as Te,M as Fe,H as me,J as L,P as z,K as pe,N as je,O as Ue,Q as fe,R as ge,V as ze,W as Oe,Y as Ge,Z as $e,_ as Qe,$ as He,a0 as _e,a1 as We,a2 as Je,a3 as Ze,a4 as Xe,a5 as Ee,a6 as es,a7 as ye}from"./index-vCbmY8Kg.js";import{S as Ne}from"./shield-check-CnXpxti8.js";import{C as R}from"./copy-WZ-XPRgH.js";import{K as ss}from"./key-CWXs5jSH.js";import{A as X,a as ee,B as as,b as se,c as ae,d as te,e as re,f as ie,g as ne,h as le}from"./alert-dialog-BymHdYDZ.js";import{D as Ve}from"./database-Cq9_F0e7.js";import{F as ts}from"./file-text-1BegTflb.js";import{T as rs}from"./trash-DjpUK3_j.js";import{C as is}from"./calendar-B1sc8bqE.js";import{T as ve}from"./thumbs-up-kZbbJJFE.js";import{C as Le}from"./chart-no-axes-column-increasing-DZ_uXEto.js";import{B as ns}from"./bookmark-0-NXbVdn.js";import"./format-DercJ5aE.js";import"./chevron-left-BOYwmLJX.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=Ke("Badge",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}]]);function cs(){const{user:s}=M(),{toast:a}=O(),[r,o]=S.useState(null),[u,m]=S.useState(null),x=p=>{if(p.target.files&&p.target.files[0]){const f=p.target.files[0];if(!f.type.match("image.*")){a({title:"Invalid file type",description:"Please select an image file (JPEG, PNG, etc.)",variant:"destructive"});return}if(f.size>2*1024*1024){a({title:"File too large",description:"Profile picture must be less than 2MB",variant:"destructive"});return}o(f);const P=new FileReader;P.onloadend=()=>{m(P.result)},P.readAsDataURL(f)}},c=()=>{o(null),m(null)},i=D({mutationFn:async p=>await(await fetch("/api/profile/picture",{method:"POST",body:p})).json(),onSuccess:p=>{U.setQueryData(["/api/user"],f=>({...f,profilePicture:p.profilePicture})),a({title:"Success",description:"Your profile picture has been updated"}),c()},onError:p=>{a({title:"Failed to update profile picture",description:p.message,variant:"destructive"})}}),l=p=>{if(p.preventDefault(),!r){a({title:"No file selected",description:"Please select an image to upload",variant:"destructive"});return}const f=new FormData;f.append("profilePicture",r),i.mutate(f)},n=()=>{const p=new FormData;p.append("remove","true"),i.mutate(p)},t=i.isPending;return e.jsxs(k,{children:[e.jsxs(v,{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(Pe,{className:"h-5 w-5"}),"Profile Picture"]}),e.jsx(w,{children:"Update your profile picture or avatar"})]}),e.jsx(N,{children:e.jsxs("form",{onSubmit:l,className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx(qe,{className:"h-32 w-32 border-2 border-primary/20",children:u?e.jsx(xe,{src:u,alt:"Preview"}):s!=null&&s.profilePicture?e.jsx(xe,{src:s.profilePicture,alt:s.username}):e.jsx(Ye,{className:"text-4xl bg-primary/10",children:s==null?void 0:s.username.charAt(0).toUpperCase()})}),((s==null?void 0:s.profilePicture)||u)&&e.jsxs(h,{type:"button",variant:"outline",size:"sm",onClick:n,disabled:t,children:[e.jsx(ue,{className:"h-4 w-4 mr-1"}),"Remove Picture"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Re,{htmlFor:"profile-picture",children:"Upload new image"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{id:"profile-picture",type:"file",accept:"image/*",onChange:x,disabled:t,className:"flex-1"}),r&&e.jsx(h,{type:"button",variant:"ghost",size:"icon",onClick:c,children:e.jsx(ue,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Maximum file size: 2MB. Supported formats: JPEG, PNG."})]}),r&&e.jsx(h,{type:"submit",className:"w-full",disabled:t,children:t?e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"h-4 w-4 mr-2 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),"Update Profile Picture"]})})]})})]})}function os(){const[s,a]=S.useState(null),[r,o]=S.useState(!1),[u,m]=S.useState(!1),[x,c]=S.useState(""),[i,l]=S.useState(1),{toast:n}=O(),t=Ie(),{data:p,isLoading:f}=F({queryKey:["/api/auth/2fa/status"],queryFn:async()=>(await T("GET","/api/auth/2fa/status")).json()}),P=D({mutationFn:async()=>(await T("POST","/api/auth/2fa/setup")).json(),onSuccess:d=>{a(d),l(2)},onError:d=>{n({title:"Setup Error",description:d.message,variant:"destructive"})}}),H=D({mutationFn:async()=>(await T("POST","/api/auth/2fa/verify",{token:x})).json(),onSuccess:()=>{n({title:"2FA Enabled",description:"Two-factor authentication has been enabled for your account"}),l(3),t.invalidateQueries({queryKey:["/api/auth/2fa/status"]})},onError:d=>{n({title:"Verification Error",description:d.message,variant:"destructive"})}}),_=D({mutationFn:async d=>(await T("POST","/api/auth/2fa/disable",{token:d})).json(),onSuccess:()=>{n({title:"2FA Disabled",description:"Two-factor authentication has been disabled for your account"}),t.invalidateQueries({queryKey:["/api/auth/2fa/status"]})},onError:d=>{n({title:"Error",description:d.message,variant:"destructive"})}}),W=D({mutationFn:async d=>(await T("POST","/api/auth/2fa/new-backup-codes",{token:d})).json(),onSuccess:d=>{n({title:"New Backup Codes",description:"New backup codes have been generated"}),a(g=>g?{...g,backupCodes:d.backupCodes}:null)},onError:d=>{n({title:"Error",description:d.message,variant:"destructive"})}}),J=D({mutationFn:async d=>(await T("POST","/api/auth/2fa/new-recovery-key",{token:d})).json(),onSuccess:d=>{n({title:"New Recovery Key",description:"A new recovery key has been generated"}),a(g=>g?{...g,recoveryKey:d.recoveryKey}:null)},onError:d=>{n({title:"Error",description:d.message,variant:"destructive"})}}),Y=(d,g)=>{navigator.clipboard.writeText(d).then(()=>{n({title:"Copied",description:`${g} copied to clipboard`})}).catch(()=>{n({title:"Error",description:"Failed to copy to clipboard",variant:"destructive"})})};return f?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(A,{className:"h-8 w-8 animate-spin text-primary"})}):p!=null&&p.enabled?e.jsx("div",{className:"space-y-6",children:e.jsxs(k,{children:[e.jsxs(v,{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-5 w-5 text-green-500"}),"Two-Factor Authentication"]}),e.jsx(w,{children:"Your account is protected with two-factor authentication"})]}),e.jsxs(N,{className:"space-y-4",children:[e.jsx("div",{className:"rounded-md bg-green-50 p-4 border border-green-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(he,{className:"h-5 w-5 text-green-500 mr-2"}),e.jsx("p",{className:"text-sm font-medium text-green-800",children:"Two-factor authentication is enabled for your account"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Backup Codes"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"If you lose access to your authentication app, you can use these backup codes to sign in. Each code can only be used once."}),e.jsx("div",{className:"rounded-md bg-muted p-4",children:e.jsx("div",{className:"grid grid-cols-2 gap-2",children:s!=null&&s.backupCodes?s.backupCodes.map((d,g)=>e.jsx("div",{className:"font-mono text-xs",children:d},g)):e.jsx("p",{className:"text-sm col-span-2",children:"Backup codes are not available. Generate new ones."})})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{type:"text",placeholder:"Enter verification code",value:x,onChange:d=>c(d.target.value),maxLength:6,className:"w-36"}),e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>W.mutate(x),disabled:W.isPending||x.length!==6,children:[W.isPending?e.jsx(A,{className:"h-4 w-4 animate-spin mr-2"}):null,"Generate New Codes"]}),s!=null&&s.backupCodes?e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>Y(s.backupCodes.join(`
`),"Backup codes"),children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Copy"]}):null]})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Recovery Key"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Your recovery key is a secure way to regain access to your account if you lose your device and backup codes. Keep it in a safe place."}),e.jsxs("div",{className:"relative",children:[e.jsx(V,{type:u?"text":"password",value:(s==null?void 0:s.recoveryKey)||"••••••••••••••••••••••••••",readOnly:!0,className:"font-mono pr-10"}),e.jsx(h,{type:"button",variant:"ghost",size:"sm",className:"absolute right-1 top-1 h-7 w-7 p-0",onClick:()=>m(!u),children:u?e.jsx(Z,{className:"h-4 w-4"}):e.jsx(B,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{type:"text",placeholder:"Enter verification code",value:x,onChange:d=>c(d.target.value),maxLength:6,className:"w-36"}),e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>J.mutate(x),disabled:J.isPending||x.length!==6,children:[J.isPending?e.jsx(A,{className:"h-4 w-4 animate-spin mr-2"}):null,"Generate New Key"]}),s!=null&&s.recoveryKey?e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>Y(s.recoveryKey,"Recovery key"),children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Copy"]}):null]})]})]}),e.jsxs(Ae,{className:"flex justify-between",children:[e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(ss,{className:"h-4 w-4 mr-2"}),"Disable two-factor authentication"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{type:"text",placeholder:"Verification code",value:x,onChange:d=>c(d.target.value),maxLength:6,className:"w-36"}),e.jsxs(h,{variant:"destructive",onClick:()=>_.mutate(x),disabled:_.isPending||x.length!==6,children:[_.isPending?e.jsx(A,{className:"h-4 w-4 animate-spin mr-2"}):null,"Disable 2FA"]})]})]})]})}):e.jsx("div",{className:"space-y-6",children:e.jsxs(k,{children:[e.jsxs(v,{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-5 w-5"}),"Two-Factor Authentication"]}),e.jsx(w,{children:"Add an extra layer of security to your account by requiring a verification code"})]}),e.jsxs(N,{children:[i===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm",children:"Two-factor authentication adds an extra layer of security to your account. In addition to your password, you'll need to enter a code from your authenticator app when signing in."}),e.jsx("div",{className:"rounded-md bg-amber-50 p-4 border border-amber-200",children:e.jsxs("div",{className:"flex",children:[e.jsx(de,{className:"h-5 w-5 text-amber-500 mr-2"}),e.jsxs("div",{className:"text-sm text-amber-800",children:[e.jsx("p",{className:"font-medium",children:"Important"}),e.jsxs("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[e.jsx("li",{children:"You'll need an authenticator app like Google Authenticator, Authy, or Microsoft Authenticator"}),e.jsx("li",{children:"We'll provide backup codes you should save in a secure place"}),e.jsx("li",{children:"You'll also receive a recovery key - store it separately from your backup codes"})]})]})]})}),e.jsxs(h,{onClick:()=>P.mutate(),disabled:P.isPending,className:"w-full sm:w-auto",children:[P.isPending?e.jsx(A,{className:"h-4 w-4 animate-spin mr-2"}):null,"Set Up Two-Factor Authentication"]})]}),i===2&&s&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-medium",children:"1. Scan QR Code"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Scan this QR code with your authenticator app (Google Authenticator, Authy, etc.)"}),e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:s.qrCodeUrl,alt:"QR Code",className:"border rounded-md p-2 bg-white",style:{width:"200px",height:"200px"}})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"If you can't scan the QR code, enter this code manually:"}),e.jsxs("div",{className:"relative",children:[e.jsx(V,{type:r?"text":"password",value:s.secret,readOnly:!0,className:"font-mono pr-10"}),e.jsx(h,{type:"button",variant:"ghost",size:"sm",className:"absolute right-1 top-1 h-7 w-7 p-0",onClick:()=>o(!r),children:r?e.jsx(Z,{className:"h-4 w-4"}):e.jsx(B,{className:"h-4 w-4"})})]}),e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>Y(s.secret,"Secret key"),children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Copy Secret Key"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-medium",children:"2. Backup Codes"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Save these backup codes in a secure place. If you lose your device, you can use these to sign in. Each code can only be used once."}),e.jsx("div",{className:"bg-muted p-4 rounded-md",children:e.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.backupCodes.map((d,g)=>e.jsx("div",{className:"font-mono text-xs",children:d},g))})}),e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>Y(s.backupCodes.join(`
`),"Backup codes"),children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Copy Backup Codes"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-medium",children:"3. Recovery Key"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Save this recovery key in a secure place different from your backup codes. You'll need it if you lose access to your device and backup codes."}),e.jsxs("div",{className:"relative",children:[e.jsx(V,{type:u?"text":"password",value:s.recoveryKey,readOnly:!0,className:"font-mono pr-10"}),e.jsx(h,{type:"button",variant:"ghost",size:"sm",className:"absolute right-1 top-1 h-7 w-7 p-0",onClick:()=>m(!u),children:u?e.jsx(Z,{className:"h-4 w-4"}):e.jsx(B,{className:"h-4 w-4"})})]}),e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>Y(s.recoveryKey,"Recovery key"),children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Copy Recovery Key"]}),e.jsx("div",{className:"rounded-md bg-amber-50 p-4 border border-amber-200",children:e.jsxs("div",{className:"flex",children:[e.jsx(de,{className:"h-5 w-5 text-amber-500 mr-2 flex-shrink-0"}),e.jsxs("p",{className:"text-sm text-amber-800",children:[e.jsx("strong",{children:"Important:"})," Store your recovery key in a secure location separate from your backup codes. Anyone with this key can bypass 2FA on your account."]})]})})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsx("h3",{className:"font-medium",children:"4. Verify Code"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter the verification code from your authenticator app to complete setup"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(V,{type:"text",placeholder:"6-digit code",value:x,onChange:d=>c(d.target.value),maxLength:6,className:"w-36"}),e.jsxs(h,{onClick:()=>H.mutate(),disabled:H.isPending||x.length!==6,children:[H.isPending?e.jsx(A,{className:"h-4 w-4 animate-spin mr-2"}):null,"Verify and Enable"]})]})]})]}),i===3&&e.jsx("div",{className:"rounded-md bg-green-50 p-4 border border-green-200",children:e.jsxs("div",{className:"flex",children:[e.jsx(he,{className:"h-5 w-5 text-green-500 mr-2"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-800",children:"Two-factor authentication enabled"}),e.jsx("p",{className:"text-sm text-green-700 mt-1",children:"Your account is now protected with two-factor authentication. When signing in, you'll need to provide your password and a verification code from your authenticator app."})]})]})})]})]})})}function ds(){const{user:s,logoutMutation:a}=M(),{toast:r}=O();S.useState(!1);const o=D({mutationFn:async()=>(await T("POST","/api/account/delete")).json(),onSuccess:()=>{r({title:"Account Deletion Requested",description:"Your account deletion request has been submitted. You will receive an email confirmation. Your account will be fully deleted in 3-7 business days."}),a.mutate()},onError:i=>{r({title:"Error",description:i.message||"Failed to request account deletion",variant:"destructive"})}}),u=D({mutationFn:async()=>(await T("POST","/api/account/delete-data")).json(),onSuccess:()=>{r({title:"Data Deletion Requested",description:"Your data deletion request has been submitted. You will receive an email confirmation. Your data will be fully removed in 3-7 business days."})},onError:i=>{r({title:"Error",description:i.message||"Failed to request data deletion",variant:"destructive"})}}),m=s==null?void 0:s.isPremium,x=D({mutationFn:async()=>(await T("POST","/api/subscription/cancel")).json(),onSuccess:i=>{r({title:"Subscription Cancelled",description:`Your subscription has been cancelled. You will continue to have premium access until ${new Date(i.expiresAt).toLocaleDateString()}.`})},onError:i=>{r({title:"Error",description:i.message||"Failed to cancel subscription",variant:"destructive"})}}),c=D({mutationFn:async()=>(await T("POST","/api/subscription/renew")).json(),onSuccess:i=>{r({title:"Subscription Renewed",description:"Your subscription has been renewed successfully."})},onError:i=>{r({title:"Error",description:i.message||"Failed to renew subscription",variant:"destructive"})}});return e.jsxs("div",{className:"space-y-6",children:[m&&e.jsxs(k,{children:[e.jsxs(v,{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5 text-primary"}),"Subscription Management"]}),e.jsx(w,{children:"Manage your premium subscription settings"})]}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium",children:"Current Plan"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground mr-2",children:(s==null?void 0:s.premiumPlanType)||"Premium"}),e.jsx(E,{variant:"secondary",className:"bg-primary/10 text-primary",children:"Active"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Renews On"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s!=null&&s.premiumExpiryDate?new Date(s.premiumExpiryDate).toLocaleDateString():"Not available"})]})]}),e.jsx(I,{}),e.jsx("div",{className:"rounded-md bg-amber-50 p-4 border border-amber-200",children:e.jsxs("div",{className:"flex",children:[e.jsx(de,{className:"h-5 w-5 text-amber-500 shrink-0 mr-2"}),e.jsxs("div",{className:"text-sm text-amber-800",children:[e.jsx("p",{className:"font-medium",children:"Important Information"}),e.jsxs("ul",{className:"mt-1 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Cancelling your subscription will not provide a refund unless you are within the 14-day money-back guarantee period"}),e.jsx("li",{children:"You will continue to have premium access until your current period ends"}),e.jsx("li",{children:"After cancellation, your account will revert to the free plan"}),e.jsx("li",{children:"If you're within 14 days of your initial purchase, contact support for a refund"})]})]})]})})]}),e.jsxs(Ae,{className:"flex justify-between",children:[e.jsxs(X,{children:[e.jsx(ee,{asChild:!0,children:e.jsxs(h,{variant:"outline",className:"border-destructive text-destructive hover:bg-destructive/10",children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),"Cancel Subscription"]})}),e.jsxs(se,{children:[e.jsxs(ae,{children:[e.jsx(te,{children:"Cancel Your Subscription?"}),e.jsxs(re,{children:[e.jsxs("p",{className:"mb-2",children:["Are you sure you want to cancel your subscription? You will continue to have premium access until your current period ends on ",e.jsx("strong",{children:s!=null&&s.premiumExpiryDate?new Date(s.premiumExpiryDate).toLocaleDateString():"N/A"}),"."]}),e.jsxs("p",{className:"mb-2",children:[e.jsx("strong",{children:"Refund Policy:"})," If you're within the 14-day money-back guarantee period of your initial purchase, please contact our support team for a full refund. Otherwise, no refunds will be issued for the current billing period."]})]})]}),e.jsxs(ie,{children:[e.jsx(ne,{children:"Keep My Subscription"}),e.jsx(le,{onClick:()=>x.mutate(),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Yes, Cancel Subscription"})]})]})]}),(s==null?void 0:s.subscriptionCancelled)&&e.jsx(h,{variant:"default",onClick:()=>c.mutate(),disabled:c.isPending,children:c.isPending?"Processing...":"Renew Subscription"})]})]}),e.jsxs(k,{children:[e.jsxs(v,{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"h-5 w-5 text-red-500"}),"Account & Data Management"]}),e.jsx(w,{children:"Options for managing your personal data and account"})]}),e.jsxs(N,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-medium mb-2",children:"Data Deletion"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Request deletion of your personal data while keeping your account active. This will remove your emotional data, posts, and personal information."}),e.jsxs(X,{children:[e.jsx(ee,{asChild:!0,children:e.jsxs(h,{variant:"outline",className:"border-amber-200 bg-amber-50 text-amber-900 hover:bg-amber-100",children:[e.jsx(ts,{className:"h-4 w-4 mr-2"}),"Request Data Deletion"]})}),e.jsxs(se,{children:[e.jsxs(ae,{children:[e.jsx(te,{children:"Delete Your Personal Data?"}),e.jsxs(re,{children:[e.jsx("p",{className:"mb-2",children:"This will permanently remove your personal data from our systems, including:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 mb-4",children:[e.jsx("li",{children:"Emotional tracking history"}),e.jsx("li",{children:"User-generated content"}),e.jsx("li",{children:"Personal information"})]}),e.jsx("p",{className:"mb-2",children:"Your account will remain active but with minimal information. This process takes 3-7 business days to complete and cannot be undone."}),e.jsx("p",{children:"You will receive an email confirmation once your data has been deleted."})]})]}),e.jsxs(ie,{children:[e.jsx(ne,{children:"Cancel"}),e.jsx(le,{onClick:()=>u.mutate(),className:"bg-amber-600 text-white hover:bg-amber-700",children:"Delete My Data"})]})]})]})]}),e.jsx(I,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-medium mb-2 text-red-600",children:"Account Deletion"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Permanently delete your entire account including all data, posts, and subscription information. This action cannot be undone."}),e.jsxs(X,{children:[e.jsx(ee,{asChild:!0,children:e.jsxs(h,{variant:"destructive",children:[e.jsx(rs,{className:"h-4 w-4 mr-2"}),"Delete My Account"]})}),e.jsxs(se,{children:[e.jsxs(ae,{children:[e.jsx(te,{children:"Delete Your Account Permanently?"}),e.jsxs(re,{children:[e.jsx("p",{className:"mb-2",children:"This will permanently delete your account and all associated data:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 mb-4",children:[e.jsx("li",{children:"Your profile and all personal information"}),e.jsx("li",{children:"All emotional tracking data"}),e.jsx("li",{children:"All posts, messages, and content"}),e.jsx("li",{children:"Your subscription (subject to our 14-day money-back guarantee policy)"})]}),e.jsxs("p",{className:"mb-2",children:["This process takes 3-7 business days to complete and ",e.jsx("strong",{children:"cannot be undone"}),"."]}),e.jsx("p",{children:"You will receive an email confirmation when the process begins and when it completes."})]})]}),e.jsxs(ie,{children:[e.jsx(ne,{children:"Cancel"}),e.jsx(le,{onClick:()=>o.mutate(),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Permanently Delete Account"})]})]})]})]})]})]})]})}const be=s=>{switch(s){case"easy":return"Easy";case"moderate":return"Moderate";case"hard":return"Hard";case"extreme":return"Extreme";default:return"Unknown"}},we=s=>{switch(s){case"easy":return"bg-green-50 text-green-700 border-green-300";case"moderate":return"bg-blue-50 text-blue-700 border-blue-300";case"hard":return"bg-purple-50 text-purple-700 border-purple-300";case"extreme":return"bg-red-50 text-red-800 border-red-300";default:return"bg-gray-50 text-gray-700 border-gray-300"}},ke=s=>{switch(s){case"easy":return e.jsx(me,{className:"h-12 w-12 text-green-500"});case"moderate":return e.jsx(Fe,{className:"h-12 w-12 text-blue-500"});case"hard":return e.jsx(q,{className:"h-12 w-12 text-purple-500"});case"extreme":return e.jsx(Te,{className:"h-12 w-12 text-red-500"});default:return e.jsx(ls,{className:"h-12 w-12 text-gray-500"})}};function ms(){const{user:s}=M(),[a,r]=S.useState("all"),{data:o,isLoading:u}=F({queryKey:["/api/badges"],queryFn:async()=>{const t=await fetch("/api/badges");if(!t.ok)throw new Error("Failed to fetch badges");return t.json()}}),{data:m,isLoading:x}=F({queryKey:["/api/user/badges"],queryFn:async()=>{const t=await fetch("/api/user/badges");if(!t.ok)throw new Error("Failed to fetch user badges");return t.json()},enabled:!!s}),c=u||x,i=t=>t?a==="all"?t:t.filter(p=>p.difficulty===a):[],l=t=>(m==null?void 0:m.some(p=>p.id===t))||!1,n=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return e.jsxs(k,{children:[e.jsxs(v,{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5"}),"Your Badges"]}),e.jsx(w,{children:"Badges earned through completing challenges of varying difficulty"})]}),e.jsx(N,{children:c?e.jsx("div",{className:"flex justify-center items-center h-40",children:e.jsx("div",{className:"animate-spin w-10 h-10 border-4 border-primary border-t-transparent rounded-full"})}):e.jsx("div",{className:"space-y-6",children:e.jsxs($,{defaultValue:"earned",className:"w-full",children:[e.jsxs(Q,{className:"grid w-full grid-cols-2",children:[e.jsxs(j,{value:"earned",children:["Earned (",(m==null?void 0:m.length)||0,")"]}),e.jsxs(j,{value:"available",children:["Available (",((o==null?void 0:o.length)||0)-((m==null?void 0:m.length)||0),")"]})]}),e.jsx(y,{value:"earned",className:"pt-4",children:m&&m.length>0?e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.jsx(h,{variant:a==="all"?"default":"outline",size:"sm",onClick:()=>r("all"),children:"All"}),e.jsx(h,{variant:a==="easy"?"default":"outline",size:"sm",onClick:()=>r("easy"),className:"text-green-700",children:"Easy"}),e.jsx(h,{variant:a==="moderate"?"default":"outline",size:"sm",onClick:()=>r("moderate"),className:"text-blue-700",children:"Moderate"}),e.jsx(h,{variant:a==="hard"?"default":"outline",size:"sm",onClick:()=>r("hard"),className:"text-purple-700",children:"Hard"}),e.jsx(h,{variant:a==="extreme"?"default":"outline",size:"sm",onClick:()=>r("extreme"),className:"text-red-700",children:"Extreme"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i(m).map(t=>e.jsxs("div",{className:"flex p-4 border rounded-lg hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"flex-shrink-0 mr-4 flex items-center justify-center",children:t.imageUrl?e.jsx("img",{src:t.imageUrl,alt:t.name,className:"w-16 h-16 object-contain"}):ke(t.difficulty)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:t.name}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:t.description}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(E,{variant:"outline",className:we(t.difficulty),children:be(t.difficulty)}),t.earnedAt&&e.jsxs(E,{variant:"outline",className:"bg-yellow-50 text-yellow-700 border-yellow-300",children:["Earned on ",n(t.earnedAt)]})]})]})]},t.id))}),i(m).length===0&&e.jsx("div",{className:"text-center py-6 text-gray-500",children:"No badges found for the selected filter."})]}):e.jsxs("div",{className:"text-center py-10 text-gray-500",children:[e.jsx(q,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),e.jsx("h3",{className:"text-lg font-medium mb-1",children:"No Badges Yet"}),e.jsx("p",{children:"Complete challenges to earn badges and showcase your achievements!"})]})}),e.jsxs(y,{value:"available",className:"pt-4",children:[o&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.filter(t=>!l(t.id)).map(t=>e.jsxs("div",{className:"flex p-4 border rounded-lg bg-gray-50/50",children:[e.jsx("div",{className:"flex-shrink-0 mr-4 flex items-center justify-center opacity-70",children:t.imageUrl?e.jsx("img",{src:t.imageUrl,alt:t.name,className:"w-16 h-16 object-contain grayscale"}):ke(t.difficulty)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:t.name}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:t.description}),e.jsx(E,{variant:"outline",className:we(t.difficulty),children:be(t.difficulty)})]})]},t.id))}),o&&o.filter(t=>!l(t.id)).length===0&&e.jsxs("div",{className:"text-center py-10 text-gray-500",children:[e.jsx(q,{className:"h-12 w-12 mx-auto mb-3 text-green-500"}),e.jsx("h3",{className:"text-lg font-medium mb-1",children:"All Badges Collected!"}),e.jsx("p",{children:"Congratulations! You've earned all available badges."})]})]})]})})})]})}function Ce(s,a){if(a===0)return 100;const r=s/a*100;return Math.min(Math.max(r,0),100)}function ce(s){switch(s){case"easy":return"Easy";case"moderate":return"Moderate";case"hard":return"Hard";case"extreme":return"Extreme";default:return s}}function Se(s){switch(s){case"easy":return"bg-green-100 text-green-800 border-green-300";case"moderate":return"bg-blue-100 text-blue-800 border-blue-300";case"hard":return"bg-purple-100 text-purple-800 border-purple-300";case"extreme":return"bg-red-100 text-red-800 border-red-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}}function xs(s){switch(s){case"easy":return e.jsx(me,{className:"h-5 w-5 text-green-600"});case"moderate":return e.jsx(Fe,{className:"h-5 w-5 text-blue-600"});case"hard":return e.jsx(q,{className:"h-5 w-5 text-purple-600"});case"extreme":return e.jsx(Te,{className:"h-5 w-5 text-red-600"});default:return e.jsx(L,{className:"h-5 w-5 text-gray-600"})}}function us(){M();const{toast:s}=O(),[a,r]=S.useState("all"),{data:o,isLoading:u}=F({queryKey:["/api/gamification/challenges"],queryFn:async()=>{const l=await fetch("/api/gamification/challenges");if(!l.ok)throw new Error("Failed to fetch challenges");return l.json()}}),m=D({mutationFn:async l=>{const n=await fetch(`/api/challenges/complete/${l}`,{method:"POST"});if(!n.ok){const t=await n.json();throw new Error(t.error||"Failed to complete challenge")}return n.json()},onSuccess:l=>{s({title:"Challenge Completed!",description:`You earned ${l.tokensAwarded} tokens`,variant:"default"}),l.badgeAwarded&&s({title:"New Badge Earned!",description:`You've earned the "${l.badgeAwarded.name}" badge`,variant:"default"}),U.invalidateQueries({queryKey:["/api/gamification/challenges"]}),U.invalidateQueries({queryKey:["/api/tokens"]}),U.invalidateQueries({queryKey:["/api/user/badges"]})},onError:l=>{s({title:"Failed to complete challenge",description:l.message,variant:"destructive"})}}),x=()=>{const l={easy:[],moderate:[],hard:[],extreme:[]};return o&&o.forEach(n=>{l[n.difficulty].push(n)}),l},c=l=>{m.mutate(l)},i=x();return e.jsxs(k,{children:[e.jsxs(v,{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-5 w-5"}),"Challenges"]}),e.jsx(w,{children:"Complete challenges to earn tokens and badges"})]}),e.jsx(N,{children:u?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full"})}):e.jsxs($,{defaultValue:"all",className:"w-full",children:[e.jsxs(Q,{className:"grid grid-cols-5 mb-4",children:[e.jsx(j,{value:"all",onClick:()=>r("all"),children:"All"}),e.jsx(j,{value:"easy",onClick:()=>r("easy"),className:"text-green-700",children:"Easy"}),e.jsx(j,{value:"moderate",onClick:()=>r("moderate"),className:"text-blue-700",children:"Medium"}),e.jsx(j,{value:"hard",onClick:()=>r("hard"),className:"text-purple-700",children:"Hard"}),e.jsx(j,{value:"extreme",onClick:()=>r("extreme"),className:"text-red-700",children:"Extreme"})]}),e.jsx(y,{value:"all",className:"space-y-6",children:Object.entries(i).map(([l,n])=>n.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[xs(l),ce(l)," Challenges"]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:n.map(t=>e.jsxs("div",{className:`border rounded-lg p-4 ${t.completed?"bg-green-50 border-green-200":""}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"font-medium",children:t.title}),e.jsx(E,{variant:"outline",className:Se(t.difficulty),children:ce(t.difficulty)})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:t.description}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:["Progress: ",t.currentValue,"/",t.targetValue]}),e.jsxs("span",{className:"font-medium text-primary",children:[t.rewardTokens," tokens"]})]}),e.jsx(z,{value:Ce(t.currentValue,t.targetValue)}),t.completed?e.jsxs(h,{disabled:!0,className:"w-full bg-green-600 hover:bg-green-700",children:[e.jsx(pe,{className:"mr-2 h-4 w-4"}),"Completed"]}):e.jsx(h,{disabled:m.isPending||t.currentValue<t.targetValue,onClick:()=>c(t.id),className:"w-full",children:m.isPending?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin mr-2 h-4 w-4 border-2 border-white border-t-transparent rounded-full"}),"Processing..."]}):e.jsx(e.Fragment,{children:t.currentValue>=t.targetValue?e.jsxs(e.Fragment,{children:[e.jsx(je,{className:"mr-2 h-4 w-4"}),"Claim Reward"]}):e.jsx(e.Fragment,{children:"In Progress"})})})]})]},t.id))})]},l))}),["easy","moderate","hard","extreme"].map(l=>e.jsx(y,{value:l,className:"space-y-4",children:i[l].length>0?e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:i[l].map(n=>e.jsxs("div",{className:`border rounded-lg p-4 ${n.completed?"bg-green-50 border-green-200":""}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"font-medium",children:n.title}),e.jsx(E,{variant:"outline",className:Se(n.difficulty),children:ce(n.difficulty)})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:n.description}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:["Progress: ",n.currentValue,"/",n.targetValue]}),e.jsxs("span",{className:"font-medium text-primary",children:[n.rewardTokens," tokens"]})]}),e.jsx(z,{value:Ce(n.currentValue,n.targetValue)}),n.completed?e.jsxs(h,{disabled:!0,className:"w-full bg-green-600 hover:bg-green-700",children:[e.jsx(pe,{className:"mr-2 h-4 w-4"}),"Completed"]}):e.jsx(h,{disabled:m.isPending||n.currentValue<n.targetValue,onClick:()=>c(n.id),className:"w-full",children:m.isPending?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin mr-2 h-4 w-4 border-2 border-white border-t-transparent rounded-full"}),"Processing..."]}):e.jsx(e.Fragment,{children:n.currentValue>=n.targetValue?e.jsxs(e.Fragment,{children:[e.jsx(je,{className:"mr-2 h-4 w-4"}),"Claim Reward"]}):e.jsx(e.Fragment,{children:"In Progress"})})})]})]},n.id))}):e.jsxs("div",{className:"text-center py-10 text-gray-500",children:[e.jsx(L,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),e.jsx("p",{className:"font-medium",children:"No challenges available for this difficulty"})]})},l))]})})]})}function hs(){M();const[s,a]=S.useState(new Date),{data:r,isLoading:o}=F({queryKey:["/api/gamification/profile"],queryFn:async()=>{const c=await fetch("/api/gamification/profile");if(!c.ok)throw new Error("Failed to fetch profile");return c.json()}}),m=(()=>{if(!r||!r.lastCheckIn)return[];const c=[],i=new Date,l=new Date(r.lastCheckIn);c.push(new Date(l)),new Date().setDate(i.getDate()-60);const t=Math.min(r.currentStreak/10,.9),p=Math.min(r.currentStreak,60);for(let f=1;f<=p;f++){const P=new Date;P.setDate(i.getDate()-f),Math.random()<t&&c.push(new Date(P))}return c})(),x=()=>{if(!r)return null;let c="",i="";return r.currentStreak>=30?(c="Ultimate Streak!",i="bg-purple-100 text-purple-800 border-purple-300"):r.currentStreak>=14?(c="Blazing Streak!",i="bg-red-100 text-red-800 border-red-300"):r.currentStreak>=7?(c="Strong Streak!",i="bg-amber-100 text-amber-800 border-amber-300"):r.currentStreak>=3?(c="Building Streak!",i="bg-green-100 text-green-800 border-green-300"):(c="Getting Started",i="bg-blue-100 text-blue-800 border-blue-300"),e.jsx(E,{variant:"outline",className:i,children:c})};return e.jsxs(k,{children:[e.jsxs(v,{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-5 w-5"}),"Streaks & Check-ins"]}),e.jsx(w,{children:"Track your daily check-in streaks and consistency"})]}),e.jsx(N,{children:o?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full"})}):r?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:gap-8",children:[e.jsxs("div",{className:"md:flex-1 bg-muted rounded-lg p-4 flex items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Current Streak"}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-3xl font-bold",children:r.currentStreak}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"days"})]})]}),e.jsx(L,{className:"h-10 w-10 text-primary opacity-80"})]}),e.jsxs("div",{className:"md:flex-1 bg-muted rounded-lg p-4 flex items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Longest Streak"}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-3xl font-bold",children:r.longestStreak}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"days"})]})]}),e.jsx(q,{className:"h-10 w-10 text-primary opacity-80"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Last check-in: ",r.lastCheckIn?new Date(r.lastCheckIn).toLocaleDateString():"Never"]})]}),x()]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-medium flex items-center gap-2",children:[e.jsx(Ue,{className:"h-4 w-4"}),"Check-in Calendar"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-100 rounded-full"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Check-in"})]})]}),e.jsx(is,{mode:"single",selected:s,onSelect:a,className:"rounded-md border",disabled:{after:new Date},showOutsideDays:!1,components:{Day:({day:c,...i})=>e.jsx("div",{className:`relative ${m.some(l=>l.getDate()===c.getDate()&&l.getMonth()===c.getMonth()&&l.getFullYear()===c.getFullYear())?"bg-green-100 text-green-900 font-medium rounded-full":""}`,...i,children:c.getDate()})}}),e.jsxs("div",{className:"mt-4 text-sm text-center text-muted-foreground",children:[e.jsx("p",{children:"Keep your streak going by checking in daily to earn more rewards!"}),e.jsx("p",{className:"mt-1 text-xs",children:"Regular check-ins increase your chances of earning special badges."})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{className:"border rounded p-2",children:[e.jsxs("div",{className:"text-2xl font-bold",children:[Math.floor(r.currentStreak/30*100),"%"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Monthly Goal"})]}),e.jsxs("div",{className:"border rounded p-2",children:[e.jsxs("div",{className:"text-2xl font-bold",children:[r.currentStreak>=7?"✓":r.currentStreak,"/7"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Weekly Streak"})]}),e.jsxs("div",{className:"border rounded p-2",children:[e.jsx("div",{className:"text-2xl font-bold",children:r.points}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Streak Points"})]})]})]}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(L,{className:"h-12 w-12 mx-auto mb-2 text-gray-400"}),e.jsx("p",{children:"No streak data available."}),e.jsx("p",{className:"text-sm",children:"Start checking in daily to build your streak!"})]})})]})}function ps(){const{user:s}=M(),{data:a,isLoading:r}=F({queryKey:["/api/user/profile-analytics"],enabled:!!(s!=null&&s.isPremium)});return s!=null&&s.isPremium?r?e.jsxs(k,{className:"col-span-3",children:[e.jsxs(v,{children:[e.jsx(b,{children:"Profile Analytics"}),e.jsx(w,{children:"Loading your analytics data..."})]}),e.jsx(N,{className:"h-[300px] flex items-center justify-center",children:e.jsx(A,{className:"h-8 w-8 animate-spin text-primary"})})]}):e.jsxs($,{defaultValue:"overview",className:"col-span-3",children:[e.jsx(v,{className:"pb-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(b,{children:"Profile Analytics"}),e.jsx(w,{children:"View statistics about your content and followers"})]}),e.jsxs(Q,{children:[e.jsx(j,{value:"overview",children:"Overview"}),e.jsx(j,{value:"videos",children:"Videos"}),e.jsx(j,{value:"engagement",children:"Engagement"})]})]})}),e.jsxs(N,{className:"pt-6",children:[e.jsxs(y,{value:"overview",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(C,{icon:e.jsx(fe,{className:"h-5 w-5 text-blue-500"}),title:"Followers",value:(a==null?void 0:a.followerCount)||0,footer:"Total followers"}),e.jsx(C,{icon:e.jsx(B,{className:"h-5 w-5 text-purple-500"}),title:"Views",value:(a==null?void 0:a.totalViews)||0,footer:"Total video views"}),e.jsx(C,{icon:e.jsx(ve,{className:"h-5 w-5 text-green-500"}),title:"Likes",value:(a==null?void 0:a.totalLikes)||0,footer:"Total likes received"}),e.jsx(C,{icon:e.jsx(ge,{className:"h-5 w-5 text-orange-500"}),title:"Shares",value:(a==null?void 0:a.totalShares)||0,footer:"Total shares"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Engagement Rate"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{value:De(a)*100,max:100,className:"h-2"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[(De(a)*100).toFixed(1),"%"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Engagement rate is calculated as (likes + comments + shares) / views"})]})]}),e.jsxs(y,{value:"videos",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(C,{icon:e.jsx(Le,{className:"h-5 w-5 text-indigo-500"}),title:"Videos",value:(a==null?void 0:a.totalVideos)||0,footer:"Total videos posted"}),e.jsx(C,{icon:e.jsx(B,{className:"h-5 w-5 text-purple-500"}),title:"Avg. Views",value:js(a)||0,footer:"Average views per video"}),e.jsx(C,{icon:e.jsx(ve,{className:"h-5 w-5 text-green-500"}),title:"Avg. Likes",value:fs(a)||0,footer:"Average likes per video"}),e.jsx(C,{icon:e.jsx(ze,{className:"h-5 w-5 text-rose-500"}),title:"Downloads",value:(a==null?void 0:a.totalDownloads)||0,footer:"Total downloads"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Most Popular Categories"}),a!=null&&a.categoryStats&&Object.entries(a.categoryStats).length>0?e.jsx("div",{className:"space-y-3",children:Object.entries(a.categoryStats).sort((o,u)=>u[1]-o[1]).slice(0,3).map(([o,u])=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm capitalize",children:gs(o)}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[u," videos"]})]}),e.jsx(z,{value:u,max:a.totalVideos,className:"h-1.5"})]},o))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No category data available"})]})]}),e.jsxs(y,{value:"engagement",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(C,{icon:e.jsx(Oe,{className:"h-5 w-5 text-amber-500"}),title:"Comments",value:(a==null?void 0:a.totalComments)||0,footer:"Total comments"}),e.jsx(C,{icon:e.jsx(ge,{className:"h-5 w-5 text-orange-500"}),title:"Shares",value:(a==null?void 0:a.totalShares)||0,footer:"Total shares"}),e.jsx(C,{icon:e.jsx(ns,{className:"h-5 w-5 text-blue-500"}),title:"Saves",value:(a==null?void 0:a.totalSaves)||0,footer:"Total saves"}),e.jsx(C,{icon:e.jsx(fe,{className:"h-5 w-5 text-indigo-500"}),title:"Video Followers",value:(a==null?void 0:a.totalVideoFollows)||0,footer:"Total video followers"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Interaction Breakdown"}),e.jsxs("div",{className:"h-[180px] flex items-end gap-2",children:[K("Likes",a==null?void 0:a.totalLikes,"bg-green-500",a),K("Comments",a==null?void 0:a.totalComments,"bg-amber-500",a),K("Shares",a==null?void 0:a.totalShares,"bg-orange-500",a),K("Saves",a==null?void 0:a.totalSaves,"bg-blue-500",a),K("Follows",a==null?void 0:a.totalVideoFollows,"bg-indigo-500",a),K("Downloads",a==null?void 0:a.totalDownloads,"bg-rose-500",a)]}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"Likes"}),e.jsx("span",{children:"Comments"}),e.jsx("span",{children:"Shares"}),e.jsx("span",{children:"Saves"}),e.jsx("span",{children:"Follows"}),e.jsx("span",{children:"Downloads"})]})]})]})]})]}):e.jsxs(k,{className:"col-span-3",children:[e.jsxs(v,{children:[e.jsx(b,{children:"Premium Analytics"}),e.jsx(w,{children:"Upgrade to premium to access detailed analytics about your profile and content."})]}),e.jsx(N,{className:"h-[300px] flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-500 text-transparent bg-clip-text text-4xl font-bold mb-4",children:"Premium Feature"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"View detailed statistics about your content and audience"})]})})]})}function C({icon:s,title:a,value:r,footer:o}){return e.jsx(k,{children:e.jsxs(N,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s,e.jsx("span",{className:"text-sm font-medium",children:a})]}),e.jsx("div",{className:"text-2xl font-bold mb-1",children:Me(r)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:o})]})})}function De(s){if(!s||!s.totalViews||s.totalViews===0)return 0;const a=(s.totalLikes||0)+(s.totalComments||0)+(s.totalShares||0);return Math.min(a/s.totalViews,1)}function js(s){return!s||!s.totalVideos||s.totalVideos===0?0:Math.round(s.totalViews/s.totalVideos)}function fs(s){return!s||!s.totalVideos||s.totalVideos===0?0:Math.round(s.totalLikes/s.totalVideos)}function Me(s){return s==null?0:s>=1e6?(s/1e6).toFixed(1)+"M":s>=1e3?(s/1e3).toFixed(1)+"K":s.toString()}function gs(s){return s?s.replace(/_/g," "):""}function K(s,a,r,o){if(!o)return null;const u=Math.max(o.totalLikes||0,o.totalComments||0,o.totalShares||0,o.totalSaves||0,o.totalVideoFollows||0,o.totalDownloads||0),m=u>0?a/u*100:0,x=Math.max(m,5);return e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-end",children:[e.jsx("div",{className:"relative w-full flex justify-center mb-1",children:e.jsx("span",{className:"absolute -top-6 text-xs font-medium",children:Me(a)})}),e.jsx("div",{className:`w-full ${r} rounded-t`,style:{height:`${x}%`}})]})}function oe({status:s,size:a="md",className:r,withTooltip:o=!0,withLabel:u=!0}){const m={sm:"h-5 text-xs",md:"h-6 text-sm",lg:"h-7 text-base"},x={sm:12,md:14,lg:16},c=e.jsxs(E,{variant:s==="verified"?"default":s==="pending"?"outline":"secondary",className:Ge("gap-1 px-2 font-medium",m[a],s==="verified"?"bg-green-600 hover:bg-green-700":"",s==="pending"?"border-yellow-400 text-yellow-600":"",s==="not_verified"?"bg-transparent text-gray-500":"",r),children:[s==="verified"&&e.jsx("img",{src:"/assets/verification/verification-badge.jpg",alt:"Verified Badge",className:"inline h-5 w-5 rounded-full object-cover",style:{height:x[a],width:x[a]}}),s==="pending"&&e.jsx(G,{className:"inline",size:x[a]}),s==="not_verified"&&e.jsx($e,{className:"inline",size:x[a]}),u&&e.jsxs("span",{children:[s==="verified"&&"Verified",s==="pending"&&"Pending",s==="not_verified"&&"Not Verified"]})]});return o?e.jsx(Qe,{children:e.jsxs(He,{children:[e.jsx(_e,{asChild:!0,children:c}),e.jsxs(We,{side:"top",className:"max-w-xs",children:[s==="verified"&&e.jsx("p",{className:"text-sm",children:"This user has been verified through our identity verification process."}),s==="pending"&&e.jsx("p",{className:"text-sm",children:"Verification is in progress. This typically takes 1-3 business days."}),s==="not_verified"&&e.jsx("p",{className:"text-sm",children:"This user has not been verified yet. Premium users can verify their identity for additional features."})]})]})}):c}function ys(){const{data:s,isLoading:a}=F({queryKey:["/api/user/verification/status"],retry:!1,staleTime:3e4}),{data:r}=F({queryKey:["/api/user/premium/status"]});return r==null||r.isPremium,a?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(A,{className:"h-4 w-4 animate-spin text-primary mr-2"}),e.jsx("span",{className:"text-xs",children:"Loading..."})]}):s&&s.status==="verified"?e.jsxs("div",{className:"flex items-center",children:[e.jsx(oe,{status:"verified",size:"sm"}),s.verifiedAt&&e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["since ",new Date(s.verifiedAt).toLocaleDateString()]})]}):s&&s.status==="pending"?e.jsxs("div",{className:"flex items-center",children:[e.jsx(oe,{status:"pending",size:"sm"}),e.jsx("span",{className:"ml-2 text-xs text-amber-600",children:"Verification pending"})]}):e.jsxs("div",{className:"flex items-center",children:[e.jsx(oe,{status:"not_verified",size:"sm"}),e.jsx(Ee,{to:"/verification",className:"ml-2 text-xs text-primary hover:underline",children:"Get Verified"})]})}function Ls(){const{user:s,isLoading:a}=M(),{data:r,isLoading:o}=F({queryKey:["/api/tokens"],queryFn:ye({on401:"returnNull"}),enabled:!!s}),{data:u,isLoading:m}=F({queryKey:["/api/rewards/history"],queryFn:ye({on401:"returnNull"}),enabled:!!s}),x=a||o||m;if(!x&&!s)return e.jsx(Je,{to:"/auth"});const c=i=>new Date(i).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"container py-8 max-w-6xl",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Your Profile"}),e.jsx("p",{className:"text-gray-500 mb-8",children:"Manage your profile, view rewards, and track achievements"}),x?e.jsx("div",{className:"flex items-center justify-center min-h-[300px]",children:e.jsx(A,{className:"w-8 h-8 animate-spin text-primary"})}):e.jsxs($,{defaultValue:"profile",className:"space-y-8",children:[e.jsxs(Q,{className:"grid grid-cols-7 w-full max-w-5xl",children:[e.jsxs(j,{value:"profile",className:"flex items-center gap-2",children:[e.jsx(Pe,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Profile"})]}),e.jsxs(j,{value:"security",className:"flex items-center gap-2",children:[e.jsx(Ze,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Security"})]}),e.jsxs(j,{value:"data",className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Data"})]}),e.jsxs(j,{value:"badges",className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Badges"})]}),e.jsxs(j,{value:"challenges",className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Challenges"})]}),e.jsxs(j,{value:"streaks",className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Streaks"})]}),e.jsxs(j,{value:"analytics",className:"flex items-center gap-2",children:[e.jsx(Le,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Analytics"})]})]}),e.jsxs(y,{value:"profile",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(cs,{}),e.jsxs(k,{children:[e.jsxs(v,{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"h-5 w-5"}),"Account Information"]}),e.jsx(w,{children:"Your personal account details and token balance"})]}),e.jsxs(N,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Username"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-lg font-medium",children:s==null?void 0:s.username}),e.jsx(ys,{})]})]}),e.jsx(I,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Token Balance"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-gradient-to-r from-amber-400 to-orange-500 text-white w-10 h-10 rounded-full flex items-center justify-center font-bold text-lg",children:(r==null?void 0:r.tokens)||0}),e.jsx("span",{className:"font-medium",children:"Emotion Tokens"})]})]}),e.jsx(I,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Notifications"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(h,{asChild:!0,variant:"outline",className:"w-full justify-start",children:e.jsxs(Ee,{to:"/profile/notifications",className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-primary/10 text-primary w-8 h-8 rounded-full flex items-center justify-center",children:e.jsx(es,{className:"h-4 w-4"})}),e.jsx("span",{children:"View All Notifications"})]})})})]}),e.jsx(I,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Account Created"}),e.jsx("p",{className:"text-gray-700",children:s!=null&&s.createdAt?new Date(s.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"})]})]})]})]}),e.jsxs(k,{children:[e.jsxs(v,{children:[e.jsx(b,{children:"Recent Reward Activity"}),e.jsx(w,{children:"History of your most recent token earnings"})]}),e.jsx(N,{children:u&&u.length>0?e.jsx("div",{className:"space-y-4",children:u.slice(0,5).map((i,l)=>e.jsxs("div",{className:"flex justify-between items-center border-b pb-3 last:border-0 last:pb-0",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:i.description}),e.jsx("p",{className:"text-sm text-gray-500",children:c(i.createdAt)})]}),e.jsxs(E,{variant:"outline",className:"bg-green-50",children:["+",i.tokensEarned," tokens"]})]},l))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{children:"No reward activity to display yet."}),e.jsx("p",{className:"text-sm mt-1",children:"Complete challenges and use the app to earn tokens!"})]})})]})]}),e.jsx(y,{value:"security",children:e.jsx(os,{})}),e.jsx(y,{value:"data",children:e.jsx(ds,{})}),e.jsx(y,{value:"badges",children:e.jsx(ms,{})}),e.jsx(y,{value:"challenges",children:e.jsx(us,{})}),e.jsx(y,{value:"streaks",children:e.jsx(hs,{})}),e.jsx(y,{value:"analytics",children:e.jsx(ps,{})})]})]})}export{Ls as default};
