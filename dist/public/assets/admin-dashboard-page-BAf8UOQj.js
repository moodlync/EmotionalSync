import{c as p,n as g,j as e,k as b,C as t,d as a,e as d,Q as f,g as l,bw as N,f as c}from"./index-vCbmY8Kg.js";import{A as x,T as y}from"./admin-layout-BixmGBh8.js";import"./chart-column-B-07Qafu.js";import"./rotate-ccw-CN_7avtr.js";import"./quote-PLc3nyLZ.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v=p("BadgeDollarSign",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 18V6",key:"zqpxq5"}]]);function R(){var m,o,h;const{data:s,isLoading:j,error:n}=g({queryKey:["/api/admin/dashboard"]}),i=s==null?void 0:s.adminUser;return j?e.jsx(x,{children:e.jsx("div",{className:"flex justify-center items-center h-[80vh]",children:e.jsx(b,{className:"h-8 w-8 animate-spin text-primary"})})}):n?e.jsx(x,{children:e.jsxs("div",{className:"rounded-lg border border-destructive p-4 text-destructive",children:[e.jsx("p",{children:"Error loading dashboard data"}),e.jsx("p",{className:"text-sm",children:n instanceof Error?n.message:"Unknown error"})]})}):e.jsx(x,{children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Dashboard"}),e.jsxs("p",{className:"text-muted-foreground",children:["Welcome to the admin dashboard, ",i==null?void 0:i.username]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(t,{children:[e.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Total Users"}),e.jsx(f,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(s==null?void 0:s.totalUsers)||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(s==null?void 0:s.activeUsers)||0," active in the last 30 days"]})]})]}),e.jsxs(t,{children:[e.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Premium Users"}),e.jsx(v,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(s==null?void 0:s.premiumUsers)||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[s!=null&&s.premiumUsers&&(s!=null&&s.totalUsers)?Math.round(s.premiumUsers/s.totalUsers*100):0,"% of total users"]})]})]}),e.jsxs(t,{children:[e.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Open Tickets"}),e.jsx(y,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(s==null?void 0:s.openTickets)||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(s==null?void 0:s.pendingRefunds)||0," pending refunds"]})]})]}),e.jsxs(t,{children:[e.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Total Revenue"}),e.jsx(N,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(l,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",((m=s==null?void 0:s.totalRevenue)==null?void 0:m.toFixed(2))||"0.00"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"From premium subscriptions"})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(t,{children:[e.jsxs(a,{children:[e.jsx(d,{children:"Recent Tickets"}),e.jsx(c,{children:"Last 5 support tickets submitted"})]}),e.jsx(l,{children:(o=s==null?void 0:s.recentTickets)!=null&&o.length?e.jsx("div",{className:"space-y-4",children:s.recentTickets.map(r=>e.jsxs("div",{className:"border-b pb-4 last:border-0 last:pb-0",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:r.subject}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-1",children:r.description})]}),e.jsx("div",{className:"text-right",children:e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${r.status==="open"?"bg-blue-100 text-blue-800":r.status==="in_progress"?"bg-amber-100 text-amber-800":r.status==="resolved"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:r.status})})]}),e.jsxs("div",{className:"flex justify-between mt-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["ID: #",r.id]}),e.jsx("span",{children:new Date(r.createdAt).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]},r.id))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No recent tickets"})})]}),e.jsxs(t,{children:[e.jsxs(a,{children:[e.jsx(d,{children:"Recent Refunds"}),e.jsx(c,{children:"Last 5 refund requests"})]}),e.jsx(l,{children:(h=s==null?void 0:s.recentRefunds)!=null&&h.length?e.jsx("div",{className:"space-y-4",children:s.recentRefunds.map(r=>e.jsxs("div",{className:"border-b pb-4 last:border-0 last:pb-0",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:["$",parseFloat(r.amount).toFixed(2)," ",r.currency]}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-1",children:r.reason})]}),e.jsx("div",{className:"text-right",children:e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${r.status==="pending"?"bg-amber-100 text-amber-800":r.status==="approved"?"bg-green-100 text-green-800":r.status==="rejected"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:r.status})})]}),e.jsxs("div",{className:"flex justify-between mt-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["User ID: #",r.userId]}),e.jsx("span",{children:new Date(r.createdAt).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]},r.id))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No recent refunds"})})]})]}),e.jsxs(t,{children:[e.jsxs(a,{children:[e.jsx(d,{children:"User Emotions Distribution"}),e.jsx(c,{children:"Current emotional state of users on the platform"})]}),e.jsx(l,{children:s!=null&&s.usersByEmotion?e.jsx("div",{className:"grid grid-cols-6 gap-4",children:Object.entries(s.usersByEmotion).map(([r,u])=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`w-full h-32 rounded-md flex items-end mb-2 ${r==="happy"?"bg-yellow-100":r==="sad"?"bg-blue-100":r==="angry"?"bg-red-100":r==="anxious"?"bg-purple-100":r==="excited"?"bg-green-100":"bg-gray-100"}`,children:e.jsx("div",{className:`w-full ${r==="happy"?"bg-yellow-400":r==="sad"?"bg-blue-400":r==="angry"?"bg-red-400":r==="anxious"?"bg-purple-400":r==="excited"?"bg-green-400":"bg-gray-400"} rounded-b-md transition-all duration-300`,style:{height:`${Math.max(5,Math.min(100,u/(Math.max(...Object.values(s.usersByEmotion))||1)*100))}%`}})}),e.jsx("span",{className:"capitalize font-medium text-sm",children:r}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[u," users"]})]},r))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No emotion data available"})})]})]})})}export{R as default};
