import{br as Re,be as c,j as a,al as Ae,r as R,u as Te,bA as _e,a as ie,aT as ce,C as K,d as H,e as V,f as X,g as Q,a0 as Le,B as W}from"./index-BtgMuIOb.js";var ue={exports:{}},Ie="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Ue=Ie,We=Ue;function le(){}function pe(){}pe.resetWarningCache=le;var Fe=function(){function r(n,s,o,u,h,i){if(i!==We){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}r.isRequired=r;function e(){return r}var t={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:e,element:r,elementType:r,instanceOf:e,node:r,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:pe,resetWarningCache:le};return t.PropTypes=t,t};ue.exports=Fe();var $e=ue.exports;const p=Re($e);function Z(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),t.push.apply(t,n)}return t}function ee(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Z(Object(t),!0).forEach(function(n){de(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Z(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function U(r){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?U=function(e){return typeof e}:U=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},U(r)}function de(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Be(r,e){if(r==null)return{};var t={},n=Object.keys(r),s,o;for(o=0;o<n.length;o++)s=n[o],!(e.indexOf(s)>=0)&&(t[s]=r[s]);return t}function De(r,e){if(r==null)return{};var t=Be(r,e),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(s=0;s<o.length;s++)n=o[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(r,n)&&(t[n]=r[n])}return t}function me(r,e){return Me(r)||Ye(r,e)||qe(r,e)||Je()}function Me(r){if(Array.isArray(r))return r}function Ye(r,e){var t=r&&(typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"]);if(t!=null){var n=[],s=!0,o=!1,u,h;try{for(t=t.call(r);!(s=(u=t.next()).done)&&(n.push(u.value),!(e&&n.length===e));s=!0);}catch(i){o=!0,h=i}finally{try{!s&&t.return!=null&&t.return()}finally{if(o)throw h}}return n}}function qe(r,e){if(r){if(typeof r=="string")return te(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return te(r,e)}}function te(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function Je(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var x=function(e,t,n){var s=!!n,o=c.useRef(n);c.useEffect(function(){o.current=n},[n]),c.useEffect(function(){if(!s||!e)return function(){};var u=function(){o.current&&o.current.apply(o,arguments)};return e.on(t,u),function(){e.off(t,u)}},[s,t,e,o])},D=function(e){var t=c.useRef(e);return c.useEffect(function(){t.current=e},[e]),t.current},k=function(e){return e!==null&&U(e)==="object"},Ge=function(e){return k(e)&&typeof e.then=="function"},ze=function(e){return k(e)&&typeof e.elements=="function"&&typeof e.createToken=="function"&&typeof e.createPaymentMethod=="function"&&typeof e.confirmCardPayment=="function"},re="[object Object]",Ke=function r(e,t){if(!k(e)||!k(t))return e===t;var n=Array.isArray(e),s=Array.isArray(t);if(n!==s)return!1;var o=Object.prototype.toString.call(e)===re,u=Object.prototype.toString.call(t)===re;if(o!==u)return!1;if(!o&&!n)return e===t;var h=Object.keys(e),i=Object.keys(t);if(h.length!==i.length)return!1;for(var d={},g=0;g<h.length;g+=1)d[h[g]]=!0;for(var C=0;C<i.length;C+=1)d[i[C]]=!0;var l=Object.keys(d);if(l.length!==h.length)return!1;var b=e,S=t,E=function(A){return r(b[A],S[A])};return l.every(E)},fe=function(e,t,n){return k(e)?Object.keys(e).reduce(function(s,o){var u=!k(t)||!Ke(e[o],t[o]);return n.includes(o)?(u&&console.warn("Unsupported prop change: options.".concat(o," is not a mutable property.")),s):u?ee(ee({},s||{}),{},de({},o,e[o])):s},null):null},he="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",ne=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:he;if(e===null||ze(e))return e;throw new Error(t)},He=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:he;if(Ge(e))return{tag:"async",stripePromise:Promise.resolve(e).then(function(s){return ne(s,t)})};var n=ne(e,t);return n===null?{tag:"empty"}:{tag:"sync",stripe:n}},Ve=function(e){!e||!e._registerWrapper||!e.registerAppInfo||(e._registerWrapper({name:"react-stripe-js",version:"3.7.0"}),e.registerAppInfo({name:"react-stripe-js",version:"3.7.0",url:"https://stripe.com/docs/stripe-js/react"}))},F=c.createContext(null);F.displayName="ElementsContext";var ve=function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e},ye=function(e){var t=e.stripe,n=e.options,s=e.children,o=c.useMemo(function(){return He(t)},[t]),u=c.useState(function(){return{stripe:o.tag==="sync"?o.stripe:null,elements:o.tag==="sync"?o.stripe.elements(n):null}}),h=me(u,2),i=h[0],d=h[1];c.useEffect(function(){var l=!0,b=function(E){d(function(w){return w.stripe?w:{stripe:E,elements:E.elements(n)}})};return o.tag==="async"&&!i.stripe?o.stripePromise.then(function(S){S&&l&&b(S)}):o.tag==="sync"&&!i.stripe&&b(o.stripe),function(){l=!1}},[o,i,n]);var g=D(t);c.useEffect(function(){g!==null&&g!==t&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[g,t]);var C=D(n);return c.useEffect(function(){if(i.elements){var l=fe(n,C,["clientSecret","fonts"]);l&&i.elements.update(l)}},[n,C,i.elements]),c.useEffect(function(){Ve(i.stripe)},[i.stripe]),c.createElement(F.Provider,{value:i},s)};ye.propTypes={stripe:p.any,options:p.object};var Xe=function(e){var t=c.useContext(F);return ve(t,e)},Qe=function(){var e=Xe("calls useElements()"),t=e.elements;return t};p.func.isRequired;var ge=c.createContext(null);ge.displayName="CheckoutSdkContext";var Ze=function(e,t){if(!e)throw new Error("Could not find CheckoutProvider context; You need to wrap the part of your app that ".concat(t," in an <CheckoutProvider> provider."));return e},et=c.createContext(null);et.displayName="CheckoutContext";p.any,p.shape({fetchClientSecret:p.func.isRequired,elementsOptions:p.object}).isRequired;var M=function(e){var t=c.useContext(ge),n=c.useContext(F);if(t&&n)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CheckoutProvider> and <Elements> providers."));return t?Ze(t,e):ve(n,e)},tt=["mode"],rt=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},m=function(e,t){var n="".concat(rt(e),"Element"),s=function(i){var d=i.id,g=i.className,C=i.options,l=C===void 0?{}:C,b=i.onBlur,S=i.onFocus,E=i.onReady,w=i.onChange,A=i.onEscape,be=i.onClick,Se=i.onLoadError,Ce=i.onLoaderStart,Ee=i.onNetworksChange,je=i.onConfirm,Pe=i.onCancel,we=i.onShippingAddressChange,ke=i.onShippingRateChange,T=M("mounts <".concat(n,">")),_="elements"in T?T.elements:null,P="checkoutSdk"in T?T.checkoutSdk:null,Ne=c.useState(null),q=me(Ne,2),y=q[0],Oe=q[1],j=c.useRef(null),$=c.useRef(null);x(y,"blur",b),x(y,"focus",S),x(y,"escape",A),x(y,"click",be),x(y,"loaderror",Se),x(y,"loaderstart",Ce),x(y,"networkschange",Ee),x(y,"confirm",je),x(y,"cancel",Pe),x(y,"shippingaddresschange",we),x(y,"shippingratechange",ke),x(y,"change",w);var B;E&&(e==="expressCheckout"?B=E:B=function(){E(y)}),x(y,"ready",B),c.useLayoutEffect(function(){if(j.current===null&&$.current!==null&&(_||P)){var v=null;if(P)switch(e){case"payment":v=P.createPaymentElement(l);break;case"address":if("mode"in l){var G=l.mode,z=De(l,tt);if(G==="shipping")v=P.createShippingAddressElement(z);else if(G==="billing")v=P.createBillingAddressElement(z);else throw new Error("Invalid options.mode. mode must be 'billing' or 'shipping'.")}else throw new Error("You must supply options.mode. mode must be 'billing' or 'shipping'.");break;case"expressCheckout":v=P.createExpressCheckoutElement(l);break;case"currencySelector":v=P.createCurrencySelectorElement();break;default:throw new Error("Invalid Element type ".concat(n,". You must use either the <PaymentElement />, <AddressElement options={{mode: 'shipping'}} />, <AddressElement options={{mode: 'billing'}} />, or <ExpressCheckoutElement />."))}else _&&(v=_.create(e,l));j.current=v,Oe(v),v&&v.mount($.current)}},[_,P,l]);var J=D(l);return c.useEffect(function(){if(j.current){var v=fe(l,J,["paymentRequest"]);v&&"update"in j.current&&j.current.update(v)}},[l,J]),c.useLayoutEffect(function(){return function(){if(j.current&&typeof j.current.destroy=="function")try{j.current.destroy(),j.current=null}catch{}}},[]),c.createElement("div",{id:d,className:g,ref:$})},o=function(i){M("mounts <".concat(n,">"));var d=i.id,g=i.className;return c.createElement("div",{id:d,className:g})},u=t?o:s;return u.propTypes={id:p.string,className:p.string,onChange:p.func,onBlur:p.func,onFocus:p.func,onReady:p.func,onEscape:p.func,onClick:p.func,onLoadError:p.func,onLoaderStart:p.func,onNetworksChange:p.func,onConfirm:p.func,onCancel:p.func,onShippingAddressChange:p.func,onShippingRateChange:p.func,options:p.object},u.displayName=n,u.__elementType=e,u},f=typeof window>"u",nt=c.createContext(null);nt.displayName="EmbeddedCheckoutProviderContext";var st=function(){var e=M("calls useStripe()"),t=e.stripe;return t};m("auBankAccount",f);m("card",f);m("cardNumber",f);m("cardExpiry",f);m("cardCvc",f);m("fpxBank",f);m("iban",f);m("idealBank",f);m("p24Bank",f);m("epsBank",f);var at=m("payment",f);m("expressCheckout",f);m("currencySelector",f);m("paymentRequestButton",f);m("linkAuthentication",f);m("address",f);m("shippingAddress",f);m("paymentMethodMessaging",f);m("affirmMessage",f);m("afterpayClearpayMessage",f);var ot="basil",xe="https://js.stripe.com",it="".concat(xe,"/").concat(ot,"/stripe.js"),ct=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,ut=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/,se="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",lt=function(e){return ct.test(e)||ut.test(e)},pt=function(){for(var e=document.querySelectorAll('script[src^="'.concat(xe,'"]')),t=0;t<e.length;t++){var n=e[t];if(lt(n.src))return n}return null},ae=function(e){var t="",n=document.createElement("script");n.src="".concat(it).concat(t);var s=document.head||document.body;if(!s)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return s.appendChild(n),n},N=null,L=null,I=null,dt=function(e){return function(t){e(new Error("Failed to load Stripe.js",{cause:t}))}},mt=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}},ft=function(e){return N!==null?N:(N=new Promise(function(t,n){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe&&e&&console.warn(se),window.Stripe){t(window.Stripe);return}try{var s=pt();if(s&&e)console.warn(se);else if(!s)s=ae(e);else if(s&&I!==null&&L!==null){var o;s.removeEventListener("load",I),s.removeEventListener("error",L),(o=s.parentNode)===null||o===void 0||o.removeChild(s),s=ae(e)}I=mt(t,n),L=dt(n),s.addEventListener("load",I),s.addEventListener("error",L)}catch(u){n(u);return}}),N.catch(function(t){return N=null,Promise.reject(t)}))},O,ht=function(){return O||(O=ft(null).catch(function(e){return O=null,Promise.reject(e)}),O)};Promise.resolve().then(function(){return ht()}).catch(function(r){console.warn(r)});function Y({className:r,size:e="md",...t}){const n={sm:"h-4 w-4 border-2",md:"h-8 w-8 border-3",lg:"h-12 w-12 border-4"};return a.jsx("div",{className:Ae("animate-spin rounded-full border-solid border-primary border-t-transparent",n[e],r),...t})}const oe=null,vt=()=>{const r=st(),e=Qe(),{toast:t}=ie(),[n,s]=R.useState(!1),[o,u]=ce(),h=async i=>{if(i.preventDefault(),!r||!e){t({title:"Payment Failed",description:"Stripe hasn't loaded yet. Please try again in a moment.",variant:"destructive"});return}s(!0);try{const{error:d}=await r.confirmPayment({elements:e,confirmParams:{return_url:window.location.origin+"/checkout-success"}});d&&t({title:"Payment Failed",description:d.message||"An unknown error occurred",variant:"destructive"})}catch(d){t({title:"Payment Error",description:d.message||"An unexpected error occurred",variant:"destructive"})}finally{s(!1)}};return a.jsxs("form",{onSubmit:h,className:"space-y-6",children:[a.jsx(at,{}),a.jsx(W,{type:"submit",disabled:!r||n,className:"w-full",children:n?a.jsxs(a.Fragment,{children:[a.jsx(Y,{className:"mr-2 h-4 w-4"}),"Processing..."]}):"Pay Now"}),a.jsx(W,{type:"button",variant:"outline",className:"w-full",onClick:()=>u("/premium"),children:"Cancel and Return"})]})};function gt(){const[r,e]=R.useState(""),[t,n]=R.useState(null),[s,o]=R.useState(!0),{user:u}=Te(),[h,i]=_e("/checkout/:planId"),d=(i==null?void 0:i.planId)||"monthly",{toast:g}=ie(),[C,l]=ce();if(R.useEffect(()=>{if(!u){l("/auth");return}o(!1),n("Stripe is not configured. Please try again later.")},[u,d,g,l]),!u)return null;if(s)return a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Y,{className:"h-8 w-8 mx-auto"}),a.jsx("p",{className:"mt-4 text-muted-foreground",children:"Setting up your payment..."})]})});if(t||!oe){const E=()=>{o(!0),setTimeout(()=>{const w=`/checkout-success?payment_intent=sim_${Date.now()}&redirect_status=succeeded`;l(w)},1500)};return a.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:a.jsxs(K,{className:"w-full max-w-md",children:[a.jsxs(H,{children:[a.jsx(V,{children:"Complete Your Purchase"}),a.jsxs(X,{children:["You're subscribing to the ",b().name," plan"]}),a.jsxs("div",{className:"mt-2 flex justify-between items-baseline",children:[a.jsx("span",{className:"text-3xl font-bold",children:b().amount}),a.jsx("span",{className:"text-muted-foreground",children:b().interval})]}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:b().description})]}),a.jsxs(Q,{className:"space-y-4",children:[a.jsx("p",{className:"text-sm text-amber-600 bg-amber-50 p-3 rounded-md border border-amber-100",children:"Note: Stripe integration is currently disabled. This is a simulated checkout for demonstration purposes."}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"text-sm font-medium",children:"Payment Information"}),a.jsx("div",{className:"grid gap-2",children:a.jsx("div",{className:"rounded-md border px-3 py-2 text-sm bg-muted/50",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{children:"Mock Credit Card"}),a.jsx("span",{children:"**** **** **** 4242"})]})})})]})]}),a.jsxs(Le,{className:"flex flex-col space-y-2",children:[a.jsx(W,{className:"w-full",onClick:E,disabled:s,children:s?a.jsxs(a.Fragment,{children:[a.jsx(Y,{className:"mr-2 h-4 w-4"}),"Processing..."]}):"Complete Purchase"}),a.jsx(W,{variant:"outline",className:"w-full",onClick:()=>l("/premium"),disabled:s,children:"Cancel"})]})]})})}const b=()=>{switch(d){case"monthly":return{name:"Monthly Premium",amount:"$12.99",interval:"per month",description:"All premium features with monthly billing"};case"yearly":return{name:"Yearly Premium",amount:"$99.99",interval:"per year",description:"Save over 35% with yearly billing"};case"family":return{name:"Family Plan",amount:"$19.99",interval:"per month",description:"Premium access for up to 5 family members"};case"family-lifetime":return{name:"Family Lifetime",amount:"$299.99",interval:"one-time",description:"Lifetime access for the whole family"};default:return{name:"Premium Subscription",amount:"$12.99",interval:"per month",description:"All premium features"}}},S=b();return a.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:a.jsxs(K,{className:"w-full max-w-md",children:[a.jsxs(H,{children:[a.jsx(V,{children:"Complete Your Purchase"}),a.jsxs(X,{children:["You're subscribing to the ",S.name," plan"]}),a.jsxs("div",{className:"mt-2 flex justify-between items-baseline",children:[a.jsx("span",{className:"text-3xl font-bold",children:S.amount}),a.jsx("span",{className:"text-muted-foreground",children:S.interval})]}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:S.description})]}),a.jsx(Q,{children:r&&a.jsx(ye,{stripe:oe,options:{clientSecret:r},children:a.jsx(vt,{})})})]})})}export{gt as default};
