import{r as l,ab as re,ac as _,ad as me,ae as Es,af as As,ag as Is,ah as Fs,j as e,Y as le,ai as ss,a as Ve,n as je,t as De,aj as ts,b as ge,C as F,g as P,ak as as,al as z,am as B,an as q,ao as Ps,ap as Ms,B as E,A as Se,h as Te,i as Re,aq as $s,ar as Y,as as K,I as ae,at as ve,au as ns,av as Ds,aw as rs,ax as ls,ay as is,az as os,aA as cs,L as de,T as Bs,aB as ds,aC as O,aD as ms,q as ne,d as L,e as V,aE as qs,R as Ls,K as Vs,aF as us,s as J,aG as Os,k as pe,u as hs,y as Oe,z as Ue,D as G,F as W,f as ce,aH as fe,P as Us,aI as Ks,aJ as Hs,aK as zs,w as ee,a9 as _e,S as Be,O as Ys,H as Gs,aL as Ws,a5 as Qs,Z as _s}from"./index-DQa6QqId.js";import{A as Ee,a as Ae,b as Ie}from"./alert-9JtLaWZt.js";import{C as Ke}from"./circle-check-big-CcqqY4yJ.js";import{A as Js}from"./animated-share-button-Bg20Sk5W.js";import{C as Xs}from"./copy-C_ZmuSr4.js";import{T as Zs,F as et,L as st}from"./twitter-JWSH1fL_.js";import{v as Je}from"./v4-CmTdKEVZ.js";import{R as tt,a as Fe}from"./radio-group-_UKspEgo.js";import{R as xs}from"./repeat-Cvx9Ng5r.js";import{C as at}from"./chart-column-vw4EHaKu.js";import{T as nt}from"./thumbs-up-CbOhFjjB.js";var Xe=1,rt=.9,lt=.8,it=.17,Pe=.1,Me=.999,ot=.9999,ct=.99,dt=/[\\\/_+.#"@\[\(\{&]/,mt=/[\\\/_+.#"@\[\(\{&]/g,ut=/[\s-]/,ps=/[\s-]/g;function qe(s,r,a,o,c,m,u){if(m===r.length)return c===s.length?Xe:ct;var t=`${c},${m}`;if(u[t]!==void 0)return u[t];for(var b=o.charAt(m),d=a.indexOf(b,c),j=0,g,C,f,y;d>=0;)g=qe(s,r,a,o,d+1,m+1,u),g>j&&(d===c?g*=Xe:dt.test(s.charAt(d-1))?(g*=lt,f=s.slice(c,d-1).match(mt),f&&c>0&&(g*=Math.pow(Me,f.length))):ut.test(s.charAt(d-1))?(g*=rt,y=s.slice(c,d-1).match(ps),y&&c>0&&(g*=Math.pow(Me,y.length))):(g*=it,c>0&&(g*=Math.pow(Me,d-c))),s.charAt(d)!==r.charAt(m)&&(g*=ot)),(g<Pe&&a.charAt(d-1)===o.charAt(m+1)||o.charAt(m+1)===o.charAt(m)&&a.charAt(d-1)!==o.charAt(m))&&(C=qe(s,r,a,o,d+1,m+2,u),C*Pe>g&&(g=C*Pe)),g>j&&(j=g),d=a.indexOf(b,d+1);return u[t]=j,j}function Ze(s){return s.toLowerCase().replace(ps," ")}function ht(s,r,a){return s=a&&a.length>0?`${s+" "+a.join(" ")}`:s,qe(s,r,Ze(s),Ze(r),0,0,{})}var oe='[cmdk-group=""]',$e='[cmdk-group-items=""]',xt='[cmdk-group-heading=""]',fs='[cmdk-item=""]',es=`${fs}:not([aria-disabled="true"])`,Le="cmdk-item-select",se="data-value",pt=(s,r,a)=>ht(s,r,a),js=l.createContext(void 0),ue=()=>l.useContext(js),gs=l.createContext(void 0),He=()=>l.useContext(gs),vs=l.createContext(void 0),Ns=l.forwardRef((s,r)=>{let a=te(()=>{var n,p;return{search:"",value:(p=(n=s.value)!=null?n:s.defaultValue)!=null?p:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),o=te(()=>new Set),c=te(()=>new Map),m=te(()=>new Map),u=te(()=>new Set),t=bs(s),{label:b,children:d,value:j,onValueChange:g,filter:C,shouldFilter:f,loop:y,disablePointerSelection:R=!1,vimBindings:I=!0,...U}=s,k=re(),D=re(),T=re(),x=l.useRef(null),i=St();X(()=>{if(j!==void 0){let n=j.trim();a.current.value=n,v.emit()}},[j]),X(()=>{i(6,ze)},[]);let v=l.useMemo(()=>({subscribe:n=>(u.current.add(n),()=>u.current.delete(n)),snapshot:()=>a.current,setState:(n,p,N)=>{var h,w,S,$;if(!Object.is(a.current[n],p)){if(a.current[n]=p,n==="search")ke(),be(),i(1,ye);else if(n==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let A=document.getElementById(T);A?A.focus():(h=document.getElementById(k))==null||h.focus()}if(i(7,()=>{var A;a.current.selectedItemId=(A=Z())==null?void 0:A.id,v.emit()}),N||i(5,ze),((w=t.current)==null?void 0:w.value)!==void 0){let A=p??"";($=(S=t.current).onValueChange)==null||$.call(S,A);return}}v.emit()}},emit:()=>{u.current.forEach(n=>n())}}),[]),H=l.useMemo(()=>({value:(n,p,N)=>{var h;p!==((h=m.current.get(n))==null?void 0:h.value)&&(m.current.set(n,{value:p,keywords:N}),a.current.filtered.items.set(n,he(p,N)),i(2,()=>{be(),v.emit()}))},item:(n,p)=>(o.current.add(n),p&&(c.current.has(p)?c.current.get(p).add(n):c.current.set(p,new Set([n]))),i(3,()=>{ke(),be(),a.current.value||ye(),v.emit()}),()=>{m.current.delete(n),o.current.delete(n),a.current.filtered.items.delete(n);let N=Z();i(4,()=>{ke(),(N==null?void 0:N.getAttribute("id"))===n&&ye(),v.emit()})}),group:n=>(c.current.has(n)||c.current.set(n,new Set),()=>{m.current.delete(n),c.current.delete(n)}),filter:()=>t.current.shouldFilter,label:b||s["aria-label"],getDisablePointerSelection:()=>t.current.disablePointerSelection,listId:k,inputId:T,labelId:D,listInnerRef:x}),[]);function he(n,p){var N,h;let w=(h=(N=t.current)==null?void 0:N.filter)!=null?h:pt;return n?w(n,a.current.search,p):0}function be(){if(!a.current.search||t.current.shouldFilter===!1)return;let n=a.current.filtered.items,p=[];a.current.filtered.groups.forEach(h=>{let w=c.current.get(h),S=0;w.forEach($=>{let A=n.get($);S=Math.max(A,S)}),p.push([h,S])});let N=x.current;ie().sort((h,w)=>{var S,$;let A=h.getAttribute("id"),xe=w.getAttribute("id");return((S=n.get(xe))!=null?S:0)-(($=n.get(A))!=null?$:0)}).forEach(h=>{let w=h.closest($e);w?w.appendChild(h.parentElement===w?h:h.closest(`${$e} > *`)):N.appendChild(h.parentElement===N?h:h.closest(`${$e} > *`))}),p.sort((h,w)=>w[1]-h[1]).forEach(h=>{var w;let S=(w=x.current)==null?void 0:w.querySelector(`${oe}[${se}="${encodeURIComponent(h[0])}"]`);S==null||S.parentElement.appendChild(S)})}function ye(){let n=ie().find(N=>N.getAttribute("aria-disabled")!=="true"),p=n==null?void 0:n.getAttribute(se);v.setState("value",p||void 0)}function ke(){var n,p,N,h;if(!a.current.search||t.current.shouldFilter===!1){a.current.filtered.count=o.current.size;return}a.current.filtered.groups=new Set;let w=0;for(let S of o.current){let $=(p=(n=m.current.get(S))==null?void 0:n.value)!=null?p:"",A=(h=(N=m.current.get(S))==null?void 0:N.keywords)!=null?h:[],xe=he($,A);a.current.filtered.items.set(S,xe),xe>0&&w++}for(let[S,$]of c.current)for(let A of $)if(a.current.filtered.items.get(A)>0){a.current.filtered.groups.add(S);break}a.current.filtered.count=w}function ze(){var n,p,N;let h=Z();h&&(((n=h.parentElement)==null?void 0:n.firstChild)===h&&((N=(p=h.closest(oe))==null?void 0:p.querySelector(xt))==null||N.scrollIntoView({block:"nearest"})),h.scrollIntoView({block:"nearest"}))}function Z(){var n;return(n=x.current)==null?void 0:n.querySelector(`${fs}[aria-selected="true"]`)}function ie(){var n;return Array.from(((n=x.current)==null?void 0:n.querySelectorAll(es))||[])}function we(n){let p=ie()[n];p&&v.setState("value",p.getAttribute(se))}function Ce(n){var p;let N=Z(),h=ie(),w=h.findIndex($=>$===N),S=h[w+n];(p=t.current)!=null&&p.loop&&(S=w+n<0?h[h.length-1]:w+n===h.length?h[0]:h[w+n]),S&&v.setState("value",S.getAttribute(se))}function Ye(n){let p=Z(),N=p==null?void 0:p.closest(oe),h;for(;N&&!h;)N=n>0?wt(N,oe):Ct(N,oe),h=N==null?void 0:N.querySelector(es);h?v.setState("value",h.getAttribute(se)):Ce(n)}let Ge=()=>we(ie().length-1),We=n=>{n.preventDefault(),n.metaKey?Ge():n.altKey?Ye(1):Ce(1)},Qe=n=>{n.preventDefault(),n.metaKey?we(0):n.altKey?Ye(-1):Ce(-1)};return l.createElement(_.div,{ref:r,tabIndex:-1,...U,"cmdk-root":"",onKeyDown:n=>{var p;(p=U.onKeyDown)==null||p.call(U,n);let N=n.nativeEvent.isComposing||n.keyCode===229;if(!(n.defaultPrevented||N))switch(n.key){case"n":case"j":{I&&n.ctrlKey&&We(n);break}case"ArrowDown":{We(n);break}case"p":case"k":{I&&n.ctrlKey&&Qe(n);break}case"ArrowUp":{Qe(n);break}case"Home":{n.preventDefault(),we(0);break}case"End":{n.preventDefault(),Ge();break}case"Enter":{n.preventDefault();let h=Z();if(h){let w=new Event(Le);h.dispatchEvent(w)}}}}},l.createElement("label",{"cmdk-label":"",htmlFor:H.inputId,id:H.labelId,style:Rt},b),Ne(s,n=>l.createElement(gs.Provider,{value:v},l.createElement(js.Provider,{value:H},n))))}),ft=l.forwardRef((s,r)=>{var a,o;let c=re(),m=l.useRef(null),u=l.useContext(vs),t=ue(),b=bs(s),d=(o=(a=b.current)==null?void 0:a.forceMount)!=null?o:u==null?void 0:u.forceMount;X(()=>{if(!d)return t.item(c,u==null?void 0:u.id)},[d]);let j=ys(c,m,[s.value,s.children,m],s.keywords),g=He(),C=Q(i=>i.value&&i.value===j.current),f=Q(i=>d||t.filter()===!1?!0:i.search?i.filtered.items.get(c)>0:!0);l.useEffect(()=>{let i=m.current;if(!(!i||s.disabled))return i.addEventListener(Le,y),()=>i.removeEventListener(Le,y)},[f,s.onSelect,s.disabled]);function y(){var i,v;R(),(v=(i=b.current).onSelect)==null||v.call(i,j.current)}function R(){g.setState("value",j.current,!0)}if(!f)return null;let{disabled:I,value:U,onSelect:k,forceMount:D,keywords:T,...x}=s;return l.createElement(_.div,{ref:me(m,r),...x,id:c,"cmdk-item":"",role:"option","aria-disabled":!!I,"aria-selected":!!C,"data-disabled":!!I,"data-selected":!!C,onPointerMove:I||t.getDisablePointerSelection()?void 0:R,onClick:I?void 0:y},s.children)}),jt=l.forwardRef((s,r)=>{let{heading:a,children:o,forceMount:c,...m}=s,u=re(),t=l.useRef(null),b=l.useRef(null),d=re(),j=ue(),g=Q(f=>c||j.filter()===!1?!0:f.search?f.filtered.groups.has(u):!0);X(()=>j.group(u),[]),ys(u,t,[s.value,s.heading,b]);let C=l.useMemo(()=>({id:u,forceMount:c}),[c]);return l.createElement(_.div,{ref:me(t,r),...m,"cmdk-group":"",role:"presentation",hidden:g?void 0:!0},a&&l.createElement("div",{ref:b,"cmdk-group-heading":"","aria-hidden":!0,id:d},a),Ne(s,f=>l.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":a?d:void 0},l.createElement(vs.Provider,{value:C},f))))}),gt=l.forwardRef((s,r)=>{let{alwaysRender:a,...o}=s,c=l.useRef(null),m=Q(u=>!u.search);return!a&&!m?null:l.createElement(_.div,{ref:me(c,r),...o,"cmdk-separator":"",role:"separator"})}),vt=l.forwardRef((s,r)=>{let{onValueChange:a,...o}=s,c=s.value!=null,m=He(),u=Q(d=>d.search),t=Q(d=>d.selectedItemId),b=ue();return l.useEffect(()=>{s.value!=null&&m.setState("search",s.value)},[s.value]),l.createElement(_.input,{ref:r,...o,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":b.listId,"aria-labelledby":b.labelId,"aria-activedescendant":t,id:b.inputId,type:"text",value:c?s.value:u,onChange:d=>{c||m.setState("search",d.target.value),a==null||a(d.target.value)}})}),Nt=l.forwardRef((s,r)=>{let{children:a,label:o="Suggestions",...c}=s,m=l.useRef(null),u=l.useRef(null),t=Q(d=>d.selectedItemId),b=ue();return l.useEffect(()=>{if(u.current&&m.current){let d=u.current,j=m.current,g,C=new ResizeObserver(()=>{g=requestAnimationFrame(()=>{let f=d.offsetHeight;j.style.setProperty("--cmdk-list-height",f.toFixed(1)+"px")})});return C.observe(d),()=>{cancelAnimationFrame(g),C.unobserve(d)}}},[]),l.createElement(_.div,{ref:me(m,r),...c,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":t,"aria-label":o,id:b.listId},Ne(s,d=>l.createElement("div",{ref:me(u,b.listInnerRef),"cmdk-list-sizer":""},d)))}),bt=l.forwardRef((s,r)=>{let{open:a,onOpenChange:o,overlayClassName:c,contentClassName:m,container:u,...t}=s;return l.createElement(Es,{open:a,onOpenChange:o},l.createElement(As,{container:u},l.createElement(Is,{"cmdk-overlay":"",className:c}),l.createElement(Fs,{"aria-label":s.label,"cmdk-dialog":"",className:m},l.createElement(Ns,{ref:r,...t}))))}),yt=l.forwardRef((s,r)=>Q(a=>a.filtered.count===0)?l.createElement(_.div,{ref:r,...s,"cmdk-empty":"",role:"presentation"}):null),kt=l.forwardRef((s,r)=>{let{progress:a,children:o,label:c="Loading...",...m}=s;return l.createElement(_.div,{ref:r,...m,"cmdk-loading":"",role:"progressbar","aria-valuenow":a,"aria-valuemin":0,"aria-valuemax":100,"aria-label":c},Ne(s,u=>l.createElement("div",{"aria-hidden":!0},u)))}),M=Object.assign(Ns,{List:Nt,Item:ft,Input:vt,Group:jt,Separator:gt,Dialog:bt,Empty:yt,Loading:kt});function wt(s,r){let a=s.nextElementSibling;for(;a;){if(a.matches(r))return a;a=a.nextElementSibling}}function Ct(s,r){let a=s.previousElementSibling;for(;a;){if(a.matches(r))return a;a=a.previousElementSibling}}function bs(s){let r=l.useRef(s);return X(()=>{r.current=s}),r}var X=typeof window>"u"?l.useEffect:l.useLayoutEffect;function te(s){let r=l.useRef();return r.current===void 0&&(r.current=s()),r}function Q(s){let r=He(),a=()=>s(r.snapshot());return l.useSyncExternalStore(r.subscribe,a,a)}function ys(s,r,a,o=[]){let c=l.useRef(),m=ue();return X(()=>{var u;let t=(()=>{var d;for(let j of a){if(typeof j=="string")return j.trim();if(typeof j=="object"&&"current"in j)return j.current?(d=j.current.textContent)==null?void 0:d.trim():c.current}})(),b=o.map(d=>d.trim());m.value(s,t,b),(u=r.current)==null||u.setAttribute(se,t),c.current=t}),c}var St=()=>{let[s,r]=l.useState(),a=te(()=>new Map);return X(()=>{a.current.forEach(o=>o()),a.current=new Map},[s]),(o,c)=>{a.current.set(o,c),r({})}};function Tt(s){let r=s.type;return typeof r=="function"?r(s.props):"render"in r?r.render(s.props):s}function Ne({asChild:s,children:r},a){return s&&l.isValidElement(r)?l.cloneElement(Tt(r),{ref:r.ref},a(r.props.children)):a(r)}var Rt={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const ks=l.forwardRef(({className:s,...r},a)=>e.jsx(M,{ref:a,className:le("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",s),...r}));ks.displayName=M.displayName;const ws=l.forwardRef(({className:s,...r},a)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(ss,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(M.Input,{ref:a,className:le("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",s),...r})]}));ws.displayName=M.Input.displayName;const Cs=l.forwardRef(({className:s,...r},a)=>e.jsx(M.List,{ref:a,className:le("max-h-[300px] overflow-y-auto overflow-x-hidden",s),...r}));Cs.displayName=M.List.displayName;const Ss=l.forwardRef((s,r)=>e.jsx(M.Empty,{ref:r,className:"py-6 text-center text-sm",...s}));Ss.displayName=M.Empty.displayName;const Ts=l.forwardRef(({className:s,...r},a)=>e.jsx(M.Group,{ref:a,className:le("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",s),...r}));Ts.displayName=M.Group.displayName;const Et=l.forwardRef(({className:s,...r},a)=>e.jsx(M.Separator,{ref:a,className:le("-mx-1 h-px bg-border",s),...r}));Et.displayName=M.Separator.displayName;const Rs=l.forwardRef(({className:s,...r},a)=>e.jsx(M.Item,{ref:a,className:le("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s),...r}));Rs.displayName=M.Item.displayName;const At=O.object({recipientId:O.string().min(1,{message:"Please select a recipient"}),amount:O.string().refine(s=>!isNaN(Number(s)),{message:"Amount must be a number"}).refine(s=>Number(s)>0,{message:"Amount must be greater than 0"}).refine(s=>Number(s)===Math.floor(Number(s)),{message:"Amount must be a whole number"}),notes:O.string().max(100).optional()});function It(){const{toast:s}=Ve(),[r,a]=l.useState(!1),[o,c]=l.useState(null),[m,u]=l.useState(!1),[t,b]=l.useState(""),{data:d,isLoading:j}=je({queryKey:["/api/tokens"],refetchOnWindowFocus:!1}),{data:g,isLoading:C,refetch:f}=je({queryKey:["/api/users/search",t],enabled:t.length>=2,queryFn:async()=>await(await De("GET",`/api/users/search?q=${encodeURIComponent(t)}`)).json()}),y=ts({resolver:ms(At),defaultValues:{recipientId:"",amount:"",notes:""}});l.useEffect(()=>{o?y.setValue("recipientId",o.id.toString()):y.setValue("recipientId","")},[o,y]);const R=ge({mutationFn:async x=>await(await De("POST","/api/tokens/transfer",{recipientId:x.recipientId,amount:Number(x.amount),notes:x.notes})).json(),onSuccess:()=>{ne.invalidateQueries({queryKey:["/api/tokens"]}),ne.invalidateQueries({queryKey:["/api/rewards/history"]}),s({title:"Tokens transferred successfully!",description:`You've sent ${y.getValues().amount} tokens to ${o==null?void 0:o.username}.`,variant:"default"}),y.reset(),c(null),a(!1)},onError:x=>{a(!1),s({title:"Transfer failed",description:x.message||"Failed to transfer tokens. Please try again.",variant:"destructive"})}}),I=x=>{if(!o){s({title:"No recipient selected",description:"Please select a user to send tokens to.",variant:"destructive"});return}const i=Number(x.amount);if(d&&i>d.tokens){s({title:"Insufficient tokens",description:`You only have ${d.tokens} tokens available.`,variant:"destructive"});return}a(!0)},U=()=>{R.mutate(y.getValues())},k=x=>{b(x),x.length>=2&&f()},D=x=>{c(x),u(!1)},T=x=>x.firstName&&x.lastName?`${x.firstName[0]}${x.lastName[0]}`.toUpperCase():x.username.substring(0,2).toUpperCase();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Transfer Tokens"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Send tokens to other MoodSync users. This feature is exclusive to premium members."})]}),e.jsx(F,{children:e.jsx(P,{className:"p-6",children:e.jsx(as,{...y,children:e.jsxs("form",{onSubmit:y.handleSubmit(I),className:"space-y-6",children:[e.jsx(z,{control:y.control,name:"recipientId",render:()=>e.jsxs(B,{className:"flex flex-col",children:[e.jsx(q,{children:"Recipient"}),e.jsxs(Ps,{open:m,onOpenChange:u,children:[e.jsx(Ms,{asChild:!0,children:e.jsx(E,{variant:"outline",role:"combobox",className:"justify-start w-full",children:o?e.jsxs("div",{className:"flex items-center",children:[e.jsxs(Se,{className:"h-6 w-6 mr-2",children:[e.jsx(Te,{src:o.profilePicture}),e.jsx(Re,{children:T(o)})]}),e.jsx("span",{children:o.username}),o.firstName&&o.lastName&&e.jsxs("span",{className:"ml-2 text-muted-foreground",children:["(",o.firstName," ",o.lastName,")"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(ss,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Search for a user"})]})})}),e.jsx($s,{className:"p-0 w-full min-w-[300px]",children:e.jsxs(ks,{children:[e.jsx(ws,{placeholder:"Search by username, name, or email",onValueChange:k,value:t}),e.jsxs(Cs,{children:[C&&e.jsx("div",{className:"p-4 text-center text-sm",children:"Searching..."}),!C&&t.length<2&&e.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"Type at least 2 characters to search"}),!C&&t.length>=2&&e.jsx(Ss,{children:"No users found"}),e.jsx(Ts,{children:g==null?void 0:g.map(x=>e.jsx(Rs,{onSelect:()=>D(x),className:"cursor-pointer",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs(Se,{className:"h-8 w-8 mr-2",children:[e.jsx(Te,{src:x.profilePicture}),e.jsx(Re,{children:T(x)})]}),e.jsxs("div",{children:[e.jsx("div",{children:x.username}),x.firstName&&x.lastName&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:[x.firstName," ",x.lastName]}),x.email&&e.jsx("div",{className:"text-xs text-muted-foreground",children:x.email})]})]})},x.id))})]})]})})]}),e.jsx(Y,{})]})}),e.jsx(z,{control:y.control,name:"amount",render:({field:x})=>e.jsxs(B,{children:[e.jsx(q,{children:"Amount"}),e.jsx(K,{children:e.jsxs("div",{className:"relative",children:[e.jsx(ae,{placeholder:"Enter amount of tokens",...x,type:"number",min:"1",step:"1"}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none text-muted-foreground",children:"tokens"})]})}),e.jsxs(ve,{className:"flex justify-between",children:[e.jsx("span",{children:"Minimum transfer: 10 tokens"}),e.jsxs("span",{children:["Balance: ",j?"...":(d==null?void 0:d.tokens)||0," tokens"]})]}),e.jsx(Y,{})]})}),e.jsx(z,{control:y.control,name:"notes",render:({field:x})=>e.jsxs(B,{children:[e.jsx(q,{children:"Note (Optional)"}),e.jsx(K,{children:e.jsx(ns,{placeholder:"Add a personal note",className:"resize-none",...x})}),e.jsx(ve,{children:"This note will be visible to the recipient"}),e.jsx(Y,{})]})}),e.jsxs(E,{type:"submit",className:"w-full",disabled:R.isPending,children:[e.jsx(Ds,{className:"h-4 w-4 mr-2"}),R.isPending?"Transferring...":"Send Tokens"]})]})})})}),e.jsx(rs,{open:r,onOpenChange:a,children:e.jsxs(ls,{children:[e.jsxs(is,{children:[e.jsx(os,{children:"Confirm Token Transfer"}),e.jsx(cs,{children:"Please review and confirm your token transfer details."})]}),e.jsxs("div",{className:"space-y-4 py-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(de,{className:"text-muted-foreground",children:"Recipient:"}),e.jsxs("div",{className:"font-medium flex items-center",children:[e.jsxs(Se,{className:"h-6 w-6 mr-2",children:[e.jsx(Te,{src:o==null?void 0:o.profilePicture}),e.jsx(Re,{children:o?T(o):"NA"})]}),o==null?void 0:o.username]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(de,{className:"text-muted-foreground",children:"Amount:"}),e.jsxs("div",{className:"font-medium",children:[y.getValues().amount," tokens"]})]}),y.getValues().notes&&e.jsxs("div",{className:"border-t pt-3 mt-3",children:[e.jsx(de,{className:"text-muted-foreground mb-2 block",children:"Note:"}),e.jsx("div",{className:"text-sm bg-muted p-3 rounded-md",children:y.getValues().notes})]}),e.jsxs("div",{className:"flex items-start mt-4 bg-yellow-50 dark:bg-yellow-950 p-3 rounded-md",children:[e.jsx(Bs,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-500 mt-0.5 mr-2 flex-shrink-0"}),e.jsx("div",{className:"text-sm text-yellow-800 dark:text-yellow-400",children:"This action cannot be undone. Once sent, the tokens will be immediately transferred to the recipient."})]})]}),e.jsxs(ds,{children:[e.jsx(E,{variant:"outline",onClick:()=>a(!1),disabled:R.isPending,children:"Cancel"}),e.jsxs(E,{onClick:U,disabled:R.isPending,className:"ml-2",children:[e.jsx(Ke,{className:"h-4 w-4 mr-2"}),R.isPending?"Processing...":"Confirm Transfer"]})]})]})})]})}function Ft({milestone:s,isAchieved:r,currentTokens:a,title:o,description:c,className:m}){const[u,t]=l.useState(!1),[b,d]=l.useState(""),[j,g]=l.useState(!1),{toast:C}=Ve(),f=r?`I've reached the ${s} tokens milestone on MoodSync! ${o}`:`I'm working toward the ${s} tokens milestone on MoodSync! ${Math.round(a/s*100)}% there so far!`,y=k=>{k&&(d(f),g(!1)),t(k)},R=`${window.location.origin}/milestones/${s}`,I=ge({mutationFn:async k=>(await De("POST","/api/milestone-shares",k)).json(),onSuccess:k=>{k.tokensAwarded>0&&C({title:"Token reward!",description:k.message,variant:"success"})},onError:k=>{C({title:"Share error",description:k instanceof Error?k.message:"Failed to record share",variant:"destructive"})}}),U=()=>{navigator.clipboard.writeText(R),g(!0),setTimeout(()=>g(!1),2e3);const k=Je();I.mutate({platform:"copy_link",shareUrl:R,shareMessage:b,milestone:s,trackingId:k}),C({title:"Link copied!",description:"The milestone share link has been copied to your clipboard.",variant:"success"})};return e.jsx("div",{className:m,children:e.jsxs(F,{className:"overflow-hidden border-gradient",children:[e.jsx(L,{className:"pb-2",children:e.jsx(V,{className:"text-lg font-medium",children:"Share Your Milestone"})}),e.jsxs(P,{className:"pt-0",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Share your token milestone progress with friends and earn additional tokens!"}),e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsx(Js,{url:R,title:`${o} - MoodSync Milestone`,message:f,milestone:s}),e.jsxs(rs,{open:u,onOpenChange:y,children:[e.jsx(qs,{asChild:!0,children:e.jsxs(E,{variant:"outline",className:"gap-2",children:[e.jsx(Ls,{className:"h-4 w-4"}),"Customize Share"]})}),e.jsxs(ls,{className:"sm:max-w-md",children:[e.jsxs(is,{children:[e.jsx(os,{children:"Share Milestone"}),e.jsx(cs,{children:"Customize your message before sharing your milestone."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(de,{htmlFor:"message",children:"Share message"}),e.jsx(ns,{id:"message",value:b,onChange:k=>d(k.target.value),className:"resize-none",rows:3})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(de,{htmlFor:"link",children:"Link"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{id:"link",value:R,readOnly:!0,className:"flex-1"}),e.jsxs(E,{type:"button",size:"sm",className:"px-3",onClick:U,children:[j?e.jsx(Vs,{className:"h-4 w-4"}):e.jsx(Xs,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Copy link"})]})]})]})]}),e.jsx(ds,{className:"flex flex-col sm:flex-row",children:e.jsx("div",{className:"grid grid-cols-4 gap-2 w-full sm:w-auto",children:[{name:"twitter",icon:e.jsx(Zs,{className:"h-4 w-4"}),label:"Twitter"},{name:"facebook",icon:e.jsx(et,{className:"h-4 w-4"}),label:"Facebook"},{name:"linkedin",icon:e.jsx(st,{className:"h-4 w-4"}),label:"LinkedIn"},{name:"whatsapp",icon:e.jsx(us,{className:"h-4 w-4"}),label:"WhatsApp"}].map(k=>e.jsxs(E,{type:"button",variant:"outline",size:"sm",className:"flex flex-col items-center p-2 h-auto gap-1",onClick:()=>{const D=Je();let T="";switch(k.name){case"twitter":T=`https://twitter.com/intent/tweet?text=${encodeURIComponent(b)}`;break;case"facebook":T=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(window.location.href)}`;break;case"linkedin":T=`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(window.location.href)}&title=${encodeURIComponent(b)}`;break;case"whatsapp":T=`https://api.whatsapp.com/send?text=${encodeURIComponent(`${b} ${window.location.href}`)}`;break}I.mutate({platform:k.name,shareUrl:window.location.href,shareMessage:b,milestone:s,trackingId:D}),window.open(T,"_blank"),t(!1)},children:[k.icon,e.jsx("span",{className:"text-xs",children:k.label})]},k.name))})})]})]})]})]}),e.jsx(J,{className:"bg-gray-50 dark:bg-gray-800/50 p-3",children:e.jsx("div",{className:"text-xs text-gray-500 w-full text-center",children:r?"Share your achievement to earn tokens!":"Share your progress to earn tokens!"})})]})})}function Pt({tokensRedeemed:s,cashAmount:r,onDismiss:a}){const[o,c]=Os();return e.jsxs(F,{className:"w-full shadow-lg border-green-200 bg-gradient-to-b from-green-50 to-white",children:[e.jsxs(L,{className:"pb-4 text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-green-100",children:e.jsx(Ke,{className:"h-10 w-10 text-green-600"})}),e.jsx(V,{className:"text-2xl",children:"Redemption Successful!"})]}),e.jsxs(P,{className:"text-center space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-gray-600",children:"You've successfully redeemed"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[s," tokens"]}),e.jsx("p",{className:"text-gray-600",children:"for"}),e.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["$",r]})]}),e.jsxs("div",{className:"text-sm text-gray-500 mt-2",children:[e.jsx("p",{children:"Your redemption has been submitted and is being processed."}),e.jsx("p",{children:"You'll receive a confirmation once it's completed."})]})]}),e.jsxs(J,{className:"flex flex-col space-y-3 pt-0",children:[e.jsx("div",{className:"w-full",children:e.jsx(Ft,{milestone:1e3,currentTokens:s,className:"w-full"})}),e.jsxs("div",{className:"flex space-x-3 w-full",children:[e.jsx(E,{variant:"outline",className:"flex-1",onClick:()=>c("/milestones"),children:"View Milestones"}),e.jsx(E,{variant:"default",className:"flex-1",onClick:a,children:"Back to Redemption"})]})]})]})}const Mt=O.object({tokensRedeemed:O.string().min(1,"Token amount is required").refine(s=>!isNaN(Number(s)),"Must be a valid number").refine(s=>Number(s)>0,"Token amount must be greater than 0"),cashAmount:O.string(),redemptionType:O.enum(["cash","donation","transfer"]),recipientInfo:O.string().optional(),currency:O.string().default("USD"),notes:O.string().optional()});function $t(){const[s,r]=l.useState("redeem"),[a,o]=l.useState(!1),[c,m]=l.useState({tokensRedeemed:0,cashAmount:"0.00"}),{toast:u}=Ve(),{data:t,isLoading:b,error:d}=je({queryKey:["/api/token-redemption/eligibility"],refetchOnWindowFocus:!1}),{data:j,isLoading:g,error:C}=je({queryKey:["/api/token-redemption/history"],refetchOnWindowFocus:!1}),f=ts({resolver:ms(Mt),defaultValues:{tokensRedeemed:"",cashAmount:"0.00",redemptionType:"cash",recipientInfo:"",currency:"USD",notes:""}});l.useEffect(()=>{const i=f.watch(v=>{if(t&&v.tokensRedeemed&&!isNaN(Number(v.tokensRedeemed))){const he=(Number(v.tokensRedeemed)*.001).toFixed(2);f.setValue("cashAmount",he)}});return()=>i.unsubscribe()},[f,t]);const y=ge({mutationFn:async i=>{const v=await fetch("/api/token-redemption/request",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!v.ok){const H=await v.json();throw new Error(H.message||"Failed to create redemption request")}return v.json()},onSuccess:(i,v)=>{m({tokensRedeemed:Number(v.tokensRedeemed),cashAmount:v.cashAmount}),o(!0),f.reset(),ne.invalidateQueries({queryKey:["/api/token-redemption/eligibility"]}),ne.invalidateQueries({queryKey:["/api/token-redemption/history"]})},onError:i=>{u({title:"Redemption Request Failed",description:i.message,variant:"destructive"})}}),R=ge({mutationFn:async i=>{const v=await fetch(`/api/token-redemption/${i}/cancel`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!v.ok){const H=await v.json();throw new Error(H.message||"Failed to cancel redemption request")}return v.json()},onSuccess:()=>{u({title:"Redemption Canceled",description:"Your token redemption request has been canceled successfully."}),ne.invalidateQueries({queryKey:["/api/token-redemption/eligibility"]}),ne.invalidateQueries({queryKey:["/api/token-redemption/history"]})},onError:i=>{u({title:"Cancellation Failed",description:i.message,variant:"destructive"})}}),I=i=>{if(!(t!=null&&t.eligible)){u({title:"Not Eligible",description:`You need at least ${(t==null?void 0:t.minimumTokens)||1e4} tokens to redeem.`,variant:"destructive"});return}if(Number(i.tokensRedeemed)>t.tokenBalance){u({title:"Insufficient Tokens",description:`You only have ${t.tokenBalance} tokens available.`,variant:"destructive"});return}y.mutate(i)},U=i=>{confirm("Are you sure you want to cancel this redemption request?")&&R.mutate(i)},k=i=>{switch(i){case"pending":return e.jsx(ee,{variant:"outline",className:"bg-yellow-50 text-yellow-700 border-yellow-200",children:"Pending"});case"processing":return e.jsx(ee,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:"Processing"});case"completed":return e.jsx(ee,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:"Completed"});case"failed":return e.jsx(ee,{variant:"outline",className:"bg-red-50 text-red-700 border-red-200",children:"Failed"});case"canceled":return e.jsx(ee,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:"Canceled"});default:return e.jsx(ee,{variant:"outline",children:i})}};if(b)return e.jsx("div",{className:"flex items-center justify-center h-52",children:e.jsx(pe,{className:"w-8 h-8 animate-spin text-primary"})});const{user:D}=hs(),T=(D==null?void 0:D.isPremium)||!1,x=()=>{o(!1)};return a?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"max-w-md w-full",children:e.jsx(Pt,{tokensRedeemed:c.tokensRedeemed,cashAmount:c.cashAmount,onDismiss:x})})}):e.jsx("div",{className:"space-y-6",children:e.jsxs(Oe,{defaultValue:s,onValueChange:r,className:"w-full",children:[e.jsxs(Ue,{className:"grid w-full grid-cols-4",children:[e.jsx(G,{value:"redeem",children:"Redeem Tokens"}),e.jsx(G,{value:"premium-access",disabled:T,children:e.jsxs("div",{className:"flex items-center",children:[T&&e.jsx("span",{className:"mr-1.5 text-xs bg-amber-200 dark:bg-amber-800 text-amber-800 dark:text-amber-200 py-0.5 px-1.5 rounded-sm",children:"Available"}),"Premium Access"]})}),e.jsx(G,{value:"transfer",disabled:!T,children:e.jsxs("div",{className:"flex items-center",children:[!T&&e.jsx("span",{className:"mr-1.5 text-xs bg-amber-200 dark:bg-amber-800 text-amber-800 dark:text-amber-200 py-0.5 px-1.5 rounded-sm",children:"Premium"}),"Transfer Tokens"]})}),e.jsx(G,{value:"history",children:"History"})]}),e.jsx(W,{value:"premium-access",className:"space-y-4 pt-4",children:T?e.jsx(F,{children:e.jsx(P,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center space-y-4",children:[e.jsx("div",{className:"bg-green-100 dark:bg-green-900/40 p-3 rounded-full",children:e.jsx(Ke,{className:"h-8 w-8 text-green-600 dark:text-green-400"})}),e.jsx("h3",{className:"text-xl font-semibold",children:"You Already Have Premium Access"}),e.jsx("p",{className:"text-muted-foreground max-w-md",children:"You're already enjoying all the premium features with your current subscription. There's no need to redeem tokens for premium access."})]})})}):e.jsxs(F,{children:[e.jsxs(L,{children:[e.jsx(V,{children:"Premium Access with Tokens"}),e.jsx(ce,{children:"Use tokens to temporarily upgrade to premium features"})]}),e.jsxs(P,{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-primary/10 to-primary/5 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-medium mb-2",children:"How It Works"}),e.jsx("p",{className:"text-muted-foreground text-sm mb-3",children:"Redeem your earned tokens for temporary access to all premium features without a subscription. The more tokens you use, the longer your premium access duration."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(F,{className:"bg-gradient-to-b from-card/80 to-card hover:shadow-md transition-shadow border-primary/20",children:[e.jsx(L,{className:"pb-2",children:e.jsx(V,{className:"text-lg",children:"1 Week Access"})}),e.jsxs(P,{children:[e.jsx("p",{className:"text-3xl font-bold text-primary mb-1",children:"2,500"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"tokens"})]}),e.jsx(J,{children:e.jsx(E,{variant:t&&t.tokenBalance>=2500?"default":"outline",className:"w-full",disabled:!t||t.tokenBalance<2500,children:t&&t.tokenBalance>=2500?"Redeem Now":"Not Enough Tokens"})})]}),e.jsxs(F,{className:"bg-gradient-to-b from-card/80 to-card hover:shadow-md transition-shadow border-primary/20",children:[e.jsx(L,{className:"pb-2",children:e.jsx(V,{className:"text-lg",children:"2 Weeks Access"})}),e.jsxs(P,{children:[e.jsx("p",{className:"text-3xl font-bold text-primary mb-1",children:"4,500"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"tokens"})]}),e.jsx(J,{children:e.jsx(E,{variant:t&&t.tokenBalance>=4500?"default":"outline",className:"w-full",disabled:!t||t.tokenBalance<4500,children:t&&t.tokenBalance>=4500?"Redeem Now":"Not Enough Tokens"})})]}),e.jsxs(F,{className:"bg-gradient-to-b from-card/80 to-card hover:shadow-md transition-shadow border-primary/20",children:[e.jsx(L,{className:"pb-2",children:e.jsx(V,{className:"text-lg",children:"3 Weeks Access"})}),e.jsxs(P,{children:[e.jsx("p",{className:"text-3xl font-bold text-primary mb-1",children:"7,000"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"tokens"})]}),e.jsx(J,{children:e.jsx(E,{variant:t&&t.tokenBalance>=7e3?"default":"outline",className:"w-full",disabled:!t||t.tokenBalance<7e3,children:t&&t.tokenBalance>=7e3?"Redeem Now":"Not Enough Tokens"})})]}),e.jsxs(F,{className:"bg-gradient-to-b from-card/80 to-card hover:shadow-md transition-shadow border-primary/20",children:[e.jsx(L,{className:"pb-2",children:e.jsx(V,{className:"text-lg",children:"4 Weeks Access"})}),e.jsxs(P,{children:[e.jsx("p",{className:"text-3xl font-bold text-primary mb-1",children:"10,000"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"tokens"})]}),e.jsx(J,{children:e.jsx(E,{variant:t&&t.tokenBalance>=1e4?"default":"outline",className:"w-full",disabled:!t||t.tokenBalance<1e4,children:t&&t.tokenBalance>=1e4?"Redeem Now":"Not Enough Tokens"})})]})]}),e.jsx("div",{className:"bg-muted/30 p-4 rounded-lg mt-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(fe,{className:"h-5 w-5 text-blue-500 mr-2 mt-0.5"}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-sm",children:["Your token balance: ",(t==null?void 0:t.tokenBalance)||0," tokens"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Continue using MoodSync and completing challenges to earn more tokens!"})]})]})})]})]})}),e.jsx(W,{value:"transfer",className:"space-y-4 pt-4",children:T?e.jsx(It,{}):e.jsx(F,{children:e.jsx(P,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center space-y-4",children:[e.jsx("div",{className:"bg-amber-100 dark:bg-amber-900/40 p-3 rounded-full",children:e.jsx(xs,{className:"h-8 w-8 text-amber-600 dark:text-amber-400"})}),e.jsx("h3",{className:"text-xl font-semibold",children:"Premium Feature"}),e.jsx("p",{className:"text-muted-foreground max-w-md",children:"Token transfers are available exclusively to premium members. Upgrade to premium to send tokens to friends and family!"}),e.jsx(E,{className:"mt-2",variant:"default",children:"Upgrade to Premium"})]})})})}),e.jsx(W,{value:"redeem",className:"space-y-4 pt-4",children:e.jsxs(F,{children:[e.jsxs(L,{children:[e.jsx(V,{children:"Your Token Balance"}),e.jsx(ce,{children:"Redeem your tokens for real-world value"})]}),e.jsx(P,{className:"space-y-4",children:d?e.jsxs(Ee,{variant:"destructive",children:[e.jsx(fe,{className:"h-4 w-4"}),e.jsx(Ae,{children:"Error"}),e.jsx(Ie,{children:d instanceof Error?d.message:"Failed to load eligibility information"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-primary",children:(t==null?void 0:t.tokenBalance.toLocaleString())||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Available Tokens"})]}),e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-primary",children:["$",(((t==null?void 0:t.tokenBalance)||0)*.001).toFixed(2)]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Estimated Value ",e.jsx("span",{className:"text-xs text-muted-foreground",children:"($0.0010 per token)"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Progress to Redemption Goal"}),e.jsxs("span",{className:"font-medium",children:[(t==null?void 0:t.tokenBalance)||0,"/10000 tokens (",Math.min(100,Math.floor(((t==null?void 0:t.tokenBalance)||0)/1e4*100)),"%)"]})]}),e.jsx(Us,{value:Math.min(100,((t==null?void 0:t.tokenBalance)||0)/1e4*100),className:"h-2"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"0"}),e.jsx("span",{children:"10000"})]})]}),(t==null?void 0:t.eligible)&&e.jsx("div",{className:"flex justify-center mt-2",children:e.jsxs(E,{className:"w-full sm:w-auto",onClick:()=>{f.setValue("tokensRedeemed","10000"),f.setValue("cashAmount",(1e4*.001).toFixed(2)),r("redeem"),setTimeout(()=>{var v;(v=document.getElementById("redemption-form"))==null||v.scrollIntoView({behavior:"smooth"})},100)},children:[e.jsx(Ks,{className:"mr-2 h-4 w-4"}),"Redeem 10000 Tokens Now"]})}),!(t!=null&&t.eligible)&&e.jsxs(Ee,{children:[e.jsx(fe,{className:"h-4 w-4"}),e.jsx(Ae,{children:"Not Eligible"}),e.jsx(Ie,{children:"You need at least 10000 tokens to redeem. Keep earning to reach the minimum!"})]}),(t==null?void 0:t.eligible)&&e.jsx(as,{...f,children:e.jsxs("form",{id:"redemption-form",onSubmit:f.handleSubmit(I),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(z,{control:f.control,name:"tokensRedeemed",render:({field:i})=>e.jsxs(B,{children:[e.jsx(q,{children:"Tokens to Redeem"}),e.jsx(K,{children:e.jsx(ae,{type:"number",placeholder:"Enter amount of tokens",...i,min:t.minimumTokens,max:t.tokenBalance})}),e.jsx(ve,{children:"Minimum: 10000 tokens"}),e.jsx(Y,{})]})}),e.jsx(z,{control:f.control,name:"cashAmount",render:({field:i})=>e.jsxs(B,{children:[e.jsx(q,{children:"Estimated Value"}),e.jsx(K,{children:e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"inline-flex items-center px-3 rounded-l-md border border-r-0 border-input bg-muted text-muted-foreground text-sm",children:"$"}),e.jsx(ae,{className:"rounded-l-none",...i,disabled:!0})]})}),e.jsx(ve,{children:"Rate: $0.0010 per token"}),e.jsx(Y,{})]})})]}),e.jsx(z,{control:f.control,name:"redemptionType",render:({field:i})=>e.jsxs(B,{className:"space-y-3",children:[e.jsx(q,{children:"Redemption Type"}),e.jsx(K,{children:e.jsxs(tt,{onValueChange:i.onChange,defaultValue:i.value,className:"flex flex-col space-y-1",children:[e.jsxs(B,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(K,{children:e.jsx(Fe,{value:"cash"})}),e.jsx(q,{className:"font-normal",children:"Cash Payout"})]}),e.jsxs(B,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(K,{children:e.jsx(Fe,{value:"donation"})}),e.jsx(q,{className:"font-normal",children:"Donate to Charity"})]}),e.jsxs(B,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(K,{children:e.jsx(Fe,{value:"transfer"})}),e.jsx(q,{className:"font-normal",children:"Transfer to Another User"})]})]})}),e.jsx(Y,{})]})}),f.watch("redemptionType")!=="cash"&&e.jsx(z,{control:f.control,name:"recipientInfo",render:({field:i})=>e.jsxs(B,{children:[e.jsx(q,{children:f.watch("redemptionType")==="donation"?"Charity Information":"Recipient Username"}),e.jsx(K,{children:e.jsx(ae,{placeholder:f.watch("redemptionType")==="donation"?"Enter charity name":"Enter recipient username",...i})}),e.jsx(Y,{})]})}),e.jsx(z,{control:f.control,name:"notes",render:({field:i})=>e.jsxs(B,{children:[e.jsx(q,{children:"Notes (Optional)"}),e.jsx(K,{children:e.jsx(ae,{placeholder:"Add any additional information",...i})}),e.jsx(Y,{})]})}),e.jsxs(E,{type:"submit",className:"w-full",disabled:y.isPending,children:[y.isPending&&e.jsx(pe,{className:"mr-2 h-4 w-4 animate-spin"}),"Submit Redemption Request"]})]})})]})})]})}),e.jsx(W,{value:"history",className:"pt-4",children:e.jsxs(F,{children:[e.jsxs(L,{children:[e.jsx(V,{children:"Redemption History"}),e.jsx(ce,{children:"Track your token redemption requests"})]}),e.jsx(P,{children:g?e.jsx("div",{className:"flex items-center justify-center h-52",children:e.jsx(pe,{className:"w-8 h-8 animate-spin text-primary"})}):C?e.jsxs(Ee,{variant:"destructive",children:[e.jsx(fe,{className:"h-4 w-4"}),e.jsx(Ae,{children:"Error"}),e.jsx(Ie,{children:C instanceof Error?C.message:"Failed to load redemption history"})]}):e.jsx("div",{className:"space-y-4",children:j&&j.length>0?j.map(i=>e.jsxs(F,{className:"bg-muted/30",children:[e.jsx(L,{className:"p-4 pb-2",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs(V,{className:"text-base",children:[i.tokensRedeemed," Tokens",e.jsxs("span",{className:"ml-2 text-sm font-normal text-muted-foreground",children:["($",i.cashAmount,")"]})]}),e.jsxs(ce,{children:[new Date(i.createdAt).toLocaleDateString()," at ",new Date(i.createdAt).toLocaleTimeString()]})]}),e.jsx("div",{children:k(i.status)})]})}),e.jsx(P,{className:"p-4 pt-0 pb-2",children:e.jsx("div",{className:"text-sm",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Type:"}),e.jsx("div",{className:"font-medium capitalize",children:i.redemptionType}),i.recipientInfo&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground",children:"Recipient:"}),e.jsx("div",{className:"font-medium",children:i.recipientInfo})]}),i.processedAt&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground",children:"Processed Date:"}),e.jsx("div",{className:"font-medium",children:new Date(i.processedAt).toLocaleDateString()})]}),i.notes&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground",children:"Notes:"}),e.jsx("div",{className:"font-medium",children:i.notes})]})]})})}),i.status==="pending"&&e.jsx(J,{className:"p-4 pt-2",children:e.jsxs(E,{variant:"outline",size:"sm",onClick:()=>U(i.id),disabled:R.isPending,children:[R.isPending&&e.jsx(pe,{className:"mr-2 h-3 w-3 animate-spin"}),"Cancel Request"]})})]},i.id)):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("div",{className:"mx-auto w-12 h-12 rounded-full bg-muted flex items-center justify-center mb-3",children:e.jsx(Hs,{className:"h-6 w-6"})}),e.jsx("h3",{className:"text-lg font-medium mb-1",children:"No redemption history"}),e.jsx("p",{className:"text-sm max-w-md mx-auto",children:"You haven't made any token redemption requests yet. Start redeeming your tokens today!"}),e.jsxs(E,{variant:"link",onClick:()=>r("redeem"),className:"mt-2",children:["Redeem Tokens ",e.jsx(zs,{className:"ml-1 h-4 w-4"})]})]})})})]})})]})})}function Dt(){const[s,r]=l.useState("earning"),a=[{title:"Daily Activities",description:"Earn tokens by maintaining your daily emotional wellness routine",icon:e.jsx(Ys,{className:"h-5 w-5 text-orange-500"}),activities:[{name:"Daily Check-in",tokens:.25,description:"Update your emotional state once per day"},{name:"Journal Entry",tokens:.5,description:"Create a journal entry about your feelings (once per day)"},{name:"Streak Bonus",tokens:.75,description:"Additional tokens for maintaining a 7+ day streak"}]},{title:"Community Participation",description:"Earn tokens by connecting with others and building community",icon:e.jsx(us,{className:"h-5 w-5 text-blue-500"}),activities:[{name:"Chat Participation",tokens:.5,description:"Participate in emotion-based chat rooms"},{name:"Help Others",tokens:.5,description:"Provide support to users with similar emotions"}]},{title:"Challenges",description:"Complete challenges to earn tokens based on difficulty",icon:e.jsx(Gs,{className:"h-5 w-5 text-purple-500"}),activities:[{name:"Easy Challenge",tokens:.5,description:"Complete basic emotional wellness challenges"},{name:"Moderate Challenge",tokens:.75,description:"Complete intermediate challenges requiring more effort"},{name:"Hard Challenge",tokens:1.25,description:"Complete difficult challenges requiring dedication"},{name:"Extreme Challenge",tokens:1.75,description:"Complete the most demanding emotional growth challenges"}]},{title:"Growth & Achievements",description:"Earn tokens by achieving personal growth milestones",icon:e.jsx(at,{className:"h-5 w-5 text-green-500"}),activities:[{name:"Badge Earned",tokens:.5,description:"Earn special badges for milestone achievements"},{name:"Level Up",tokens:1.25,description:"Reach a new level in your emotional wellness journey"}]}],o=[{title:"Cash Redemption",description:"Convert your tokens to real money",icon:e.jsx(_e,{className:"h-5 w-5 text-amber-500"}),details:["Minimum 10000 tokens required for redemption","Current conversion rate: $0.0010 per token","Processing time: 3-5 business days","Available payment methods: PayPal and Stripe"]},{title:"Charitable Donations",description:"Use your tokens to support mental health charities",icon:e.jsx(nt,{className:"h-5 w-5 text-red-500"}),details:["Donate to partner mental health organizations","Same conversion rate as cash redemptions","Receive a donation receipt for tax purposes","100% of the value goes directly to the charity"]},{title:"Premium Features",description:"Use tokens to unlock premium features temporarily",icon:e.jsx(Ws,{className:"h-5 w-5 text-violet-500"}),details:["Access premium features without a subscription","2500 tokens = 1 week of premium access","4500 tokens = 2 weeks of premium access","7000 tokens = 3 weeks of premium access","10000 tokens = 4 weeks of premium access","No recurring charges or automatic renewals"]},{title:"Token Transfers",description:"Send tokens to friends and family",icon:e.jsx(xs,{className:"h-5 w-5 text-emerald-500"}),details:["Transfer tokens to other MoodSync users","Minimum transfer amount: 10000 tokens","No fees for token transfers","Include a personalized message with your transfer"]}];return e.jsxs(F,{children:[e.jsxs(L,{children:[e.jsx(V,{children:"Token System Guide"}),e.jsx(ce,{children:"Learn how to earn and redeem tokens in the MoodSync platform"})]}),e.jsx(P,{className:"space-y-6",children:e.jsxs(Oe,{defaultValue:s,onValueChange:r,children:[e.jsxs(Ue,{className:"grid w-full grid-cols-2",children:[e.jsx(G,{value:"earning",children:"Earning Tokens"}),e.jsx(G,{value:"redemption",children:"Redemption Options"})]}),e.jsxs(W,{value:"earning",className:"space-y-6 pt-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"MoodSync rewards your engagement and commitment to emotional wellness. Here are all the ways you can earn tokens on the platform:"}),a.map((c,m)=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5 p-1.5 rounded-md bg-muted/50",children:c.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-medium",children:c.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:c.description})]})]}),e.jsx("div",{className:"ml-10 grid gap-2",children:c.activities.map((u,t)=>e.jsxs("div",{className:"grid grid-cols-[1fr_auto] gap-2 items-center bg-muted/30 p-3 rounded-md",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium",children:u.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:u.description})]}),e.jsxs("div",{className:"flex items-center bg-primary/10 text-primary rounded-full px-3 py-1 text-sm font-medium",children:["+",u.tokens," ",e.jsx(_e,{className:"ml-1 h-3.5 w-3.5"})]})]},t))}),m<a.length-1&&e.jsx(Be,{className:"my-4"})]},m)),e.jsxs("div",{className:"bg-muted/40 p-4 rounded-lg mt-4",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Important Note"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Token rewards for daily activities (check-ins, journal entries) can only be earned once per day. Streaks are calculated based on consecutive days of engagement. Missing a day will reset your streak."})]})]}),e.jsxs(W,{value:"redemption",className:"space-y-6 pt-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Turn your earned tokens into real-world value. Here are the ways you can redeem your tokens:"}),o.map((c,m)=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5 p-1.5 rounded-md bg-muted/50",children:c.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-medium",children:c.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:c.description})]})]}),e.jsx("div",{className:"ml-10",children:e.jsx("ul",{className:"space-y-2",children:c.details.map((u,t)=>e.jsxs("li",{className:"text-sm flex items-start",children:[e.jsx("span",{className:"mr-2 bg-primary rounded-full w-1.5 h-1.5 mt-1.5 flex-shrink-0"}),u]},t))})}),m<o.length-1&&e.jsx(Be,{className:"my-4"})]},m)),e.jsxs("div",{className:"bg-primary/10 p-4 rounded-lg border border-primary/20 mb-4",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Cash Redemption Examples"}),e.jsxs("div",{className:"text-xs text-muted-foreground grid grid-cols-1 sm:grid-cols-3 gap-2",children:[e.jsxs("div",{className:"flex flex-col p-2 bg-background/50 rounded",children:[e.jsx("span",{className:"font-medium",children:"10,000 tokens"}),e.jsx("span",{className:"text-primary font-medium",children:"$10.00"})]}),e.jsxs("div",{className:"flex flex-col p-2 bg-background/50 rounded",children:[e.jsx("span",{className:"font-medium",children:"20,000 tokens"}),e.jsx("span",{className:"text-primary font-medium",children:"$20.00"})]}),e.jsxs("div",{className:"flex flex-col p-2 bg-background/50 rounded",children:[e.jsx("span",{className:"font-medium",children:"50,000 tokens"}),e.jsx("span",{className:"text-primary font-medium",children:"$50.00"})]})]})]}),e.jsxs("div",{className:"bg-muted/40 p-4 rounded-lg mt-4",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Redemption Policy"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All redemption requests are reviewed for security purposes. Cash redemptions require identity verification for amounts over $50. Token values and conversion rates are subject to change. Any changes will be communicated at least 14 days in advance."})]})]})]})})]})}function Wt(){hs();const[s,r]=l.useState("redeem");return e.jsxs("div",{className:"container max-w-6xl py-6 space-y-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Token Redemption Center"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Convert your earned tokens into real-world value"})]}),e.jsx(E,{variant:"outline",asChild:!0,className:"w-full sm:w-auto",children:e.jsxs(Qs,{to:"/token-guide",className:"flex items-center",children:[e.jsx(_s,{className:"mr-2 h-4 w-4"}),"Token System Guide"]})})]}),e.jsx(Be,{}),e.jsxs(Oe,{defaultValue:s,onValueChange:r,className:"w-full",children:[e.jsxs(Ue,{className:"grid w-full max-w-md grid-cols-2",children:[e.jsx(G,{value:"redeem",children:"Redeem Tokens"}),e.jsx(G,{value:"info",children:"How It Works"})]}),e.jsx(W,{value:"redeem",className:"pt-6",children:e.jsx("div",{className:"grid grid-cols-1 gap-6",children:e.jsx($t,{})})}),e.jsx(W,{value:"info",className:"pt-6",children:e.jsx("div",{className:"grid grid-cols-1 gap-6",children:e.jsx(Dt,{})})})]})]})}export{Wt as default};
