import{c as Ne,bd as g,r as h,R as S,a as we,W as Ce,Y as Z,b as Y,l as me,t as he,j as e,C as ee,d as se,e as te,f as ae,g as ne,k as A,o as P,B as j,a0 as re,aJ as V,aQ as Se,aK as B,aL as Q,aM as $,aN as G,F as xe,w as N,x as w,v as C,y as D,I as k,D as F,z as pe,aO as J,N as Ae,V as I,b0 as Ie,b1 as Oe,b2 as Pe,ae as qe,b3 as ze,b9 as Le,a4 as De,a5 as Ee,a6 as q,bj as He,a7 as z,al as de,u as Ke,an as Ye}from"./index-FJB1i4HR.js";import{C as Ve}from"./checkbox-BJ8xQ86B.js";import{T as Be}from"./tag-Hu_DxxNU.js";import{S as Qe}from"./square-pen-DvGKPecP.js";import{T as $e}from"./trash-2-BI2eKKfZ.js";import{C as Ge}from"./circle-plus-DXq7ajXO.js";import{F as fe}from"./file-text-DIhTdHY3.js";import{D as We}from"./download-L8JcrHkQ.js";import{f as Ue}from"./format-unr8vqsB.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=Ne("ChartNoAxesColumn",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=Ne("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);function W(){return(W=Object.assign||function(s){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(s[r]=a[r])}return s}).apply(this,arguments)}function ke(s,t){if(s==null)return{};var a,r,o={},l=Object.keys(s);for(r=0;r<l.length;r++)t.indexOf(a=l[r])>=0||(o[a]=s[a]);return o}function oe(s){var t=h.useRef(s),a=h.useRef(function(r){t.current&&t.current(r)});return t.current=s,a.current}var H=function(s,t,a){return t===void 0&&(t=0),a===void 0&&(a=1),s>a?a:s<t?t:s},L=function(s){return"touches"in s},ie=function(s){return s&&s.ownerDocument.defaultView||self},ge=function(s,t,a){var r=s.getBoundingClientRect(),o=L(t)?function(l,c){for(var d=0;d<l.length;d++)if(l[d].identifier===c)return l[d];return l[0]}(t.touches,a):t;return{left:H((o.pageX-(r.left+ie(s).pageXOffset))/r.width),top:H((o.pageY-(r.top+ie(s).pageYOffset))/r.height)}},je=function(s){!L(s)&&s.preventDefault()},Fe=g.memo(function(s){var t=s.onMove,a=s.onKey,r=ke(s,["onMove","onKey"]),o=h.useRef(null),l=oe(t),c=oe(a),d=h.useRef(null),x=h.useRef(!1),m=h.useMemo(function(){var b=function(i){je(i),(L(i)?i.touches.length>0:i.buttons>0)&&o.current?l(ge(o.current,i,d.current)):y(!1)},M=function(){return y(!1)};function y(i){var u=x.current,p=ie(o.current),R=i?p.addEventListener:p.removeEventListener;R(u?"touchmove":"mousemove",b),R(u?"touchend":"mouseup",M)}return[function(i){var u=i.nativeEvent,p=o.current;if(p&&(je(u),!function(U,X){return X&&!L(U)}(u,x.current)&&p)){if(L(u)){x.current=!0;var R=u.changedTouches||[];R.length&&(d.current=R[0].identifier)}p.focus(),l(ge(p,u,d.current)),y(!0)}},function(i){var u=i.which||i.keyCode;u<37||u>40||(i.preventDefault(),c({left:u===39?.05:u===37?-.05:0,top:u===40?.05:u===38?-.05:0}))},y]},[c,l]),v=m[0],E=m[1],_=m[2];return h.useEffect(function(){return _},[_]),g.createElement("div",W({},r,{onTouchStart:v,onMouseDown:v,className:"react-colorful__interactive",ref:o,onKeyDown:E,tabIndex:0,role:"slider"}))}),ue=function(s){return s.filter(Boolean).join(" ")},_e=function(s){var t=s.color,a=s.left,r=s.top,o=r===void 0?.5:r,l=ue(["react-colorful__pointer",s.className]);return g.createElement("div",{className:l,style:{top:100*o+"%",left:100*a+"%"}},g.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:t}}))},f=function(s,t,a){return t===void 0&&(t=0),a===void 0&&(a=Math.pow(10,t)),Math.round(a*s)/a},Ze=function(s){return ns(le(s))},le=function(s){return s[0]==="#"&&(s=s.substring(1)),s.length<6?{r:parseInt(s[0]+s[0],16),g:parseInt(s[1]+s[1],16),b:parseInt(s[2]+s[2],16),a:s.length===4?f(parseInt(s[3]+s[3],16)/255,2):1}:{r:parseInt(s.substring(0,2),16),g:parseInt(s.substring(2,4),16),b:parseInt(s.substring(4,6),16),a:s.length===8?f(parseInt(s.substring(6,8),16)/255,2):1}},es=function(s){return as(ts(s))},ss=function(s){var t=s.s,a=s.v,r=s.a,o=(200-t)*a/100;return{h:f(s.h),s:f(o>0&&o<200?t*a/100/(o<=100?o:200-o)*100:0),l:f(o/2),a:f(r,2)}},ce=function(s){var t=ss(s);return"hsl("+t.h+", "+t.s+"%, "+t.l+"%)"},ts=function(s){var t=s.h,a=s.s,r=s.v,o=s.a;t=t/360*6,a/=100,r/=100;var l=Math.floor(t),c=r*(1-a),d=r*(1-(t-l)*a),x=r*(1-(1-t+l)*a),m=l%6;return{r:f(255*[r,d,c,c,x,r][m]),g:f(255*[x,r,r,d,c,c][m]),b:f(255*[c,c,x,r,r,d][m]),a:f(o,2)}},K=function(s){var t=s.toString(16);return t.length<2?"0"+t:t},as=function(s){var t=s.r,a=s.g,r=s.b,o=s.a,l=o<1?K(f(255*o)):"";return"#"+K(t)+K(a)+K(r)+l},ns=function(s){var t=s.r,a=s.g,r=s.b,o=s.a,l=Math.max(t,a,r),c=l-Math.min(t,a,r),d=c?l===t?(a-r)/c:l===a?2+(r-t)/c:4+(t-a)/c:0;return{h:f(60*(d<0?d+6:d)),s:f(l?c/l*100:0),v:f(l/255*100),a:o}},rs=g.memo(function(s){var t=s.hue,a=s.onChange,r=ue(["react-colorful__hue",s.className]);return g.createElement("div",{className:r},g.createElement(Fe,{onMove:function(o){a({h:360*o.left})},onKey:function(o){a({h:H(t+360*o.left,0,360)})},"aria-label":"Hue","aria-valuenow":f(t),"aria-valuemax":"360","aria-valuemin":"0"},g.createElement(_e,{className:"react-colorful__hue-pointer",left:t/360,color:ce({h:t,s:100,v:100,a:1})})))}),os=g.memo(function(s){var t=s.hsva,a=s.onChange,r={backgroundColor:ce({h:t.h,s:100,v:100,a:1})};return g.createElement("div",{className:"react-colorful__saturation",style:r},g.createElement(Fe,{onMove:function(o){a({s:100*o.left,v:100-100*o.top})},onKey:function(o){a({s:H(t.s+100*o.left,0,100),v:H(t.v-100*o.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+f(t.s)+"%, Brightness "+f(t.v)+"%"},g.createElement(_e,{className:"react-colorful__saturation-pointer",top:1-t.v/100,left:t.s/100,color:ce(t)})))}),Me=function(s,t){if(s===t)return!0;for(var a in s)if(s[a]!==t[a])return!1;return!0},is=function(s,t){return s.toLowerCase()===t.toLowerCase()||Me(le(s),le(t))};function ls(s,t,a){var r=oe(a),o=h.useState(function(){return s.toHsva(t)}),l=o[0],c=o[1],d=h.useRef({color:t,hsva:l});h.useEffect(function(){if(!s.equal(t,d.current.color)){var m=s.toHsva(t);d.current={hsva:m,color:t},c(m)}},[t,s]),h.useEffect(function(){var m;Me(l,d.current.hsva)||s.equal(m=s.fromHsva(l),d.current.color)||(d.current={hsva:l,color:m},r(m))},[l,s,r]);var x=h.useCallback(function(m){c(function(v){return Object.assign({},v,m)})},[]);return[l,x]}var cs=typeof window<"u"?h.useLayoutEffect:h.useEffect,ds=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:void 0},ve=new Map,us=function(s){cs(function(){var t=s.current?s.current.ownerDocument:document;if(t!==void 0&&!ve.has(t)){var a=t.createElement("style");a.innerHTML=`.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}`,ve.set(t,a);var r=ds();r&&a.setAttribute("nonce",r),t.head.appendChild(a)}},[])},ms=function(s){var t=s.className,a=s.colorModel,r=s.color,o=r===void 0?a.defaultColor:r,l=s.onChange,c=ke(s,["className","colorModel","color","onChange"]),d=h.useRef(null);us(d);var x=ls(a,o,l),m=x[0],v=x[1],E=ue(["react-colorful",t]);return g.createElement("div",W({},c,{ref:d,className:E}),g.createElement(os,{hsva:m,onChange:v}),g.createElement(rs,{hue:m.h,onChange:v,className:"react-colorful__last-control"}))},hs={defaultColor:"000",toHsva:Ze,fromHsva:function(s){return es({h:s.h,s:s.s,v:s.v,a:1})},equal:is},ye=function(s){return g.createElement(ms,W({},s,{colorModel:hs}))};const be=S.object({tagName:S.string().min(1,"Tag name is required").max(30,"Tag name must be less than 30 characters"),tagDescription:S.string().max(100,"Description must be less than 100 characters").optional(),baseEmotion:S.string().optional(),color:S.string().regex(/^#[0-9A-F]{6}$/i,"Must be a valid hex color"),icon:S.string().optional(),isActive:S.boolean().optional().default(!0)});function xs(){const{toast:s}=we(),t=Ce(),[a,r]=h.useState(null),[o,l]=h.useState(!1),[c,d]=h.useState(null),[x,m]=h.useState(!1),[v,E]=h.useState(!1),{data:_,isLoading:b}=Z({queryKey:["/api/custom-mood-tags"],queryFn:async()=>await(await I("GET","/api/custom-mood-tags")).json()}),M=Y({mutationFn:async n=>await(await I("POST","/api/custom-mood-tags",n)).json(),onSuccess:()=>{t.invalidateQueries({queryKey:["/api/custom-mood-tags"]}),s({title:"Tag Created",description:"Your new mood tag has been created successfully."}),m(!1)},onError:n=>{s({title:"Error",description:n.message||"Failed to create tag. Please try again.",variant:"destructive"})}}),y=Y({mutationFn:async({id:n,data:O})=>await(await I("PATCH",`/api/custom-mood-tags/${n}`,O)).json(),onSuccess:()=>{t.invalidateQueries({queryKey:["/api/custom-mood-tags"]}),s({title:"Tag Updated",description:"Your mood tag has been updated successfully."}),E(!1),r(null)},onError:n=>{s({title:"Error",description:n.message||"Failed to update tag. Please try again.",variant:"destructive"})}}),i=Y({mutationFn:async n=>{await I("DELETE",`/api/custom-mood-tags/${n}`)},onSuccess:()=>{t.invalidateQueries({queryKey:["/api/custom-mood-tags"]}),s({title:"Tag Deleted",description:"Your mood tag has been deleted successfully."}),l(!1),d(null)},onError:n=>{s({title:"Error",description:n.message||"Failed to delete tag. Please try again.",variant:"destructive"})}}),u=me({resolver:he(be),defaultValues:{tagName:"",tagDescription:"",baseEmotion:"",color:"#A6FF6F",icon:"😊",isActive:!0}}),p=me({resolver:he(be),defaultValues:{tagName:(a==null?void 0:a.tagName)||"",color:(a==null?void 0:a.color)||"#A6FF6F",icon:(a==null?void 0:a.icon)||"😊"}});h.useEffect(()=>{a&&p.reset({tagName:a.tagName,tagDescription:a.tagDescription||"",baseEmotion:a.baseEmotion||"",color:a.color,icon:a.icon||"😊",isActive:a.isActive??!0})},[a,p]);const R=n=>{M.mutate(n)},U=n=>{a&&y.mutate({id:a.id,data:n})},X=()=>{c&&i.mutate(c.id)},Te=n=>{r(n),p.reset({tagName:n.tagName,tagDescription:n.tagDescription,baseEmotion:n.baseEmotion,color:n.color,icon:n.icon||"😊",isActive:n.isActive??!0}),E(!0)},Re=n=>{d(n),l(!0)};return e.jsxs(ee,{className:"w-full",children:[e.jsxs(se,{children:[e.jsxs(te,{className:"flex items-center gap-2",children:[e.jsx(Be,{className:"h-5 w-5"}),"Custom Mood Tags"]}),e.jsx(ae,{children:"Create personalized tags to better express your unique emotional states"})]}),e.jsx(ne,{children:b?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(A,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):!_||_.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-muted-foreground",children:"You haven't created any custom mood tags yet."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Create your first tag to better track and express your emotions."})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2",children:_.map(n=>e.jsxs("div",{className:`flex items-center justify-between p-2 border rounded-md ${n.isActive?"":"opacity-60"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:n.icon||"😊"}),e.jsx(P,{style:{backgroundColor:n.color,color:ps(n.color)?"#000":"#fff"},className:"px-3 py-1",children:n.tagName}),n.baseEmotion&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Based on: ",n.baseEmotion]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>Te(n),children:e.jsx(Qe,{className:"h-4 w-4"})}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>Re(n),children:e.jsx($e,{className:"h-4 w-4"})})]})]},n.id))})}),e.jsx(re,{className:"flex justify-center",children:e.jsxs(V,{open:x,onOpenChange:m,children:[e.jsx(Se,{asChild:!0,children:e.jsxs(j,{className:"w-full sm:w-auto",children:[e.jsx(Ge,{className:"mr-2 h-4 w-4"}),"Create New Mood Tag"]})}),e.jsxs(B,{children:[e.jsxs(Q,{children:[e.jsx($,{children:"Create New Mood Tag"}),e.jsx(G,{children:"Add a custom mood tag to better express your emotional state"})]}),e.jsx(xe,{...u,children:e.jsxs("form",{onSubmit:u.handleSubmit(R),className:"space-y-4",children:[e.jsx(N,{control:u.control,name:"tagName",render:({field:n})=>e.jsxs(w,{children:[e.jsx(C,{children:"Tag Name"}),e.jsx(D,{children:e.jsx(k,{placeholder:"e.g., Energized, Contemplative, etc.",...n})}),e.jsx(F,{})]})}),e.jsx(N,{control:u.control,name:"tagDescription",render:({field:n})=>e.jsxs(w,{children:[e.jsx(C,{children:"Description"}),e.jsx(D,{children:e.jsx(k,{placeholder:"Describe what this mood feels like",...n,value:n.value||""})}),e.jsx(F,{})]})}),e.jsx(N,{control:u.control,name:"baseEmotion",render:({field:n})=>e.jsxs(w,{children:[e.jsx(C,{children:"Base Emotion (Optional)"}),e.jsx(D,{children:e.jsx(k,{placeholder:"e.g., Happy, Sad, etc.",...n,value:n.value||""})}),e.jsx(F,{})]})}),e.jsx(N,{control:u.control,name:"icon",render:({field:n})=>e.jsxs(w,{children:[e.jsx(C,{children:"Icon"}),e.jsx(D,{children:e.jsx(k,{placeholder:"Emoji (e.g., 😊, 😎)",...n,value:n.value||"😊"})}),e.jsx(F,{})]})}),e.jsx(N,{control:u.control,name:"color",render:({field:n})=>e.jsxs(w,{className:"space-y-2",children:[e.jsx(C,{children:"Tag Color"}),e.jsx(D,{children:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-md border",style:{backgroundColor:n.value}}),e.jsx(k,{value:n.value,onChange:O=>{const T=O.target.value;(/^#[0-9A-F]{0,6}$/i.test(T)||T==="#")&&n.onChange(T)},className:"font-mono"})]}),e.jsx(ye,{color:n.value,onChange:n.onChange})]})}),e.jsx(F,{})]})}),e.jsx(N,{control:u.control,name:"isActive",render:({field:n})=>e.jsxs(w,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[e.jsx(D,{children:e.jsx(Ve,{checked:n.value,onCheckedChange:n.onChange})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsx(C,{children:"Active"}),e.jsx(pe,{children:"Set whether this tag is currently active and available for use"})]})]})}),e.jsxs(J,{children:[e.jsx(j,{type:"button",variant:"outline",onClick:()=>m(!1),children:"Cancel"}),e.jsxs(j,{type:"submit",disabled:M.isPending,children:[M.isPending&&e.jsx(A,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Tag"]})]})]})})]})]})}),e.jsx(V,{open:v,onOpenChange:E,children:e.jsxs(B,{children:[e.jsxs(Q,{children:[e.jsx($,{children:"Edit Mood Tag"}),e.jsx(G,{children:"Update your custom mood tag"})]}),e.jsx(xe,{...p,children:e.jsxs("form",{onSubmit:p.handleSubmit(U),className:"space-y-4",children:[e.jsx(N,{control:p.control,name:"tagName",render:({field:n})=>e.jsxs(w,{children:[e.jsx(C,{children:"Tag Name"}),e.jsx(D,{children:e.jsx(k,{placeholder:"e.g., Energized, Contemplative, etc.",...n})}),e.jsx(F,{})]})}),e.jsx(N,{control:p.control,name:"tagDescription",render:({field:n})=>e.jsxs(w,{children:[e.jsx(C,{children:"Description"}),e.jsx(D,{children:e.jsx(k,{placeholder:"Describe what this mood feels like",...n,value:n.value||""})}),e.jsx(F,{})]})}),e.jsx(N,{control:p.control,name:"baseEmotion",render:({field:n})=>e.jsxs(w,{children:[e.jsx(C,{children:"Base Emotion (Optional)"}),e.jsx(D,{children:e.jsx(k,{placeholder:"e.g., Happy, Sad, etc.",...n,value:n.value||""})}),e.jsx(F,{})]})}),e.jsx(N,{control:p.control,name:"icon",render:({field:n})=>e.jsxs(w,{children:[e.jsx(C,{children:"Icon"}),e.jsx(D,{children:e.jsx(k,{placeholder:"Emoji (e.g., 😊, 😎)",...n,value:n.value||"😊"})}),e.jsx(F,{})]})}),e.jsx(N,{control:p.control,name:"color",render:({field:n})=>e.jsxs(w,{className:"space-y-2",children:[e.jsx(C,{children:"Tag Color"}),e.jsx(D,{children:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-md border",style:{backgroundColor:n.value}}),e.jsx(k,{value:n.value,onChange:O=>{const T=O.target.value;(/^#[0-9A-F]{0,6}$/i.test(T)||T==="#")&&n.onChange(T)},className:"font-mono"})]}),e.jsx(ye,{color:n.value,onChange:n.onChange})]})}),e.jsx(F,{})]})}),e.jsx(N,{control:p.control,name:"isActive",render:({field:n})=>e.jsxs(w,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(C,{children:"Active"}),e.jsx(pe,{children:"Tag will appear in mood selection if active"})]}),e.jsx(D,{children:e.jsx(Ae,{checked:n.value,onCheckedChange:n.onChange})})]})}),e.jsxs(J,{children:[e.jsx(j,{type:"button",variant:"outline",onClick:()=>E(!1),children:"Cancel"}),e.jsxs(j,{type:"submit",disabled:y.isPending,children:[y.isPending&&e.jsx(A,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Changes"]})]})]})})]})}),e.jsx(V,{open:o,onOpenChange:l,children:e.jsxs(B,{children:[e.jsxs(Q,{children:[e.jsx($,{children:"Confirm Deletion"}),e.jsxs(G,{children:['Are you sure you want to delete the tag "',c==null?void 0:c.tagName,'"? This action cannot be undone.']})]}),e.jsxs(J,{children:[e.jsx(j,{type:"button",variant:"outline",onClick:()=>l(!1),children:"Cancel"}),e.jsxs(j,{variant:"destructive",onClick:X,disabled:i.isPending,children:[i.isPending&&e.jsx(A,{className:"mr-2 h-4 w-4 animate-spin"}),"Delete Tag"]})]})]})})]})}function ps(s){const t=s.replace("#",""),a=parseInt(t.substring(0,2),16),r=parseInt(t.substring(2,4),16),o=parseInt(t.substring(4,6),16);return(a*299+r*587+o*114)/1e3>=128}function fs(){const{toast:s}=we(),t=Ce(),[a,r]=h.useState(null),[o,l]=h.useState(!1),{data:c,isLoading:d}=Z({queryKey:["/api/weekly-mood-reports"],queryFn:async()=>await(await I("GET","/api/weekly-mood-reports")).json()}),{data:x,isLoading:m}=Z({queryKey:["/api/weekly-mood-reports/latest"],queryFn:async()=>{try{const i=await I("GET","/api/weekly-mood-reports/latest");return i.status===404?null:await i.json()}catch{return null}}}),v=Y({mutationFn:async()=>await(await I("POST","/api/weekly-mood-reports/generate")).json(),onSuccess:()=>{t.invalidateQueries({queryKey:["/api/weekly-mood-reports"]}),t.invalidateQueries({queryKey:["/api/weekly-mood-reports/latest"]}),s({title:"Report Generated",description:"Your weekly mood report has been successfully generated."})},onError:i=>{s({title:"Error",description:i.message||"Failed to generate weekly report. Please try again.",variant:"destructive"})}}),E=()=>{v.mutate()},_=i=>{r(i),l(!0)},b=i=>Ue(new Date(i),"MMM d, yyyy"),M=i=>{s({title:"Report Download",description:`Report for ${b(i.startDate)} - ${b(i.endDate)} would be downloaded here.`})},y=i=>({happy:"#A6FF6F",sad:"#6F9CFF",angry:"#FF6F6F",anxious:"#FFCC6F",excited:"#FF6FE8",neutral:"#E0E0E0"})[i.toLowerCase()]||"#A6FF6F";return e.jsxs(ee,{className:"w-full",children:[e.jsxs(se,{children:[e.jsxs(te,{className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"h-5 w-5"}),"Weekly Mood Reports"]}),e.jsx(ae,{children:"View insights and trends from your emotional journey over time"})]}),e.jsx(ne,{children:d||m?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(A,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):!c||c.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-muted-foreground",children:"You don't have any weekly mood reports yet."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Generate your first report to gain insights into your emotional patterns."})]}):e.jsxs("div",{className:"space-y-4",children:[x&&e.jsxs(ee,{children:[e.jsxs(se,{className:"pb-2",children:[e.jsx(te,{className:"text-lg",children:"Your Latest Report"}),e.jsxs(ae,{children:[b(x.startDate)," - ",b(x.endDate)]})]}),e.jsx(ne,{className:"pb-2",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Average Mood:"}),e.jsx(P,{className:"ml-2",style:{backgroundColor:y(x.averageMood)},children:x.averageMood})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Summary:"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:x.moodSummary})]})]})}),e.jsx(re,{children:e.jsxs(j,{variant:"outline",className:"w-full",onClick:()=>_(x),children:[e.jsx(fe,{className:"mr-2 h-4 w-4"}),"View Full Report"]})})]}),e.jsx(Ie,{type:"single",collapsible:!0,className:"w-full",children:e.jsxs(Oe,{value:"reports",children:[e.jsx(Pe,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(qe,{className:"mr-2 h-4 w-4"}),"Previous Reports"]})}),e.jsx(ze,{children:c.length>0?e.jsx("div",{className:"space-y-2",children:c.map(i=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded-md",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:[b(i.startDate)," - ",b(i.endDate)]}),e.jsx(P,{className:"mt-1",style:{backgroundColor:y(i.averageMood)},children:i.averageMood})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>_(i),children:e.jsx(fe,{className:"h-4 w-4"})}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>M(i),children:e.jsx(We,{className:"h-4 w-4"})})]})]},i.id))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No previous reports found."})})]})})]})}),e.jsx(re,{className:"flex justify-center",children:e.jsxs(j,{className:"w-full sm:w-auto",onClick:E,disabled:v.isPending,children:[v.isPending?e.jsx(A,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(Le,{className:"mr-2 h-4 w-4"}),"Generate New Report"]})}),a&&e.jsx(V,{open:o,onOpenChange:l,children:e.jsxs(B,{className:"max-w-3xl",children:[e.jsxs(Q,{children:[e.jsx($,{children:"Weekly Mood Report"}),e.jsxs(G,{children:[b(a.startDate)," - ",b(a.endDate)]})]}),e.jsxs(De,{defaultValue:"overview",className:"w-full",children:[e.jsxs(Ee,{className:"w-full justify-start",children:[e.jsx(q,{value:"overview",children:"Overview"}),e.jsx(q,{value:"insights",children:"Insights"}),e.jsx(q,{value:"recommendations",children:"Recommendations"})]}),e.jsxs(He,{className:"max-h-[60vh]",children:[e.jsxs(z,{value:"overview",className:"pt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Mood Summary"}),e.jsx("p",{className:"text-sm mt-1",children:a.moodSummary})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Average Mood"}),e.jsx(P,{className:"mt-1",style:{backgroundColor:y(a.averageMood)},children:a.averageMood})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Mood Distribution"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 mt-1",children:Object.entries(a.moodDistribution).map(([i,u])=>e.jsxs("div",{className:"p-2 border rounded-md",children:[e.jsx(P,{style:{backgroundColor:y(i)},children:i}),e.jsxs("p",{className:"text-sm mt-1",children:[u," instances"]})]},i))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Mood Trends"}),e.jsx("p",{className:"text-sm mt-1",children:a.moodTrends})]})]}),e.jsx(z,{value:"insights",className:"pt-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Insights"}),e.jsx("p",{className:"text-sm mt-1",children:a.insights})]})}),e.jsx(z,{value:"recommendations",className:"pt-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Recommendations"}),e.jsx("p",{className:"text-sm mt-1",children:a.recommendations})]})})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(j,{variant:"outline",onClick:()=>M(a),children:[e.jsx(Je,{className:"mr-2 h-4 w-4"}),"Download Report"]})})]})})]})}function gs({className:s,children:t,...a}){return e.jsx("div",{className:de("space-y-2",s),...a,children:t})}function js({className:s,children:t,...a}){return e.jsx("h1",{className:de("text-3xl font-bold tracking-tight md:text-4xl",s),...a,children:t})}function vs({className:s,children:t,...a}){return e.jsx("p",{className:de("text-lg text-muted-foreground",s),...a,children:t})}function _s(){const{user:s,isLoading:t}=Ke();return t?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(A,{className:"h-8 w-8 animate-spin text-border"})}):s?e.jsxs("div",{className:"container mx-auto py-6 space-y-8",children:[e.jsxs(gs,{children:[e.jsx(js,{children:"Personalization & Insights"}),e.jsx(vs,{children:"Customize your experience and gain insights into your emotional journey"})]}),e.jsxs(De,{defaultValue:"personalization",className:"w-full",children:[e.jsxs(Ee,{className:"w-full justify-start mb-6",children:[e.jsx(q,{value:"personalization",children:"Personalization"}),e.jsx(q,{value:"insights",children:"Insights & Reports"})]}),e.jsx(z,{value:"personalization",className:"space-y-6",children:e.jsx(xs,{})}),e.jsx(z,{value:"insights",className:"space-y-6",children:e.jsx(fs,{})})]})]}):e.jsx(Ye,{to:"/auth"})}export{_s as default};
