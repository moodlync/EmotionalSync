import{aS as y,a as j,r as c,V as v,j as e,C as u,d,e as m,g as x,aP as w,a8 as b,a0 as N,B as P}from"./index-FJB1i4HR.js";function S(){const[g,h]=y(),{toast:s}=j(),[f,i]=c.useState(!0),[a,n]=c.useState(!1);c.useEffect(()=>{const l=new URL(window.location.href),r=l.searchParams.get("payment_intent"),o=l.searchParams.get("redirect_status");r&&o==="succeeded"?r.startsWith("sim_")?setTimeout(()=>{n(!0),s({title:"Subscription Activated!",description:"Welcome to MoodSync Premium! Your subscription is now active."}),i(!1)},1e3):v("POST","/api/payments/verify-payment",{paymentIntentId:r}).then(t=>{if(!t.ok)throw new Error("Payment verification failed");return t.json()}).then(t=>{n(!0),s({title:"Subscription Activated!",description:"Welcome to MoodSync Premium! Your subscription is now active."})}).catch(t=>{console.error("Verification error:",t),s({variant:"destructive",title:"Verification Failed",description:"There was a problem verifying your payment. Please contact support."})}).finally(()=>{i(!1)}):(o==="failed"&&s({variant:"destructive",title:"Payment Failed",description:"Your payment was not successful. Please try again."}),i(!1))},[s]);const p=()=>{h("/premium")};return f?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs(u,{className:"w-full max-w-md",children:[e.jsx(d,{className:"text-center",children:e.jsx(m,{children:"Processing Your Payment"})}),e.jsxs(x,{className:"flex flex-col items-center justify-center pb-6",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"}),e.jsx("p",{className:"mt-4 text-center text-gray-500",children:"Please wait while we confirm your payment and activate your subscription..."})]})]})}):e.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:e.jsxs(u,{className:"w-full max-w-md",children:[e.jsxs(d,{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:a?e.jsx(w,{className:"h-16 w-16 text-green-500"}):e.jsx(b,{className:"h-16 w-16 text-primary"})}),e.jsx(m,{className:"text-2xl",children:a?"Welcome to MoodSync Premium!":"Thank You"})]}),e.jsx(x,{className:"text-center space-y-4",children:a?e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"Your premium subscription has been successfully activated."}),e.jsx("p",{children:"You now have access to exclusive features including:"}),e.jsxs("ul",{className:"text-left list-disc pl-6 space-y-1",children:[e.jsx("li",{children:"Emotion NFTs collectibles"}),e.jsx("li",{children:"Premium mood backgrounds"}),e.jsx("li",{children:"Verified profile badge"}),e.jsx("li",{children:"Advanced analytics"}),e.jsx("li",{children:"Ad-free experience"})]})]}):e.jsx("p",{children:"We've received your request, but there may have been an issue with the payment processing. If your subscription doesn't activate within a few minutes, please contact support."})}),e.jsx(N,{className:"flex justify-center",children:e.jsx(P,{onClick:p,className:"w-full",children:a?"Continue to Premium Features":"Return to Home"})})]})})}export{S as default};
