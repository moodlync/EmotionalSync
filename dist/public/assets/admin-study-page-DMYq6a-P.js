import{a as D,r as j,b as p,j as e,B as f,aY as g,bX as N,a4 as L,a5 as F,a6 as b,aX as P,ad as B,a7 as y,C as r,d as n,e as i,f as l,g as c,ac as d,o as h,a0 as M,aw as G,aS as H,ab as O,bC as W,a8 as z,af as V,V as w}from"./index-BtgMuIOb.js";import{A as X}from"./admin-layout-Dk4BIZxj.js";import{R as C}from"./rotate-ccw-ggWisKeU.js";import{C as q}from"./chart-pie-CYwyV10P.js";import{L as K}from"./layers-DVXx07Um.js";import"./log-out-DvZviEwE.js";import"./quote-x5gkxPhQ.js";import"./database-CIRPvLLa.js";function ae(){const{toast:o}=D(),[S,v]=j.useState("study"),[a,T]=j.useState(null),[u,U]=j.useState(null),m=p({mutationFn:async()=>{const s=await w("POST","/api/admin/study/user-behavior");if(!s.ok)throw new Error("Failed to study user behavior");return await s.json()},onSuccess:s=>{T(s),o({title:"User behavior study completed",description:"The study results are ready for review."})},onError:s=>{o({title:"Study failed",description:s instanceof Error?s.message:"Failed to study user behavior",variant:"destructive"})}}),x=p({mutationFn:async()=>{const s=await w("POST","/api/admin/study/recommendations");if(!s.ok)throw new Error("Failed to generate recommendations");return await s.json()},onSuccess:s=>{U(s),v("recommendations"),o({title:"Recommendations generated",description:"AI-powered recommendations are ready for review."})},onError:s=>{o({title:"Recommendation generation failed",description:s instanceof Error?s.message:"Failed to generate recommendations",variant:"destructive"})}}),k=s=>{switch(s){case"HIGH":return"bg-red-500 hover:bg-red-600";case"MEDIUM":return"bg-orange-500 hover:bg-orange-600";case"LOW":return"bg-green-500 hover:bg-green-600";default:return"bg-gray-500 hover:bg-gray-600"}},R=s=>{switch(s){case"HIGH":return"bg-red-500 hover:bg-red-600";case"MEDIUM":return"bg-orange-500 hover:bg-orange-600";case"LOW":return"bg-green-500 hover:bg-green-600";default:return"bg-gray-500 hover:bg-gray-600"}},E=s=>{switch(s){case"User Experience":return e.jsx(V,{className:"h-5 w-5"});case"Feature Enhancement":return e.jsx(z,{className:"h-5 w-5"});case"Retention":return e.jsx(W,{className:"h-5 w-5"});case"Premium Conversion":return e.jsx(O,{className:"h-5 w-5"});case"Content Strategy":return e.jsx(K,{className:"h-5 w-5"});case"Community Engagement":return e.jsx(H,{className:"h-5 w-5"});case"Token Economy":return e.jsx(G,{className:"h-5 w-5"});case"User Interface":return e.jsx(q,{className:"h-5 w-5"});default:return e.jsx(g,{className:"h-5 w-5"})}};return e.jsx(X,{children:e.jsxs("div",{className:"mx-auto max-w-7xl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"User Behavior Study"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Analyze user behavior patterns and generate insights for platform improvement"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(f,{onClick:()=>m.mutate(),disabled:m.isPending,variant:"default",className:"gap-2",children:[m.isPending?e.jsx(C,{className:"h-4 w-4 animate-spin"}):e.jsx(g,{className:"h-4 w-4"}),m.isPending?"Analyzing...":"Study User Behavior"]}),e.jsxs(f,{onClick:()=>x.mutate(),disabled:x.isPending||!a,variant:"outline",className:"gap-2",children:[x.isPending?e.jsx(C,{className:"h-4 w-4 animate-spin"}):e.jsx(N,{className:"h-4 w-4"}),x.isPending?"Generating...":"Generate Recommendations"]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsxs(L,{value:S,onValueChange:v,className:"w-full",children:[e.jsxs(F,{className:"grid w-full grid-cols-2",children:[e.jsxs(b,{value:"study",className:"gap-2",children:[e.jsx(P,{className:"h-4 w-4"}),"Study Results"]}),e.jsxs(b,{value:"recommendations",disabled:!u,className:"gap-2",children:[e.jsx(B,{className:"h-4 w-4"}),"Recommendations"]})]}),e.jsx(y,{value:"study",className:"space-y-6 mt-6",children:a?e.jsxs(e.Fragment,{children:[e.jsxs(r,{children:[e.jsxs(n,{children:[e.jsx(i,{children:"User Overview"}),e.jsx(l,{children:"Key user statistics and metrics"})]}),e.jsx(c,{children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Total Users"}),e.jsx("div",{className:"text-2xl font-bold",children:a.overview.totalUsers.toLocaleString()})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Active Users (30d)"}),e.jsx("div",{className:"text-2xl font-bold",children:a.overview.activeUsers.toLocaleString()}),e.jsx("div",{className:"flex items-center text-sm text-muted-foreground",children:e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsxs("span",{children:[a.overview.activeUserRate.toFixed(1),"% of total"]}),e.jsxs("span",{children:[a.overview.activeUserRate.toFixed(1),"%"]})]}),e.jsx(d,{value:a.overview.activeUserRate})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Premium Users"}),e.jsx("div",{className:"text-2xl font-bold",children:a.overview.premiumUsers.toLocaleString()}),e.jsx("div",{className:"flex items-center text-sm text-muted-foreground",children:e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{children:"Conversion rate"}),e.jsxs("span",{children:[a.overview.premiumConversionRate.toFixed(1),"%"]})]}),e.jsx(d,{value:a.overview.premiumConversionRate,className:"bg-muted"})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Study ID"}),e.jsx("div",{className:"text-xl font-mono",children:a.studyId}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Generated ",new Date(a.timestamp).toLocaleDateString()]})]})]})})]}),e.jsxs(r,{children:[e.jsxs(n,{children:[e.jsx(i,{children:"Top Emotions"}),e.jsx(l,{children:"Most tracked emotions across the platform"})]}),e.jsx(c,{children:e.jsx("div",{className:"space-y-4",children:a.engagement.emotionDistribution.slice(0,5).map((s,t)=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"font-medium",children:s.emotion}),e.jsxs("div",{className:"text-muted-foreground",children:[s.count.toLocaleString()," logs"]})]}),e.jsx(d,{value:s.count/a.engagement.emotionDistribution[0].count*100,className:"h-2"})]},t))})})]}),e.jsxs(r,{children:[e.jsxs(n,{children:[e.jsx(i,{children:"Retention by Week"}),e.jsx(l,{children:"User retention rates over time"})]}),e.jsx(c,{children:e.jsx("div",{className:"grid gap-6 grid-cols-8",children:a.trends.retentionByWeek.map((s,t)=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"font-medium mb-2",children:["Week ",s.week]}),e.jsx("div",{className:"h-32 w-6 bg-muted rounded-t-md relative",children:e.jsx("div",{className:"absolute bottom-0 w-full bg-primary rounded-t-md",style:{height:`${s.rate}%`}})}),e.jsxs("div",{className:"mt-2 text-sm text-muted-foreground",children:[s.rate,"%"]})]},t))})})]}),e.jsxs(r,{children:[e.jsxs(n,{children:[e.jsx(i,{children:"Token Economy"}),e.jsx(l,{children:"Token generation distribution by activity"})]}),e.jsx(c,{children:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-4",children:"Activity Counts"}),e.jsx("div",{className:"space-y-4",children:a.engagement.tokenTransactions.map((s,t)=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"font-medium",children:s.type}),e.jsx("div",{className:"text-muted-foreground",children:s.count.toLocaleString()})]}),e.jsx(d,{value:s.count/a.engagement.tokenTransactions[0].count*100,className:"h-2"})]},t))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-4",children:"Token Distribution"}),e.jsx("div",{className:"space-y-4",children:a.engagement.tokenTransactions.map((s,t)=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"font-medium",children:s.type}),e.jsx("div",{className:"text-muted-foreground",children:s.tokens.toLocaleString()})]}),e.jsx(d,{value:s.tokens/a.engagement.tokenTransactions[0].tokens*100,className:"h-2"})]},t))})]})]})})})]})]}):e.jsxs(r,{children:[e.jsxs(n,{children:[e.jsx(i,{children:"User Behavior Study"}),e.jsx(l,{children:"Study user behavior patterns to improve platform experience"})]}),e.jsx(c,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(g,{className:"h-16 w-16 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Study Data Available"}),e.jsx("p",{className:"text-muted-foreground max-w-md",children:"Start a new user behavior study to analyze platform usage patterns, emotion trends, token economy, and user engagement metrics."})]})})]})}),e.jsx(y,{value:"recommendations",className:"mt-6",children:u?e.jsx("div",{className:"grid gap-6 md:grid-cols-2",children:u.recommendations.map((s,t)=>e.jsxs(r,{children:[e.jsxs(n,{className:"pb-3",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsxs(h,{variant:"outline",className:"px-2 py-1",children:[E(s.category),e.jsx("span",{className:"ml-1",children:s.category})]})}),e.jsx(i,{children:s.title})]}),e.jsxs(c,{children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:s.description}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2 mb-4",children:s.metrics.map((I,A)=>e.jsx(h,{variant:"outline",children:I},A))})]}),e.jsxs(M,{className:"flex justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Impact:"}),e.jsx(h,{className:k(s.impact),children:s.impact})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Implementation:"}),e.jsx(h,{className:R(s.implementation),children:s.implementation})]})]})]},t))}):e.jsxs(r,{children:[e.jsxs(n,{children:[e.jsx(i,{children:"AI Recommendations"}),e.jsx(l,{children:"AI-generated recommendations based on user behavior analysis"})]}),e.jsx(c,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(N,{className:"h-16 w-16 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Recommendations Available"}),e.jsx("p",{className:"text-muted-foreground max-w-md",children:"Run a user behavior study first, then generate AI recommendations to improve platform engagement and user satisfaction."})]})})]})})]})})]})})}export{ae as default};
