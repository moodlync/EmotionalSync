import{c as Ne,ba as f,r as h,aE as S,a as we,m as Ce,n as J,b as B,ak as me,aF as he,j as e,C as ee,d as se,e as ae,f as te,g as ne,k as A,w as P,B as j,s as re,ax as V,aG as Se,ay as Y,az as $,aA as G,aB as Q,al as xe,am as N,an as w,ao as C,at as D,I as k,as as F,au as pe,aC as Z,bB as Ae,t as I,aU as Ie,aV as Oe,aW as Pe,O as qe,aX as ze,b6 as Le,y as De,z as Ee,D as q,bg as He,F as z,W as de,u as Ke,a1 as Be}from"./index-CriQqr38.js";import{C as Ve}from"./checkbox-BDSpJ839.js";import{T as Ye}from"./tag-CfgjH-KB.js";import{S as $e}from"./square-pen-DUcQ0uPy.js";import{T as Ge}from"./trash-2-D2kKAsUM.js";import{C as Qe}from"./circle-plus-BfB74KfW.js";import{F as ge}from"./file-text-VNfiAMIx.js";import{D as We}from"./download-BKBF8NHx.js";import{f as Ue}from"./format-CBU6Gxcb.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=Ne("ChartNoAxesColumn",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=Ne("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);function W(){return(W=Object.assign||function(s){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(s[r]=t[r])}return s}).apply(this,arguments)}function ke(s,a){if(s==null)return{};var t,r,o={},l=Object.keys(s);for(r=0;r<l.length;r++)a.indexOf(t=l[r])>=0||(o[t]=s[t]);return o}function oe(s){var a=h.useRef(s),t=h.useRef(function(r){a.current&&a.current(r)});return a.current=s,t.current}var H=function(s,a,t){return a===void 0&&(a=0),t===void 0&&(t=1),s>t?t:s<a?a:s},L=function(s){return"touches"in s},ie=function(s){return s&&s.ownerDocument.defaultView||self},fe=function(s,a,t){var r=s.getBoundingClientRect(),o=L(a)?function(l,c){for(var d=0;d<l.length;d++)if(l[d].identifier===c)return l[d];return l[0]}(a.touches,t):a;return{left:H((o.pageX-(r.left+ie(s).pageXOffset))/r.width),top:H((o.pageY-(r.top+ie(s).pageYOffset))/r.height)}},je=function(s){!L(s)&&s.preventDefault()},Fe=f.memo(function(s){var a=s.onMove,t=s.onKey,r=ke(s,["onMove","onKey"]),o=h.useRef(null),l=oe(a),c=oe(t),d=h.useRef(null),x=h.useRef(!1),m=h.useMemo(function(){var b=function(i){je(i),(L(i)?i.touches.length>0:i.buttons>0)&&o.current?l(fe(o.current,i,d.current)):y(!1)},M=function(){return y(!1)};function y(i){var u=x.current,p=ie(o.current),R=i?p.addEventListener:p.removeEventListener;R(u?"touchmove":"mousemove",b),R(u?"touchend":"mouseup",M)}return[function(i){var u=i.nativeEvent,p=o.current;if(p&&(je(u),!function(U,X){return X&&!L(U)}(u,x.current)&&p)){if(L(u)){x.current=!0;var R=u.changedTouches||[];R.length&&(d.current=R[0].identifier)}p.focus(),l(fe(p,u,d.current)),y(!0)}},function(i){var u=i.which||i.keyCode;u<37||u>40||(i.preventDefault(),c({left:u===39?.05:u===37?-.05:0,top:u===40?.05:u===38?-.05:0}))},y]},[c,l]),v=m[0],E=m[1],_=m[2];return h.useEffect(function(){return _},[_]),f.createElement("div",W({},r,{onTouchStart:v,onMouseDown:v,className:"react-colorful__interactive",ref:o,onKeyDown:E,tabIndex:0,role:"slider"}))}),ue=function(s){return s.filter(Boolean).join(" ")},_e=function(s){var a=s.color,t=s.left,r=s.top,o=r===void 0?.5:r,l=ue(["react-colorful__pointer",s.className]);return f.createElement("div",{className:l,style:{top:100*o+"%",left:100*t+"%"}},f.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:a}}))},g=function(s,a,t){return a===void 0&&(a=0),t===void 0&&(t=Math.pow(10,a)),Math.round(t*s)/t},Je=function(s){return ns(le(s))},le=function(s){return s[0]==="#"&&(s=s.substring(1)),s.length<6?{r:parseInt(s[0]+s[0],16),g:parseInt(s[1]+s[1],16),b:parseInt(s[2]+s[2],16),a:s.length===4?g(parseInt(s[3]+s[3],16)/255,2):1}:{r:parseInt(s.substring(0,2),16),g:parseInt(s.substring(2,4),16),b:parseInt(s.substring(4,6),16),a:s.length===8?g(parseInt(s.substring(6,8),16)/255,2):1}},es=function(s){return ts(as(s))},ss=function(s){var a=s.s,t=s.v,r=s.a,o=(200-a)*t/100;return{h:g(s.h),s:g(o>0&&o<200?a*t/100/(o<=100?o:200-o)*100:0),l:g(o/2),a:g(r,2)}},ce=function(s){var a=ss(s);return"hsl("+a.h+", "+a.s+"%, "+a.l+"%)"},as=function(s){var a=s.h,t=s.s,r=s.v,o=s.a;a=a/360*6,t/=100,r/=100;var l=Math.floor(a),c=r*(1-t),d=r*(1-(a-l)*t),x=r*(1-(1-a+l)*t),m=l%6;return{r:g(255*[r,d,c,c,x,r][m]),g:g(255*[x,r,r,d,c,c][m]),b:g(255*[c,c,x,r,r,d][m]),a:g(o,2)}},K=function(s){var a=s.toString(16);return a.length<2?"0"+a:a},ts=function(s){var a=s.r,t=s.g,r=s.b,o=s.a,l=o<1?K(g(255*o)):"";return"#"+K(a)+K(t)+K(r)+l},ns=function(s){var a=s.r,t=s.g,r=s.b,o=s.a,l=Math.max(a,t,r),c=l-Math.min(a,t,r),d=c?l===a?(t-r)/c:l===t?2+(r-a)/c:4+(a-t)/c:0;return{h:g(60*(d<0?d+6:d)),s:g(l?c/l*100:0),v:g(l/255*100),a:o}},rs=f.memo(function(s){var a=s.hue,t=s.onChange,r=ue(["react-colorful__hue",s.className]);return f.createElement("div",{className:r},f.createElement(Fe,{onMove:function(o){t({h:360*o.left})},onKey:function(o){t({h:H(a+360*o.left,0,360)})},"aria-label":"Hue","aria-valuenow":g(a),"aria-valuemax":"360","aria-valuemin":"0"},f.createElement(_e,{className:"react-colorful__hue-pointer",left:a/360,color:ce({h:a,s:100,v:100,a:1})})))}),os=f.memo(function(s){var a=s.hsva,t=s.onChange,r={backgroundColor:ce({h:a.h,s:100,v:100,a:1})};return f.createElement("div",{className:"react-colorful__saturation",style:r},f.createElement(Fe,{onMove:function(o){t({s:100*o.left,v:100-100*o.top})},onKey:function(o){t({s:H(a.s+100*o.left,0,100),v:H(a.v-100*o.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+g(a.s)+"%, Brightness "+g(a.v)+"%"},f.createElement(_e,{className:"react-colorful__saturation-pointer",top:1-a.v/100,left:a.s/100,color:ce(a)})))}),Me=function(s,a){if(s===a)return!0;for(var t in s)if(s[t]!==a[t])return!1;return!0},is=function(s,a){return s.toLowerCase()===a.toLowerCase()||Me(le(s),le(a))};function ls(s,a,t){var r=oe(t),o=h.useState(function(){return s.toHsva(a)}),l=o[0],c=o[1],d=h.useRef({color:a,hsva:l});h.useEffect(function(){if(!s.equal(a,d.current.color)){var m=s.toHsva(a);d.current={hsva:m,color:a},c(m)}},[a,s]),h.useEffect(function(){var m;Me(l,d.current.hsva)||s.equal(m=s.fromHsva(l),d.current.color)||(d.current={hsva:l,color:m},r(m))},[l,s,r]);var x=h.useCallback(function(m){c(function(v){return Object.assign({},v,m)})},[]);return[l,x]}var cs=typeof window<"u"?h.useLayoutEffect:h.useEffect,ds=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:void 0},ve=new Map,us=function(s){cs(function(){var a=s.current?s.current.ownerDocument:document;if(a!==void 0&&!ve.has(a)){var t=a.createElement("style");t.innerHTML=`.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}`,ve.set(a,t);var r=ds();r&&t.setAttribute("nonce",r),a.head.appendChild(t)}},[])},ms=function(s){var a=s.className,t=s.colorModel,r=s.color,o=r===void 0?t.defaultColor:r,l=s.onChange,c=ke(s,["className","colorModel","color","onChange"]),d=h.useRef(null);us(d);var x=ls(t,o,l),m=x[0],v=x[1],E=ue(["react-colorful",a]);return f.createElement("div",W({},c,{ref:d,className:E}),f.createElement(os,{hsva:m,onChange:v}),f.createElement(rs,{hue:m.h,onChange:v,className:"react-colorful__last-control"}))},hs={defaultColor:"000",toHsva:Je,fromHsva:function(s){return es({h:s.h,s:s.s,v:s.v,a:1})},equal:is},ye=function(s){return f.createElement(ms,W({},s,{colorModel:hs}))};const be=S.object({tagName:S.string().min(1,"Tag name is required").max(30,"Tag name must be less than 30 characters"),tagDescription:S.string().max(100,"Description must be less than 100 characters").optional(),baseEmotion:S.string().optional(),color:S.string().regex(/^#[0-9A-F]{6}$/i,"Must be a valid hex color"),icon:S.string().optional(),isActive:S.boolean().optional().default(!0)});function xs(){const{toast:s}=we(),a=Ce(),[t,r]=h.useState(null),[o,l]=h.useState(!1),[c,d]=h.useState(null),[x,m]=h.useState(!1),[v,E]=h.useState(!1),{data:_,isLoading:b}=J({queryKey:["/api/custom-mood-tags"],queryFn:async()=>await(await I("GET","/api/custom-mood-tags")).json()}),M=B({mutationFn:async n=>await(await I("POST","/api/custom-mood-tags",n)).json(),onSuccess:()=>{a.invalidateQueries({queryKey:["/api/custom-mood-tags"]}),s({title:"Tag Created",description:"Your new mood tag has been created successfully."}),m(!1)},onError:n=>{s({title:"Error",description:n.message||"Failed to create tag. Please try again.",variant:"destructive"})}}),y=B({mutationFn:async({id:n,data:O})=>await(await I("PATCH",`/api/custom-mood-tags/${n}`,O)).json(),onSuccess:()=>{a.invalidateQueries({queryKey:["/api/custom-mood-tags"]}),s({title:"Tag Updated",description:"Your mood tag has been updated successfully."}),E(!1),r(null)},onError:n=>{s({title:"Error",description:n.message||"Failed to update tag. Please try again.",variant:"destructive"})}}),i=B({mutationFn:async n=>{await I("DELETE",`/api/custom-mood-tags/${n}`)},onSuccess:()=>{a.invalidateQueries({queryKey:["/api/custom-mood-tags"]}),s({title:"Tag Deleted",description:"Your mood tag has been deleted successfully."}),l(!1),d(null)},onError:n=>{s({title:"Error",description:n.message||"Failed to delete tag. Please try again.",variant:"destructive"})}}),u=me({resolver:he(be),defaultValues:{tagName:"",tagDescription:"",baseEmotion:"",color:"#A6FF6F",icon:"😊",isActive:!0}}),p=me({resolver:he(be),defaultValues:{tagName:(t==null?void 0:t.tagName)||"",color:(t==null?void 0:t.color)||"#A6FF6F",icon:(t==null?void 0:t.icon)||"😊"}});h.useEffect(()=>{t&&p.reset({tagName:t.tagName,tagDescription:t.tagDescription||"",baseEmotion:t.baseEmotion||"",color:t.color,icon:t.icon||"😊",isActive:t.isActive??!0})},[t,p]);const R=n=>{M.mutate(n)},U=n=>{t&&y.mutate({id:t.id,data:n})},X=()=>{c&&i.mutate(c.id)},Te=n=>{r(n),p.reset({tagName:n.tagName,tagDescription:n.tagDescription,baseEmotion:n.baseEmotion,color:n.color,icon:n.icon||"😊",isActive:n.isActive??!0}),E(!0)},Re=n=>{d(n),l(!0)};return e.jsxs(ee,{className:"w-full",children:[e.jsxs(se,{children:[e.jsxs(ae,{className:"flex items-center gap-2",children:[e.jsx(Ye,{className:"h-5 w-5"}),"Custom Mood Tags"]}),e.jsx(te,{children:"Create personalized tags to better express your unique emotional states"})]}),e.jsx(ne,{children:b?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(A,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):!_||_.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-muted-foreground",children:"You haven't created any custom mood tags yet."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Create your first tag to better track and express your emotions."})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2",children:_.map(n=>e.jsxs("div",{className:`flex items-center justify-between p-2 border rounded-md ${n.isActive?"":"opacity-60"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:n.icon||"😊"}),e.jsx(P,{style:{backgroundColor:n.color,color:ps(n.color)?"#000":"#fff"},className:"px-3 py-1",children:n.tagName}),n.baseEmotion&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Based on: ",n.baseEmotion]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>Te(n),children:e.jsx($e,{className:"h-4 w-4"})}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>Re(n),children:e.jsx(Ge,{className:"h-4 w-4"})})]})]},n.id))})}),e.jsx(re,{className:"flex justify-center",children:e.jsxs(V,{open:x,onOpenChange:m,children:[e.jsx(Se,{asChild:!0,children:e.jsxs(j,{className:"w-full sm:w-auto",children:[e.jsx(Qe,{className:"mr-2 h-4 w-4"}),"Create New Mood Tag"]})}),e.jsxs(Y,{children:[e.jsxs($,{children:[e.jsx(G,{children:"Create New Mood Tag"}),e.jsx(Q,{children:"Add a custom mood tag to better express your emotional state"})]}),e.jsx(xe,{...u,children:e.jsxs("form",{onSubmit:u.handleSubmit(R),className:"space-y-4",children:[e.jsx(N,{control:u.control,name:"tagName",render:({field:n})=>e.jsxs(w,{children:[e.jsx(C,{children:"Tag Name"}),e.jsx(D,{children:e.jsx(k,{placeholder:"e.g., Energized, Contemplative, etc.",...n})}),e.jsx(F,{})]})}),e.jsx(N,{control:u.control,name:"tagDescription",render:({field:n})=>e.jsxs(w,{children:[e.jsx(C,{children:"Description"}),e.jsx(D,{children:e.jsx(k,{placeholder:"Describe what this mood feels like",...n,value:n.value||""})}),e.jsx(F,{})]})}),e.jsx(N,{control:u.control,name:"baseEmotion",render:({field:n})=>e.jsxs(w,{children:[e.jsx(C,{children:"Base Emotion (Optional)"}),e.jsx(D,{children:e.jsx(k,{placeholder:"e.g., Happy, Sad, etc.",...n,value:n.value||""})}),e.jsx(F,{})]})}),e.jsx(N,{control:u.control,name:"icon",render:({field:n})=>e.jsxs(w,{children:[e.jsx(C,{children:"Icon"}),e.jsx(D,{children:e.jsx(k,{placeholder:"Emoji (e.g., 😊, 😎)",...n,value:n.value||"😊"})}),e.jsx(F,{})]})}),e.jsx(N,{control:u.control,name:"color",render:({field:n})=>e.jsxs(w,{className:"space-y-2",children:[e.jsx(C,{children:"Tag Color"}),e.jsx(D,{children:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-md border",style:{backgroundColor:n.value}}),e.jsx(k,{value:n.value,onChange:O=>{const T=O.target.value;(/^#[0-9A-F]{0,6}$/i.test(T)||T==="#")&&n.onChange(T)},className:"font-mono"})]}),e.jsx(ye,{color:n.value,onChange:n.onChange})]})}),e.jsx(F,{})]})}),e.jsx(N,{control:u.control,name:"isActive",render:({field:n})=>e.jsxs(w,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[e.jsx(D,{children:e.jsx(Ve,{checked:n.value,onCheckedChange:n.onChange})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsx(C,{children:"Active"}),e.jsx(pe,{children:"Set whether this tag is currently active and available for use"})]})]})}),e.jsxs(Z,{children:[e.jsx(j,{type:"button",variant:"outline",onClick:()=>m(!1),children:"Cancel"}),e.jsxs(j,{type:"submit",disabled:M.isPending,children:[M.isPending&&e.jsx(A,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Tag"]})]})]})})]})]})}),e.jsx(V,{open:v,onOpenChange:E,children:e.jsxs(Y,{children:[e.jsxs($,{children:[e.jsx(G,{children:"Edit Mood Tag"}),e.jsx(Q,{children:"Update your custom mood tag"})]}),e.jsx(xe,{...p,children:e.jsxs("form",{onSubmit:p.handleSubmit(U),className:"space-y-4",children:[e.jsx(N,{control:p.control,name:"tagName",render:({field:n})=>e.jsxs(w,{children:[e.jsx(C,{children:"Tag Name"}),e.jsx(D,{children:e.jsx(k,{placeholder:"e.g., Energized, Contemplative, etc.",...n})}),e.jsx(F,{})]})}),e.jsx(N,{control:p.control,name:"tagDescription",render:({field:n})=>e.jsxs(w,{children:[e.jsx(C,{children:"Description"}),e.jsx(D,{children:e.jsx(k,{placeholder:"Describe what this mood feels like",...n,value:n.value||""})}),e.jsx(F,{})]})}),e.jsx(N,{control:p.control,name:"baseEmotion",render:({field:n})=>e.jsxs(w,{children:[e.jsx(C,{children:"Base Emotion (Optional)"}),e.jsx(D,{children:e.jsx(k,{placeholder:"e.g., Happy, Sad, etc.",...n,value:n.value||""})}),e.jsx(F,{})]})}),e.jsx(N,{control:p.control,name:"icon",render:({field:n})=>e.jsxs(w,{children:[e.jsx(C,{children:"Icon"}),e.jsx(D,{children:e.jsx(k,{placeholder:"Emoji (e.g., 😊, 😎)",...n,value:n.value||"😊"})}),e.jsx(F,{})]})}),e.jsx(N,{control:p.control,name:"color",render:({field:n})=>e.jsxs(w,{className:"space-y-2",children:[e.jsx(C,{children:"Tag Color"}),e.jsx(D,{children:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-md border",style:{backgroundColor:n.value}}),e.jsx(k,{value:n.value,onChange:O=>{const T=O.target.value;(/^#[0-9A-F]{0,6}$/i.test(T)||T==="#")&&n.onChange(T)},className:"font-mono"})]}),e.jsx(ye,{color:n.value,onChange:n.onChange})]})}),e.jsx(F,{})]})}),e.jsx(N,{control:p.control,name:"isActive",render:({field:n})=>e.jsxs(w,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(C,{children:"Active"}),e.jsx(pe,{children:"Tag will appear in mood selection if active"})]}),e.jsx(D,{children:e.jsx(Ae,{checked:n.value,onCheckedChange:n.onChange})})]})}),e.jsxs(Z,{children:[e.jsx(j,{type:"button",variant:"outline",onClick:()=>E(!1),children:"Cancel"}),e.jsxs(j,{type:"submit",disabled:y.isPending,children:[y.isPending&&e.jsx(A,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Changes"]})]})]})})]})}),e.jsx(V,{open:o,onOpenChange:l,children:e.jsxs(Y,{children:[e.jsxs($,{children:[e.jsx(G,{children:"Confirm Deletion"}),e.jsxs(Q,{children:['Are you sure you want to delete the tag "',c==null?void 0:c.tagName,'"? This action cannot be undone.']})]}),e.jsxs(Z,{children:[e.jsx(j,{type:"button",variant:"outline",onClick:()=>l(!1),children:"Cancel"}),e.jsxs(j,{variant:"destructive",onClick:X,disabled:i.isPending,children:[i.isPending&&e.jsx(A,{className:"mr-2 h-4 w-4 animate-spin"}),"Delete Tag"]})]})]})})]})}function ps(s){const a=s.replace("#",""),t=parseInt(a.substring(0,2),16),r=parseInt(a.substring(2,4),16),o=parseInt(a.substring(4,6),16);return(t*299+r*587+o*114)/1e3>=128}function gs(){const{toast:s}=we(),a=Ce(),[t,r]=h.useState(null),[o,l]=h.useState(!1),{data:c,isLoading:d}=J({queryKey:["/api/weekly-mood-reports"],queryFn:async()=>await(await I("GET","/api/weekly-mood-reports")).json()}),{data:x,isLoading:m}=J({queryKey:["/api/weekly-mood-reports/latest"],queryFn:async()=>{try{const i=await I("GET","/api/weekly-mood-reports/latest");return i.status===404?null:await i.json()}catch{return null}}}),v=B({mutationFn:async()=>await(await I("POST","/api/weekly-mood-reports/generate")).json(),onSuccess:()=>{a.invalidateQueries({queryKey:["/api/weekly-mood-reports"]}),a.invalidateQueries({queryKey:["/api/weekly-mood-reports/latest"]}),s({title:"Report Generated",description:"Your weekly mood report has been successfully generated."})},onError:i=>{s({title:"Error",description:i.message||"Failed to generate weekly report. Please try again.",variant:"destructive"})}}),E=()=>{v.mutate()},_=i=>{r(i),l(!0)},b=i=>Ue(new Date(i),"MMM d, yyyy"),M=i=>{s({title:"Report Download",description:`Report for ${b(i.startDate)} - ${b(i.endDate)} would be downloaded here.`})},y=i=>({happy:"#A6FF6F",sad:"#6F9CFF",angry:"#FF6F6F",anxious:"#FFCC6F",excited:"#FF6FE8",neutral:"#E0E0E0"})[i.toLowerCase()]||"#A6FF6F";return e.jsxs(ee,{className:"w-full",children:[e.jsxs(se,{children:[e.jsxs(ae,{className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"h-5 w-5"}),"Weekly Mood Reports"]}),e.jsx(te,{children:"View insights and trends from your emotional journey over time"})]}),e.jsx(ne,{children:d||m?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(A,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):!c||c.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-muted-foreground",children:"You don't have any weekly mood reports yet."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Generate your first report to gain insights into your emotional patterns."})]}):e.jsxs("div",{className:"space-y-4",children:[x&&e.jsxs(ee,{children:[e.jsxs(se,{className:"pb-2",children:[e.jsx(ae,{className:"text-lg",children:"Your Latest Report"}),e.jsxs(te,{children:[b(x.startDate)," - ",b(x.endDate)]})]}),e.jsx(ne,{className:"pb-2",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Average Mood:"}),e.jsx(P,{className:"ml-2",style:{backgroundColor:y(x.averageMood)},children:x.averageMood})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Summary:"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:x.moodSummary})]})]})}),e.jsx(re,{children:e.jsxs(j,{variant:"outline",className:"w-full",onClick:()=>_(x),children:[e.jsx(ge,{className:"mr-2 h-4 w-4"}),"View Full Report"]})})]}),e.jsx(Ie,{type:"single",collapsible:!0,className:"w-full",children:e.jsxs(Oe,{value:"reports",children:[e.jsx(Pe,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(qe,{className:"mr-2 h-4 w-4"}),"Previous Reports"]})}),e.jsx(ze,{children:c.length>0?e.jsx("div",{className:"space-y-2",children:c.map(i=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded-md",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:[b(i.startDate)," - ",b(i.endDate)]}),e.jsx(P,{className:"mt-1",style:{backgroundColor:y(i.averageMood)},children:i.averageMood})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>_(i),children:e.jsx(ge,{className:"h-4 w-4"})}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>M(i),children:e.jsx(We,{className:"h-4 w-4"})})]})]},i.id))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No previous reports found."})})]})})]})}),e.jsx(re,{className:"flex justify-center",children:e.jsxs(j,{className:"w-full sm:w-auto",onClick:E,disabled:v.isPending,children:[v.isPending?e.jsx(A,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(Le,{className:"mr-2 h-4 w-4"}),"Generate New Report"]})}),t&&e.jsx(V,{open:o,onOpenChange:l,children:e.jsxs(Y,{className:"max-w-3xl",children:[e.jsxs($,{children:[e.jsx(G,{children:"Weekly Mood Report"}),e.jsxs(Q,{children:[b(t.startDate)," - ",b(t.endDate)]})]}),e.jsxs(De,{defaultValue:"overview",className:"w-full",children:[e.jsxs(Ee,{className:"w-full justify-start",children:[e.jsx(q,{value:"overview",children:"Overview"}),e.jsx(q,{value:"insights",children:"Insights"}),e.jsx(q,{value:"recommendations",children:"Recommendations"})]}),e.jsxs(He,{className:"max-h-[60vh]",children:[e.jsxs(z,{value:"overview",className:"pt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Mood Summary"}),e.jsx("p",{className:"text-sm mt-1",children:t.moodSummary})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Average Mood"}),e.jsx(P,{className:"mt-1",style:{backgroundColor:y(t.averageMood)},children:t.averageMood})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Mood Distribution"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 mt-1",children:Object.entries(t.moodDistribution).map(([i,u])=>e.jsxs("div",{className:"p-2 border rounded-md",children:[e.jsx(P,{style:{backgroundColor:y(i)},children:i}),e.jsxs("p",{className:"text-sm mt-1",children:[u," instances"]})]},i))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Mood Trends"}),e.jsx("p",{className:"text-sm mt-1",children:t.moodTrends})]})]}),e.jsx(z,{value:"insights",className:"pt-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Insights"}),e.jsx("p",{className:"text-sm mt-1",children:t.insights})]})}),e.jsx(z,{value:"recommendations",className:"pt-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Recommendations"}),e.jsx("p",{className:"text-sm mt-1",children:t.recommendations})]})})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(j,{variant:"outline",onClick:()=>M(t),children:[e.jsx(Ze,{className:"mr-2 h-4 w-4"}),"Download Report"]})})]})})]})}function fs({className:s,children:a,...t}){return e.jsx("div",{className:de("space-y-2",s),...t,children:a})}function js({className:s,children:a,...t}){return e.jsx("h1",{className:de("text-3xl font-bold tracking-tight md:text-4xl",s),...t,children:a})}function vs({className:s,children:a,...t}){return e.jsx("p",{className:de("text-lg text-muted-foreground",s),...t,children:a})}function _s(){const{user:s,isLoading:a}=Ke();return a?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(A,{className:"h-8 w-8 animate-spin text-border"})}):s?e.jsxs("div",{className:"container mx-auto py-6 space-y-8",children:[e.jsxs(fs,{children:[e.jsx(js,{children:"Personalization & Insights"}),e.jsx(vs,{children:"Customize your experience and gain insights into your emotional journey"})]}),e.jsxs(De,{defaultValue:"personalization",className:"w-full",children:[e.jsxs(Ee,{className:"w-full justify-start mb-6",children:[e.jsx(q,{value:"personalization",children:"Personalization"}),e.jsx(q,{value:"insights",children:"Insights & Reports"})]}),e.jsx(z,{value:"personalization",className:"space-y-6",children:e.jsx(xs,{})}),e.jsx(z,{value:"insights",className:"space-y-6",children:e.jsx(gs,{})})]})]}):e.jsx(Be,{to:"/auth"})}export{_s as default};
